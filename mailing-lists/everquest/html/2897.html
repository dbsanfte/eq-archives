[<a href='2898.html'>Next Message in Time</a>] | 
[<a href='2896.html'>Previous Message in Time</a>] | 
[<a href='0.html'>Next Message in Topic</a>] | 
[<a href='0.html'>Previous Message in Topic</a>] <br/><br/>
<b>Message ID:</b> 2897 <br/>
<b>Date:</b> Tue May 14 12:00:32 BST 2002 <br/>
<b>Author:</b> Su <br/>
<b>Subject:</b> Important info on virus detection and such <br/>
<br/><br/>
<div id="ygrps-yiv-443131332">As I mentioned to some of the lists earlier, a virus made its way through a<br/>
few of the yahoogroups lists I am on. A friend of mine who is a tech guy<br/>
passed this information along. This is not a virus scare. This is merely<br/>
info on how to protect your system better.<br/>
<br/>
The Klez virus and its new strings are a real pain in the butt. It&#39;s really<br/>
quite clever in the way it replicates itself, and it&#39;s another of a line of<br/>
viruses where you&#39;re only susceptible if you have Outlook or Outlook Express<br/>
as your e-mail client.<br/>
<br/>
It doesn&#39;t always broadcast as an attachment, either. One of the few forms<br/>
of Klez.e is embedded in a standard HTML message and runs automatically when<br/>
the &quot;image&quot; is displayed. Another string prompts Outlook to immediately ask<br/>
for download, rather than merely coming as a dormant attachment.<br/>
<br/>
So you don&#39;t always have to download or run something to get a virus. Many<br/>
of the more damaging viruses, like Red Alert and Magi, come in through<br/>
unprotected ports on your computer, left open by some of Microsoft&#39;s<br/>
background services. Magi also has a string that runs through Active X, and<br/>
its three stages of damage and distribution are kinda interesting.<br/>
<br/>
For the first 30 days, it does nothing. On Day 30, it deletes your CPL<br/>
(Control Panel) files. At 60 days, it cripples your desktop, making it<br/>
appear as though the icons run away from your mouse pointer. If left<br/>
unchecked for 90 days, the real fun starts. It overwrites a portion of your<br/>
boot sector, renames every other file to something lewd, deletes every 25th<br/>
file, and corrupts your registry.<br/>
<br/>
Anyway, my point is that it&#39;s still always a good idea to check your<br/>
registry from time to time. Norton and McAfee are nice, but I don&#39;t like the<br/>
way either of them insists on running in the background, eating up resources<br/>
better spent elsewhere. McAfee is the better of the two, in my opinion, but<br/>
neither can be relied upon for total safety. Even if you update your<br/>
definitions religiously, it&#39;ll be a week or two before either will protect<br/>
you from a virus written today, y&#39;know?<br/>
<br/>
Symantec and McAfee&#39;s rundowns on the virus are misleading, especially when<br/>
it comes to removing it. This is why I tend to do these things by hand.<br/>
<br/>
Klez is a registry driven virus that runs an executable from your<br/>
&#92;WINDOWS&#92;SYSTEM directory each time you start your computer. The EXE file in<br/>
your SYSTEM directory is randomly named, though it always has &quot;win&quot; at the<br/>
beginning. winblk.exe, winking.exe, winyhb.exe, and on and on and on.<br/>
<br/>
If you&#39;re running a Windows OS (95 through XP), here&#39;s how to check to see<br/>
if you have it...<br/>
<br/>
1 - Click Start, Run, type REGEDIT, and hit Enter.<br/>
<br/>
2 - Navigate to the HKEY_LOCAL_MACHINE &gt; SOFTWARE &gt; MICROSOFT &gt; WINDOWS &gt;<br/>
CURRENT VERSION &gt; RUN directory on the left to see the RUN key values on the<br/>
right.<br/>
<br/>
3 - If you have the virus, you&#39;ll have a key to the file described above<br/>
(winking.exe, for example). If the entry is there, click on it and hit the<br/>
Delete key on your keyboard.  It should be the last entry in that key list.<br/>
<br/>
NOTE: Some strands of this virus monitor changes to the registry so that if<br/>
you delete the virus key, it will automatically replace it. Once deleted,<br/>
you can hit the F5 key to refresh the folder. If it has replaced itself,<br/>
don&#39;t worry. The steps to eliminate the virus will kill it.<br/>
<br/>
The easiest way to positively eliminate the virus is in DOS. Depending on<br/>
your OS, you may have a Restart in MS-DOS Mode option in your shutdown menu.<br/>
Use it if you do. If you don&#39;t, you can reboot and hit the F8 key after the<br/>
post screen to bring up the boot option menu and choose Command Prompt Only<br/>
to get to a native DOS prompt.<br/>
<br/>
The reason this is necessary is because the Klez executable will be active,<br/>
meaning you won&#39;t be able to edit or delete the file while Windows is<br/>
running. It technically starts itself as a Windows service, so it won&#39;t<br/>
appear in your Close Program dialog box either.<br/>
<br/>
Anyway, shut down or boot into DOS and navigate to your &#92;WINDOWS&#92;SYSTEM<br/>
directory. On most machines the path is C:&#92; Windows&#92;System. For those not<br/>
familiar with DOS, assuming your use the common path, the following commands<br/>
will get you to your System directory...<br/>
<br/>
cd&#92;<br/>
cd windows<br/>
cd system<br/>
<br/>
Now run the following command...<br/>
<br/>
dir /a:h<br/>
<br/>
This will display all hidden files in the directory. There should only be a<br/>
few, and one of them will be the virus executable, which should be the only<br/>
EXE file listed. Again, we&#39;ll use winking.exe as our example.<br/>
<br/>
This file will have attributes set to protect it from detection and<br/>
deletion. To remove those attributes, use the following command...<br/>
<br/>
attrib -h -s -r winking.exe<br/>
<br/>
With those attributes removed, you can now delete the file...<br/>
<br/>
del winking.exe<br/>
<br/>
Now the virus won&#39;t start with Windows. Reboot your machine and repeat the<br/>
steps above to check for and remove the registry entry. Reboot again to make<br/>
sure everything was done properly. If on this restart you no longer have the<br/>
registry key, then your system is no longer running the Klez virus.<br/>
<br/>
Now, this doesn&#39;t mean you don&#39;t still have infected files. Although<br/>
innocuous, Klez can infect other executables on your machine. So it&#39;s a good<br/>
idea when all&#39;s said and done to update your virus definitions and do a<br/>
thorough scan, cleaning or removing any infected files found.<br/>
<br/>
For Klez, it&#39;s important that you don&#39;t rely on your AV software to<br/>
eliminate the active virus. Always do it manually. As of today, neither<br/>
Norton Antivirus or McAfee successfully innoculate all 9 strings of the Klez<br/>
virus. In other words, it&#39;ll scan, it&#39;ll find files, it&#39;ll clean/remove them<br/>
for you, but it will not uniformly remove the SYSTEM file or the registry<br/>
entry. Depending on the string you have, it might fix things, but the manual<br/>
process is the only way to make sure.<br/>
<br/>
I hope that this helps.<br/>
luv,<br/>
-Su</div>
