<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta name="keywords" content="luclin,everquest,EQ,luclin server" />
<meta name="description" content="A forum for the luclin server community" />

<title>Luclin Community Forums :: View topic - ASP Help</title>
<link rel="stylesheet" href="templates/eqluclin/eqluclin.css" type="text/css" />

</head>
<body>
<div align="center">
<a id="top">&nbsp;</a>

<table class="bodyline" width="95%" cellspacing="0" cellpadding="0" border="0">
<tr><td valign="top">

<table class="topbkg" width="95%" cellspacing="0" cellpadding="0" border="0">
<tr><td align="center">
<a href="http://www.eqluclin.com" style="font-size: larger; font-weight: bold; font-variant: small-caps; vertical-align: 150%; text-decoration: none">EQLuclin.com</a>
<a href="index.php?sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/eqluclin.jpg" alt="Luclin Community Forums Forum Index" title="Luclin Community Forums Forum Index" width="400" height="75" /></a>
<a href="http://www.luclin.org" style="font-size: larger; font-weight: bold; font-variant: small-caps; vertical-align: 150%; text-decoration: none">Luclin.org</a><br />
<a href="http://everquest.estoncom.com/luclin/index.shtml" style="font-size: larger; font-weight: bold; font-variant: small-caps; text-decoration: none; border-top-width: 1; border-bottom-width: 1">Luclin Calendar</a>
</td></tr>
</table>

<table width="95%" border="0" cellspacing="0" cellpadding="2">
<tr><td align="center" class="topnav">
&nbsp; <a href="rules.php">Board Rules</a> &nbsp; &#8226; &nbsp; <a href="statistics.php">Statistics</a> &nbsp; &#8226; &nbsp;<a href="faq.php?sid=4fc077ae3f3cfc6a4eb18d72966f288e">FAQ</a>&nbsp; &#8226; &nbsp; <a href="search.php?sid=4fc077ae3f3cfc6a4eb18d72966f288e">Search</a>
&nbsp;&#8226; &nbsp;<a href="memberlist.php?sid=4fc077ae3f3cfc6a4eb18d72966f288e">Memberlist</a>&nbsp; &#8226;
&nbsp;<a href="groupcp.php?sid=4fc077ae3f3cfc6a4eb18d72966f288e">Usergroups</a>
&nbsp; &#8226; &nbsp;<a href="profile.php?mode=register&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e">Register</a>
<br />
&nbsp;<a href="ignore.php">Ignore List</a>
&nbsp; &#8226; &nbsp;<a href="profile.php?mode=editprofile&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e">Profile</a>&nbsp; &#8226; &nbsp;<a href="privmsg.php?folder=inbox&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e">Log in to check your private messages</a>&nbsp;
&#8226; &nbsp;<a href="login.php?sid=4fc077ae3f3cfc6a4eb18d72966f288e">Log in</a>
</td></tr>
</table>

<table width="95%" border="0" cellspacing="0" cellpadding="10">
<tr><td>


<table width="100%" cellspacing="2" cellpadding="2" border="0">
  <tr>
	<td align="left" valign="bottom" colspan="2"><a class="maintitle" href="viewtopic.php?t=6428&amp;start=0&amp;postdays=0&amp;postorder=asc&amp;highlight=&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e">ASP Help</a><br />
	  <span class="gensmall"><b></b><br />
	  &nbsp; </span></td>
  </tr>
</table>

<table width="100%" cellspacing="2" cellpadding="2" border="0">
  <tr>
	<td align="left" valign="bottom" nowrap="nowrap"><span class="nav"><a href="posting.php?mode=newtopic&amp;f=20&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/post.gif" border="0" alt="Post new topic" align="middle" /></a>&nbsp;&nbsp;&nbsp;<a href="posting.php?mode=reply&amp;t=6428&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/reply.gif" border="0" alt="Reply to topic" align="middle" /></a></span></td>
	<td align="left" valign="middle" width="100%"><span class="nav">&nbsp;&nbsp;&nbsp;<a href="index.php?sid=4fc077ae3f3cfc6a4eb18d72966f288e" class="nav">Luclin Community Forums Forum Index</a>
	  -> <a href="viewforum.php?f=20&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e" class="nav">Technical & Support</a></span></td>
  </tr>
</table>

<table class="forumline" width="100%" cellspacing="1" cellpadding="3" border="0">
	<tr align="right">
		<td class="catHead" colspan="2" height="28"><span class="nav"><a href="viewtopic.php?t=6428&amp;view=previous&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e" class="nav">View previous topic</a> :: <a href="viewtopic.php?t=6428&amp;view=next&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e" class="nav">View next topic</a> &nbsp;</span></td>
	</tr>
	
	<tr>
		<th class="thLeft" width="150" height="26" nowrap="nowrap">Author</th>
		<th class="thRight" nowrap="nowrap">Message</th>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row2"><span class="name"><a name="91929"></a><b>valelr dzhaunil</b></span><br /><span class="postdetails">Newbie
		
		<br />Joined: 22 Jul 2003<br />Posts: 23</span></td>
		<td class="row2" width="100%" height="28" valign="top">

		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
			<td><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%"><a href="viewtopic.php?p=91929&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e#91929"><img src="templates/eqluclin/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Tue Oct 26, 2004 2:41 pm<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: ASP Help</span></td>
				<td width="30%" valign="top" nowrap="nowrap" align="right"> <a href="posting.php?mode=quote&amp;p=91929&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td></tr></table></td>
			</tr>
			<tr><td colspan="2"><hr /></td></tr>
			<tr><td colspan="2">
				<div class="postbody">
				Ok...I've searched and searched the internet and am unable to find anything useful that helps.
<br />

<br />
<span style="font-weight: bold">Scenario</span>:  Create an ASP page that pulls information from a SQL 2000 database.  IIS server and SQL server are different servers.  System DSN is set up using NT authentication on the IIS server and connects successfully.
<br />

<br />
When I connect to the page from my workstation, I get a logon/authentication error, however, if I terminal session into the IIS server and connect to the page through IE, it works.  After I make that connection from the terminal session, I can go to my workstation and view that same page properly.
<br />

<br />
Here's the ASP code:
<br />

<br />
</span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 	  <td><span class="genmed"><b>Code:</b></span></td>	</tr>	<tr>	  <td class="code">&lt;%
<br />
Dim objConn
<br />
Set objConn = Server.CreateObject&#40;&quot;ADODB.Connection&quot;&#41;
<br />
objConn.ConnectionString = &quot;DSN=testSecurity&quot;
<br />
objConn.Open
<br />

<br />
DIM mySQL
<br />
mySQL = &quot;SELECT * FROM prod_info&quot;
<br />

<br />
DIM objRS
<br />
Set objRS = Server.CreateObject&#40;&quot;ADODB.Recordset&quot;&#41;
<br />
objRS.Open mySQL, objConn
<br />
%&gt;</td>	</tr></table><span class="postbody">
<br />

<br />
Now the catch is, I do not want to have the userid/password listed in the ASP code, nor in another file anywhere and I want to use NT authentication on the SQL side as this needs to be a secure site.
<br />

<br />
Anyone have any ideas?
<br />

<br />
~Valelr<br />
				<span class="gensmall"></span><br />
				</div>
			</td></tr>
		</table>
		</td>
	</tr>
	<tr>
		<td class="row2" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap">
			<table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr><td valign="middle" nowrap="nowrap">       </td></tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/eqluclin/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row1"><span class="name"><a name="91934"></a><b>BloodRhane</b></span><br /><span class="postdetails">Fecal Happens<br />
		<br /><img class="avatar" src="http://www.luclin.org/files/seraphem/thupid.gif" alt="" /><br />
		<br />Joined: 12 Aug 2003<br />Posts: 507</span></td>
		<td class="row1" width="100%" height="28" valign="top">

		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
			<td><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%"><a href="viewtopic.php?p=91934&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e#91934"><img src="templates/eqluclin/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Tue Oct 26, 2004 3:43 pm<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: Re: ASP Help</span></td>
				<td width="30%" valign="top" nowrap="nowrap" align="right"> <a href="posting.php?mode=quote&amp;p=91934&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td></tr></table></td>
			</tr>
			<tr><td colspan="2"><hr /></td></tr>
			<tr><td colspan="2">
				<div class="postbody">
				Silly question, does the site from the remote computer show up as a "Trusted Site" and does your browser have it set to Automatically pass credentials to trusted sites?<br />
				<span class="gensmall"></span><br />
				</div>
			</td></tr>
		</table>
		</td>
	</tr>
	<tr>
		<td class="row1" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row1" width="100%" height="28" valign="bottom" nowrap="nowrap">
			<table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr><td valign="middle" nowrap="nowrap">       </td></tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/eqluclin/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row2"><span class="name"><a name="91946"></a><b>valelr dzhaunil</b></span><br /><span class="postdetails">
		
		<br />Joined: 22 Jul 2003<br />Posts: 23</span></td>
		<td class="row2" width="100%" height="28" valign="top">

		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
			<td><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%"><a href="viewtopic.php?p=91946&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e#91946"><img src="templates/eqluclin/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Tue Oct 26, 2004 4:54 pm<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: Re: ASP Help</span></td>
				<td width="30%" valign="top" nowrap="nowrap" align="right"> <a href="posting.php?mode=quote&amp;p=91946&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td></tr></table></td>
			</tr>
			<tr><td colspan="2"><hr /></td></tr>
			<tr><td colspan="2">
				<div class="postbody">
				</span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 	  <td><span class="genmed"><b>BloodRhane wrote:</b></span></td>	</tr>	<tr>	  <td class="quote">Silly question, does the site from the remote computer show up as a "Trusted Site" and does your browser have it set to Automatically pass credentials to trusted sites?</td>	</tr></table><span class="postbody">
<br />

<br />
Sillier question...how would I check that?  I've looked in the Internet options and all the advanced settings and didn't see anything for trusted sites.
<br />

<br />
I can only assume that everything on the browser and IIS is set up correctly since I can browse from the web server and it works fine.  I do know that's not always a definite indication though.<br />
				<span class="gensmall"></span><br />
				</div>
			</td></tr>
		</table>
		</td>
	</tr>
	<tr>
		<td class="row2" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap">
			<table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr><td valign="middle" nowrap="nowrap">       </td></tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/eqluclin/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row1"><span class="name"><a name="91959"></a><b>BloodRhane</b></span><br /><span class="postdetails">Fecal Happens<br />
		<br /><img class="avatar" src="http://www.luclin.org/files/seraphem/thupid.gif" alt="" /><br />
		<br />Joined: 12 Aug 2003<br />Posts: 507</span></td>
		<td class="row1" width="100%" height="28" valign="top">

		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
			<td><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%"><a href="viewtopic.php?p=91959&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e#91959"><img src="templates/eqluclin/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Tue Oct 26, 2004 5:50 pm<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: Re: ASP Help</span></td>
				<td width="30%" valign="top" nowrap="nowrap" align="right"> <a href="posting.php?mode=quote&amp;p=91959&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td></tr></table></td>
			</tr>
			<tr><td colspan="2"><hr /></td></tr>
			<tr><td colspan="2">
				<div class="postbody">
				If you look at your lower right hand corner of the IE window when you are browsing these forums, it should have a little planet and say "Internet".  That is where you determine what zone IE thinks it is in.  If it was a trused zone, it would have a green circle with a check in it and say "Trusted", or possibly "Intranet"(Intranet would have a different icon, a comptuer I believe).
<br />

<br />
If it is not in your trusted sites, go to "Tools", and then "Internet Options".  Go to "Security", select "Trusted Sites", and then "Sites".  You can probably figure out how to add you site into the Trusted Sites.
<br />

<br />
If you already show Trusted or Intranet, go to the same place and select "Custom Level" when Trusted Sites or Intranet (depending on your situation) is selected.  Scroll all the way to the bottom and look at your Authentication/Logon Settings.  Try setting it to automatically pass windows authentication and see if it works any better.
<br />

<br />
I cant guarantee that this is the problem, but at least it can eliminate one possible source.<br />
				<span class="gensmall"></span><br />
				</div>
			</td></tr>
		</table>
		</td>
	</tr>
	<tr>
		<td class="row1" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row1" width="100%" height="28" valign="bottom" nowrap="nowrap">
			<table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr><td valign="middle" nowrap="nowrap">       </td></tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/eqluclin/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row2"><span class="name"><a name="92119"></a><b>valelr dzhaunil</b></span><br /><span class="postdetails">
		
		<br />Joined: 22 Jul 2003<br />Posts: 23</span></td>
		<td class="row2" width="100%" height="28" valign="top">

		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
			<td><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%"><a href="viewtopic.php?p=92119&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e#92119"><img src="templates/eqluclin/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Wed Oct 27, 2004 2:22 pm<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: Re: ASP Help</span></td>
				<td width="30%" valign="top" nowrap="nowrap" align="right"> <a href="posting.php?mode=quote&amp;p=92119&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td></tr></table></td>
			</tr>
			<tr><td colspan="2"><hr /></td></tr>
			<tr><td colspan="2">
				<div class="postbody">
				It's a local intranet site, so that's what it shows up as.<br />
				<span class="gensmall"></span><br />
				</div>
			</td></tr>
		</table>
		</td>
	</tr>
	<tr>
		<td class="row2" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap">
			<table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr><td valign="middle" nowrap="nowrap">       </td></tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/eqluclin/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row1"><span class="name"><a name="92121"></a><b>BloodRhane</b></span><br /><span class="postdetails">Fecal Happens<br />
		<br /><img class="avatar" src="http://www.luclin.org/files/seraphem/thupid.gif" alt="" /><br />
		<br />Joined: 12 Aug 2003<br />Posts: 507</span></td>
		<td class="row1" width="100%" height="28" valign="top">

		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
			<td><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%"><a href="viewtopic.php?p=92121&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e#92121"><img src="templates/eqluclin/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Wed Oct 27, 2004 2:48 pm<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: Re: ASP Help</span></td>
				<td width="30%" valign="top" nowrap="nowrap" align="right"> <a href="posting.php?mode=quote&amp;p=92121&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td></tr></table></td>
			</tr>
			<tr><td colspan="2"><hr /></td></tr>
			<tr><td colspan="2">
				<div class="postbody">
				Did you try...
<br />
 
<br />
</span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 	  <td><span class="genmed"><b>Quote:</b></span></td>	</tr>	<tr>	  <td class="quote">If you already show Trusted or Intranet, go to the same place and select "Custom Level" when Trusted Sites or Intranet (depending on your situation) is selected. Scroll all the way to the bottom and look at your Authentication/Logon Settings. Try setting it to automatically pass windows authentication and see if it works any better. </td>	</tr></table><span class="postbody"><br />
				<span class="gensmall"></span><br />
				</div>
			</td></tr>
		</table>
		</td>
	</tr>
	<tr>
		<td class="row1" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row1" width="100%" height="28" valign="bottom" nowrap="nowrap">
			<table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr><td valign="middle" nowrap="nowrap">       </td></tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/eqluclin/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row2"><span class="name"><a name="92199"></a><b>Ianien</b></span><br /><span class="postdetails">Active Member
		
		<br />Joined: 31 Jul 2003<br />Posts: 185</span></td>
		<td class="row2" width="100%" height="28" valign="top">

		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
			<td><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%"><a href="viewtopic.php?p=92199&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e#92199"><img src="templates/eqluclin/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Wed Oct 27, 2004 9:13 pm<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: Re: ASP Help</span></td>
				<td width="30%" valign="top" nowrap="nowrap" align="right"> <a href="posting.php?mode=quote&amp;p=92199&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td></tr></table></td>
			</tr>
			<tr><td colspan="2"><hr /></td></tr>
			<tr><td colspan="2">
				<div class="postbody">
				<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;176377" target="_blank">http://support.microsoft.com/default.aspx?scid=kb;en-us;176377</a>
<br />

<br />
(Paste for the lazy)
<br />
</span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 	  <td><span class="genmed"><b>Quote:</b></span></td>	</tr>	<tr>	  <td class="quote">
<br />
<span style="font-size: 18px; line-height: normal">INFO: Accessing SQL Server with Integrated Security from ASP</span>
<br />

<br />
<span style="font-size: 14px; line-height: normal">SUMMARY</span>
<br />
When accessing SQL Server with integrated security from Active Server Pages (ASP) there are some limitations that you should be aware of when designing your Web site. This article gives a high-level overview of these limitations and describes possible workarounds.
<br />

<br />
<span style="font-weight: bold">NOTE:</span> This limitation was fixed in Windows 2000 but for Kerberos security only. 
<br />
<span style="font-size: 14px; line-height: normal">MORE INFORMATION</span>
<br />
Microsoft SQL Server Integrated Security requires NTLM authentication in order to map user accounts to SQL Server accounts. This process requires that a token be created during the authentication process. This token requires a the user password to create a private encryption key. Because of this, the token can only be created on a domain controller or the logged on user's machine. Also note that Windows NT 4.0 does not allow the forwarding of such tokens. 
<br />

<br />
With these points in mind you can see that after a Web browser is authenticated by Internet Information Server (IIS), an authenticated connection to the SQL Server is not possible. At this point when IIS attempts to connect to SQL Server via NTLM, IIS does not have the necessary information to complete the NT authentication process. 
<br />

<br />
There are a couple possible workarounds to this limitation: 
<br />

<br />
<span style="font-weight: bold">Host IIS and SQL Server on the Same Machine</span>
<br />
By eliminating the need for IIS to create an authenticated connection to SQL Server, you can work around this problem. To do this you must use a data source name (DSN) that does not look out to the network for the SQL Server and instead looks directly to the local machine. This can be done by using the "(local)" setting in a System DSN. 
<br />

<br />
<span style="font-weight: bold">Use Basic Authentication Instead of NTLM in IIS</span>
<br />
By using Basic authentication, the password is BASE64 encoded and sent to IIS during the authentication process. With the password, IIS can now complete the NTLM authentication process when connection to SQL Server. 
<br />

<br />
<span style="font-weight: bold">NOTE:</span> This method is not secure. BASE64 encoded passwords can be decrypted by anyone able to sniff network packets over the Internet or intranet. 
<br />

<br />
<span style="font-weight: bold">Map the Anonymous User Account from IIS to a SQL Server Guest Account</span>
<br />
This method assumes that all users will have the same level of privileges to the SQL Server resources. This method is most often the LEAST acceptable option. 
<br />

<br />
</td>	</tr></table><span class="postbody"><br />
				<span class="gensmall"></span><br />
				</div>
			</td></tr>
		</table>
		</td>
	</tr>
	<tr>
		<td class="row2" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap">
			<table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr><td valign="middle" nowrap="nowrap">       </td></tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/eqluclin/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row1"><span class="name"><a name="92249"></a><b>lokal</b></span><br /><span class="postdetails">Suck my flute!<br />
		<br /><img class="avatar" src="http://www.telusplanet.net/public/geckos/ebay/c21de157f92c72347310e5abf88a0900_avatar.jpg" alt="" /><br />
		<br />Joined: 22 Jul 2003<br />Posts: 488</span></td>
		<td class="row1" width="100%" height="28" valign="top">

		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
			<td><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%"><a href="viewtopic.php?p=92249&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e#92249"><img src="templates/eqluclin/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Thu Oct 28, 2004 12:58 am<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: Re: ASP Help</span></td>
				<td width="30%" valign="top" nowrap="nowrap" align="right"> <a href="posting.php?mode=quote&amp;p=92249&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td></tr></table></td>
			</tr>
			<tr><td colspan="2"><hr /></td></tr>
			<tr><td colspan="2">
				<div class="postbody">
				<a href="http://freshmeat.net/projects/apacheasp/" target="_blank" class="postlink">I'm a troll</a><br />
				<span class="gensmall"></span><br />
				</div>
			</td></tr>
		</table>
		</td>
	</tr>
	<tr>
		<td class="row1" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row1" width="100%" height="28" valign="bottom" nowrap="nowrap">
			<table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr><td valign="middle" nowrap="nowrap">       </td></tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/eqluclin/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row2"><span class="name"><a name="92259"></a><b>valelr dzhaunil</b></span><br /><span class="postdetails">
		
		<br />Joined: 22 Jul 2003<br />Posts: 23</span></td>
		<td class="row2" width="100%" height="28" valign="top">

		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
			<td><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td width="100%"><a href="viewtopic.php?p=92259&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e#92259"><img src="templates/eqluclin/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Thu Oct 28, 2004 1:48 am<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: Re: ASP Help</span></td>
				<td width="30%" valign="top" nowrap="nowrap" align="right"> <a href="posting.php?mode=quote&amp;p=92259&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td></tr></table></td>
			</tr>
			<tr><td colspan="2"><hr /></td></tr>
			<tr><td colspan="2">
				<div class="postbody">
				No, you're a ghey bard... <img src="images/smiles/smile.gif" alt="smile" border="0" /><br />
				<span class="gensmall"></span><br />
				</div>
			</td></tr>
		</table>
		</td>
	</tr>
	<tr>
		<td class="row2" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap">
			<table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr><td valign="middle" nowrap="nowrap">       </td></tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/eqluclin/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr align="center">
		<td class="catBottom" colspan="2" height="28"><table cellspacing="0" cellpadding="0" border="0">
			<tr><form method="post" action="viewtopic.php?t=6428&amp;start=0&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e">
				<td align="center"><span class="gensmall">Display posts from previous: <select name="postdays"><option value="0" selected="selected">All Posts</option><option value="1">1 Day</option><option value="7">7 Days</option><option value="14">2 Weeks</option><option value="30">1 Month</option><option value="90">3 Months</option><option value="180">6 Months</option><option value="364">1 Year</option></select>&nbsp;<select name="postorder"><option value="asc" selected="selected">Oldest First</option><option value="desc">Newest First</option></select>&nbsp;<input type="submit" value="Go" class="liteoption" name="submit" /></span></td>
			</form></tr>
		</table></td>
	</tr>
</table>

<table width="100%" cellspacing="2" cellpadding="2" border="0" align="center">
  <tr>
	<td align="left" valign="middle" nowrap="nowrap"><span class="nav"><a href="posting.php?mode=newtopic&amp;f=20&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/post.gif" border="0" alt="Post new topic" align="middle" /></a>&nbsp;&nbsp;&nbsp;<a href="posting.php?mode=reply&amp;t=6428&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e"><img src="templates/eqluclin/images/lang_english/reply.gif" border="0" alt="Reply to topic" align="middle" /></a></span></td>
	<td align="left" valign="middle" width="100%"><span class="nav">&nbsp;&nbsp;&nbsp;<a href="index.php?sid=4fc077ae3f3cfc6a4eb18d72966f288e" class="nav">Luclin Community Forums Forum Index</a>
	  -> <a href="viewforum.php?f=20&amp;sid=4fc077ae3f3cfc6a4eb18d72966f288e" class="nav">Technical & Support</a></span></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">All times are GMT</span><br /><span class="nav"></span>
	  </td>
  </tr>
  <tr>
	<td align="left" colspan="3"><span class="nav">Page <b>1</b> of <b>1</b></span></td>
  </tr>
</table>

<table width="100%" cellspacing="2" border="0" align="center">
  <tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"><span class="gensmall"></span><br />
	  &nbsp;<br />
	  </td>
	<td align="right" valign="top" nowrap="nowrap">
<form method="get" name="jumpbox" action="viewforum.php?sid=4fc077ae3f3cfc6a4eb18d72966f288e" onSubmit="if(document.jumpbox.f.value == -1){return false;}"><table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ forms['jumpbox'].submit() }"><option value="-1">Select a forum</option><option value="-1">&nbsp;</option><option value="-1">General Luclin Forums</option><option value="-1">----------------</option><option value="4">Everquest Discussion</option><option value="13">General</option><option value="8">News & Debates</option><option value="20"selected="selected">Technical & Support</option><option value="12">Trading</option><option value="1">Past Favorites</option><option value="9">Flames & Rants</option><option value="24">Other Games</option><option value="-1">&nbsp;</option><option value="-1">EQLuclin Portal</option><option value="-1">----------------</option><option value="21">News</option><option value="23">Submissions</option></select><input type="hidden" name="sid" value="4fc077ae3f3cfc6a4eb18d72966f288e" />&nbsp;<input type="submit" value="Go" class="liteoption" /></span></td>
	</tr>
</table></form>

<span class="gensmall">You <b>cannot</b> post new topics in this forum<br />You <b>cannot</b> reply to topics in this forum<br />You <b>cannot</b> edit your posts in this forum<br />You <b>cannot</b> delete your posts in this forum<br />You <b>cannot</b> vote in polls in this forum<br /></span></td>
  </tr>
</table>

<br />
<div class="copyright"><br />
Powered by <a href="http://www.phpbb.com/" target="_blank" class="copyright">phpBB</a> 2.0.10 &copy; 2001, 2002, 2003 phpBB Group - Server Load: 79 page(s) served in previous fifteen minutes.<br />
</div>
</td></tr>
</table>
</td></tr>
</table>
</div>
</body>
</html>

