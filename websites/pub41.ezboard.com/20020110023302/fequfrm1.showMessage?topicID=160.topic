<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> <html><head><title>Server Polling code - www.ezboard.com</title><CENTER><SCRIPT language="JavaScript1.1" SRC="http://ad.doubleclick.net/adj/ezboard.zf/;sz=1x2;ord=73684296">
</SCRIPT></CENTER> <SCRIPT LANGUAGE="JavaScript"><!--if ((navigator.appVersion.indexOf("Mac") != -1)) document.write("<LINK REL=stylesheet HREF=\"http://www.ezboard.com/ztyles/defaultmac.css\" TYPE=\"text/css\">"); else document.write("<LINK REL=stylesheet HREF=\"http://www.ezboard.com/ztyles/default.css\" TYPE=\"text/css\">"); // --></SCRIPT> <script language=javascript src=http://www1.ezboard.com/spch.js?customerid=1147458082></script><script language="javascript"><!--function MM_openBrWindow(theURL,winName,features) { //v2.0  window.open(theURL,winName,features);}//--></script></head><body text=#ffffff bgcolor=#003000 link=#00ff00 vlink=#00ff00 alink=#00ff00  background=http://boardimages.homestead.com/files/equezboard/EQuSite_Greenstone.jpg  ><center><CENTER><!--- Start Everyone.net banner, no edit without explicit permission from Everyone.net -->
<iframe
src="http://ezboard.bigbangmedia.com/reflect/view.ifr?site=200241&href=http://engage.everyone.net/hserver/aamsz=468x60/site=941700_WWW.EZBOARD.COM/area=AS.ART_ENT.TV_MOV/?"
noresize scrolling="no" hspace="0" vspace="0" frameborder="0"
marginheight="0" marginwidth="0" width="468" height="60">
<script
src="http://ezboard.bigbangmedia.com/reflect/view.js?site=200241&href=http://engage.everyone.net/jserver/aamsz=468x60/site=941700_WWW.EZBOARD.COM/area=AS.ART_ENT.TV_MOV/?">
</script>
<noscript>
 <a
href="http://ezboard.bigbangmedia.com/reflect/click.html?site=200241&href=http://engage.everyone.net/adclick/aamsz=468x60/site=941700_WWW.EZBOARD.COM/area=AS.ART_ENT.TV_MOV/?">
  <img
src="http://ezboard.bigbangmedia.com/reflect/view.gif?site=200241&href=http://engage.everyone.net/iserver/aamsz=468x60/site=941700_WWW.EZBOARD.COM/area=AS.ART_ENT.TV_MOV/?">
 </a>
</noscript>
</iframe>
<!-- End Everyone.net banner --></CENTER> <br> <a href=http://members.telocity.com/~ericruess306/equ><img src=http://boardimages.homestead.com/files/equezboard/equlogo2.gif border=0></a>  <table width=95%><tr><td class=headings valign="bottom"> <a href=http://pub41.ezboard.com/bequ>EQu Message Board</a><br>&nbsp;&nbsp;&nbsp;&nbsp;> <a href=http://pub41.ezboard.com/fequfrm1>General Discussion</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;> Server Polling code</td><td align=right valign="bottom"><a href=http://pub41.ezboard.com/fequfrm1.showAddTopicScreenFromWeb><img src=http://boardimages.homestead.com/files/equezboard/newtopic.gif border=0 alt="New Topic"></a>  &nbsp;&nbsp;<a href=http://pub41.ezboard.com/fequfrm1.showAddPollScreenFromWeb><img src=http://boardimages.homestead.com/files/equezboard/newpoll.gif border=0 alt="New Poll"></a>  &nbsp;&nbsp;<a href=http://pub41.ezboard.com/fequfrm1.showAddReplyScreenFromWeb?topicID=160.topic><img src=http://boardimages.homestead.com/files/equezboard/addreply.gif border=0 alt="Add Reply"></a>  </td></tr><tr><td align=left></td><td align=right> <br> <a href="http://pub41.ezboard.com/fequfrm1.showMessage?topicID=167.topic"> << Prev Topic</a>&nbsp;| <a href="http://pub41.ezboard.com/fequfrm1.showMessage?topicID=164.topic"> Next Topic >> </a> </td></tr></table> <table border=0 cellpadding=0 cellspacing=0 width=95%><tr><td bgcolor=#000000><table border=0 width=100% cellpadding=5 cellspacing=1><tr><td valign=top bgcolor=#003000 class=headings><font color=#FFFFFF>Author</font></td><td valign=top bgcolor=#003000 class=headings><font color=#FFFFFF>Comment</font></td></tr><tr bgcolor=#000000><td nowrap width=20% valign=top align=left><span class=title> <A HREF=http://pub41.ezboard.com/ukurrlee.showPublicProfile?language=EN>Kurrlee</A></span><br> <span class=usertitle>EQu User</span><br> <font color=#00ff00>(8/15/01 4:59:21 am)</font><br>    </td><td valign=top align=left class=m><span class=title> Server Polling code</span><hr size=1> I was thinking about building an app that periodically polls the servers and saves the number. That way I can do a trend analysis of the server populations.<br>
<br>
Would it be possible to send me the server info code for this? <br>
<br>
You can send it to the email associated with this name<br>
or<br>
lbfranke@home.com<br>
or <br>
Say "No"<br>
<br>
<br>
Thanks<br>
<br>
Kurrlee <p></p><i></i></td></tr><tr bgcolor=#003000><td nowrap width=20% valign=top align=left><span class=title> <A HREF=http://pub41.ezboard.com/ujaiieq.showPublicProfile?language=EN>Jaiieq</A></span><br> <span class=usertitle>EQu User</span><br> <font color=#00ff00>(8/25/01 7:32:52 pm)</font><br>    </td><td valign=top align=left class=m><span class=title> Re: Server Polling code</span><hr size=1> Its documented on the EverQuest site:<br>
<br>
<!--EZCODE AUTOLINK START--><a href="http://everquest.station.sony.com/support/general/server_status_protocal.jsp">everquest.station.sony.co...otocal.jsp</a><!--EZCODE AUTOLINK END--><br>
<br>
Ive been working on one myself, but I'll be damned that I still can't seem to get the reply data :\  Then again, I haven't coded VB in many many years, so its like starting all over.<br>
<br>
Once I get that damn Send/Reply stuff down, Im gold :D  Too bad its the most critical part :o <p><font face="Arial" size="2">-<a href=http://www.afflictionguild.com/profile.php?username=Jaiieq&charactername=Jaiieq>Jaiieq</a>, <a href=http://www.afflictionguild.com>Affliction</a></font></p><i></i></td></tr><tr bgcolor=#000000><td nowrap width=20% valign=top align=left><span class=title> <A HREF=http://pub41.ezboard.com/bequ.showLocalUserPublicProfile?login=mustard>Mustard</A></span><br> <span class=usertitle>EQu Author</span><br> <font color=#00ff00>(8/27/01 7:10:04 pm)</font><br>    <BR><img src=http://boardimages.homestead.com/files/hanzsleep1.jpg WIDTH=60 HEIGHT=60></td><td valign=top align=left class=m><span class=title> Re: Server Polling code</span><hr size=1> Here's one way you can do it (using VB)<br>
<br>
Place a winsock control on your form, and at some point in the code (like on Form_Load) initialize like so:<br>
<br>
     Winsock1.Protocol = sckUDPProtocol<br>
     Winsock1.RemoteHost = &quot;status.everquest.com&quot;<br>
     Winsock1.RemotePort = 24252<br>
<br>
Now that you have your winsock control pointed at the EQSS, you can begin requesting data.  I did this in EQu by assembling a little byte array to contain a 4 byte hex request string, as per the EQSS protocol:<br>
<br>
    Dim RequestCode(4) As Byte<br>
<br>
    RequestCode(0) = &amp;HFF<br>
    RequestCode(1) = &amp;HFF<br>
    RequestCode(2) = &amp;H1<br>
    RequestCode(3) = &amp;H0<br>
<br>
...which in this case creates 0xFFFF0100, i.e. request for the server names, which we send to the EQSS using winsocks SendData method...<br>
<br>
    Winsock1.SendData (RequestCode)<br>
<br>
Now basically you wait for Winsock to receive the response.  When the winsock control receives data, this triggers it's DattaArrival event.  You use winsock's GetData method to fetch what has arrived for you and stick it in a variable.  So the Winsock1_DataArrival event looks a little something like this:<br>
<br>
    Dim incomming As String<br>
    <br>
    Winsock1.GetData incomming, VBString<br>
<br>
This stores whatever has arrived from the EQSS into the incomming string variable (in VBString format), and so now you have the data in your hot little hands to do display in an app, or log to a file or whatever you have in mind. <p>Mustard</p><i>Edited by: <A HREF=http://pub41.ezboard.com/bequ.showLocalUserPublicProfile?login=mustard>Mustard</A> at: 8/27/01 7:16:07 pm<br></i></td></tr><tr bgcolor=#003000><td nowrap width=20% valign=top align=left><span class=title> <A HREF=http://pub41.ezboard.com/ujaiieq.showPublicProfile?language=EN>Jaiieq</A></span><br> <span class=usertitle>EQu User</span><br> <font color=#00ff00>(8/28/01 8:42:57 pm)</font><br>    </td><td valign=top align=left class=m><span class=title> Re: Server Polling code</span><hr size=1> ironicly, I figured that out not 10 minutes after I posted that :)  (But much apprecaited tho Mustard for a response).  Only one more roadblock and I have my &quot;test&quot; version running.  (doing this for my own enjoyment btw... and to learn VB [again]).<br>
<br>
As far as the servers counts (which can be 2 bytes in length) for each server, for the life of me I can't seem to parse them correctly.  Im fine on the chat banner, as well as the server names, but the population counts never come out right.  But when it comes to converting the section of the data stream dealing with the population, I never get the &quot;Correct&quot; number.<br>
<br>
For the most part, to parse the stream, Im just doing a simple loop of the data stream byte for byte... example, to parse the Server Names, I did this:<br>
<br>
....loop code here...<br>
ServerNameChr = chr(AscB(MidB(strData, X, 1)))<br>
...other code here..<br>
<br>
This line is in a loop that executes until the Byte Length  of the incoming stream is exhausted.  Its escentially taking each byte and converting it to ascii code, and then to a character via the ascii code.  When it hits the NULL it then adds it to a listview control, clears the ServerNameChr character, and starts again  (Might not be the best way to do it... but it worked :)<br>
<br>
Guess my question is..  how exactly did you parse the 2 bytes to get the server population?  No matter what Ive tried, Im not getting the correct population.  Feel free to email me if you want (jaiieq@fuxored.net), or post here again.<br>
<br>
This is all done in VB 6 as well (which I think EQu was writting in?).  With my luck, Ill have figured it out within 10 minutes like last time :P, but this one has been stumping me for a bit :)<br>
<br>
 <p><font face="Arial" size="2">-<a href=http://www.afflictionguild.com/profile.php?username=Jaiieq&charactername=Jaiieq>Jaiieq</a>, <a href=http://www.afflictionguild.com>Affliction</a></font></p><i></i></td></tr></table> </td></tr></table> <table border=0 width=95%><tr><td align=left valign="top"> </td><td align=right valign="top"><a href="http://pub41.ezboard.com/fequfrm1.showMessage?topicID=167.topic"> << Prev Topic</a>&nbsp;| <a href="http://pub41.ezboard.com/fequfrm1.showMessage?topicID=164.topic"> Next Topic >> </a><br><br></td></tr></table><br><table width=95% border=0><td valign="top"> <a href=http://pub41.ezboard.com/fequfrm1.emailToFriend?topicID=160.topic><img src=http://www.ezboard.com/image/email.gif border=0 alt="Email This To a Friend"> Email This To a Friend</a><br> <a href=http://pub41.ezboard.com/fequfrm1.threadControl?topicID=160.topic><img src=http://boardimages.homestead.com/files/equezboard/topiccommands.gif border=0 alt="Topic Control Image"> Topic Commands (Moderator only)</a><br> <a href=http://pub41.ezboard.com/fequfrm1.subscribeUnregisteredToTopic?topicID=160.topic>Subscribe</a> Click to receive email notification of replies<br>  <a href=http://pub41.ezboard.com/fequfrm1.unsubscribeUnregisteredToTopic?topicID=160.topic>Unsubscribe</a> Click to stop receiving email notification of replies<br> </td><td align="right" valign="top"></td></tr><tr align="right"><td colspan=2><form action=http://pub41.ezboard.com/BBSForum.jumpShowForum method=post><table border="0" cellspacing="0" cellpadding="1"><tr><td><b>jump to:</b><select name=forumName><option value="equfrm1">General Discussion<option value="equfrm2">Archived Posts</select></td><td><input type=submit value="Go" class=inputbutton></td></tr></table></form></td></tr></table><br><font color=#00ff00>- </font><a href=http://pub41.ezboard.com/bequ>EQu Message Board</a><font color=#00ff00> - </font><a href=http://pub41.ezboard.com/fequfrm1>General Discussion</a> <font color=#00ff00> - </font><a href="http://members.telocity.com/~ericruess306/equ">EQu Homepage</a><font color=#00ff00> - </font><br><br><table border=0 align=center><tr><td align=center><a href=http://www.coolsavings.com/index.asp?Ref=ezboard&BN=link-freecouons&BL=print>PRINT FREE COUPONS AT CoolSavings. Click Here!</a></td><td><img src="http://www.ezboard.com/image/spacer.gif" width=15 height=1 border=0></td><td align=center><IMG SRC="http://service.bfast.com/bfast/serve?bfmid=7279965&siteid=33932331&bfpage=vgstrategies" BORDER="0" WIDTH="1" HEIGHT="1" NOSAVE >
<A HREF="http://service.bfast.com/bfast/click?bfmid=7279965&siteid=33932331&bfpage=vgstrategies" TARGET="_blank">About Video Games</A></td></tr></table><CENTER><SCRIPT LANGUAGE="JavaScript" SRC="http://a1028.g.akamai.net/6/1028/968/444516c765e1c0/lunafetch.about.com/cgi/luna/lunaC.js?vpn=ez_games&sp=ezboard2"></SCRIPT>
<SCRIPT>sprinkslite();</SCRIPT>
<NOSCRIPT><a href="http://sprinks.about.com/index.htm?PM=725_030_01"><font face="arial, geneva, helvetica" size="2" color="#330066"><B>Sprinks</B></font></a><BR><font face="arial, geneva, helvetica" size="2" color="#000000">Start driving targeted traffic to your site with Sprinks, About's Sponsored Links program.</font><BR><font face="arial, geneva, helvetica" color="#999999" size="2">http://www.sprinks.com/</font></NOSCRIPT></CENTER><br><br>Powered By <a href=http://www.ezboard.com/>ezboard®</a> Ver. 6.4 b8<br>Copyright ©1999-2001 ezboard, Inc.</center></body></html>