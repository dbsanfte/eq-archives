<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Content-Style-Type" content="text/css">

<link rel="top" href="./index.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" title="HackersQuest.org Forum Index" />
<link rel="search" href="./search.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" title="Search" />
<link rel="help" href="./faq.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" title="FAQ" />
<link rel="author" href="./memberlist.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" title="Memberlist" />
<link rel="prev" href="viewtopic.php?t=3899&amp;view=previous&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="View previous topic" />
<link rel="next" href="viewtopic.php?t=3899&amp;view=next&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="View next topic" />
<link rel="up" href="viewforum.php?f=4&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="EverQuest::General" />
<link rel="chapter forum" href="viewforum.php?f=1&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="HackersQuest::General" />
<link rel="chapter forum" href="viewforum.php?f=13&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="HackersQuest.Wizardry" />
<link rel="chapter forum" href="viewforum.php?f=15&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="HackersQuest::MentallyChallenged" />
<link rel="chapter forum" href="viewforum.php?f=16&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="EverQuest II:General" />
<link rel="chapter forum" href="viewforum.php?f=17&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="EverQuest II:Tips and Tricks" />
<link rel="chapter forum" href="viewforum.php?f=4&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="EverQuest::General" />
<link rel="chapter forum" href="viewforum.php?f=2&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="EverQuest::ShowEQ" />
<link rel="chapter forum" href="viewforum.php?f=3&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="EverQuest::Emulator" />
<link rel="chapter forum" href="viewforum.php?f=12&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="EverQuest::EQWindows" />
<link rel="chapter forum" href="viewforum.php?f=14&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="EverQuest::Collector" />
<link rel="chapter forum" href="viewforum.php?f=7&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="AnarchyOnline::General" />
<link rel="chapter forum" href="viewforum.php?f=6&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="DAOC::General" />
<link rel="chapter forum" href="viewforum.php?f=5&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="DAOC::Odin's Eye" />
<link rel="chapter forum" href="viewforum.php?f=9&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="DAOC::DAOCUnleashed" />
<link rel="chapter forum" href="viewforum.php?f=8&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" title="Other::General" />

<title>HackersQuest.org :: View topic - Open S3D Format Documentation</title>
<!-- link rel="stylesheet" href="templates/subSilver/subSilver.css" type="text/css" -->
<style type="text/css">
<!--
/*
  The original subSilver Theme for phpBB version 2+
  Created by subBlue design
  http://www.subBlue.com

  NOTE: These CSS definitions are stored within the main page body so that you can use the phpBB2
  theme administration centre. When you have finalised your style you could cut the final CSS code
  and place it in an external file, deleting this section to save bandwidth.
*/

/* General page style. The scroll bar colours only visible in IE5.5+ */
body {
	background-color: #E5E5E5;
	scrollbar-face-color: #DEE3E7;
	scrollbar-highlight-color: #FFFFFF;
	scrollbar-shadow-color: #DEE3E7;
	scrollbar-3dlight-color: #D1D7DC;
	scrollbar-arrow-color:  #006699;
	scrollbar-track-color: #EFEFEF;
	scrollbar-darkshadow-color: #98AAB1;
}

/* General font families for common tags */
font,th,td,p { font-family: Verdana, Arial, Helvetica, sans-serif }
a:link,a:active,a:visited { color : #006699; }
a:hover		{ text-decoration: underline; color : #DD6900; }
hr	{ height: 0px; border: solid #D1D7DC 0px; border-top-width: 1px;}

/* This is the border line & background colour round the entire page */
.bodyline	{ background-color: #FFFFFF; border: 1px #98AAB1 solid; }

/* This is the outline round the main forum tables */
.forumline	{ background-color: #FFFFFF; border: 2px #006699 solid; }

/* Main table cell colours and backgrounds */
td.row1	{ background-color: #EFEFEF; }
td.row2	{ background-color: #DEE3E7; }
td.row3	{ background-color: #D1D7DC; }

/*
  This is for the table cell above the Topics, Post & Last posts on the index.php page
  By default this is the fading out gradiated silver background.
  However, you could replace this with a bitmap specific for each forum
*/
td.rowpic {
		background-color: #FFFFFF;
		background-image: url(templates/subSilver/images/cellpic2.jpg);
		background-repeat: repeat-y;
}

/* Header cells - the blue and silver gradient backgrounds */
th	{
	color: #FFA34F; font-size: 11px; font-weight : bold;
	background-color: #006699; height: 25px;
	background-image: url(templates/subSilver/images/cellpic3.gif);
}

td.cat,td.catHead,td.catSides,td.catLeft,td.catRight,td.catBottom {
			background-image: url(templates/subSilver/images/cellpic1.gif);
			background-color:#D1D7DC; border: #FFFFFF; border-style: solid; height: 28px;
}

/*
  Setting additional nice inner borders for the main table cells.
  The names indicate which sides the border will be on.
  Don't worry if you don't understand this, just ignore it :-)
*/
td.cat,td.catHead,td.catBottom {
	height: 29px;
	border-width: 0px 0px 0px 0px;
}
th.thHead,th.thSides,th.thTop,th.thLeft,th.thRight,th.thBottom,th.thCornerL,th.thCornerR {
	font-weight: bold; border: #FFFFFF; border-style: solid; height: 28px;
}
td.row3Right,td.spaceRow {
	background-color: #D1D7DC; border: #FFFFFF; border-style: solid;
}

th.thHead,td.catHead { font-size: 12px; border-width: 1px 1px 0px 1px; }
th.thSides,td.catSides,td.spaceRow	 { border-width: 0px 1px 0px 1px; }
th.thRight,td.catRight,td.row3Right	 { border-width: 0px 1px 0px 0px; }
th.thLeft,td.catLeft	  { border-width: 0px 0px 0px 1px; }
th.thBottom,td.catBottom  { border-width: 0px 1px 1px 1px; }
th.thTop	 { border-width: 1px 0px 0px 0px; }
th.thCornerL { border-width: 1px 0px 0px 1px; }
th.thCornerR { border-width: 1px 1px 0px 0px; }

/* The largest text used in the index page title and toptic title etc. */
.maintitle	{
	font-weight: bold; font-size: 22px; font-family: "Trebuchet MS",Verdana, Arial, Helvetica, sans-serif;
	text-decoration: none; line-height : 120%; color : #000000;
}

/* General text */
.gen { font-size : 12px; }
.genmed { font-size : 11px; }
.gensmall { font-size : 10px; }
.gen,.genmed,.gensmall { color : #000000; }
a.gen,a.genmed,a.gensmall { color: #006699; text-decoration: none; }
a.gen:hover,a.genmed:hover,a.gensmall:hover	{ color: #DD6900; text-decoration: underline; }

/* The register, login, search etc links at the top of the page */
.mainmenu		{ font-size : 11px; color : #000000 }
a.mainmenu		{ text-decoration: none; color : #006699;  }
a.mainmenu:hover{ text-decoration: underline; color : #DD6900; }

/* Forum category titles */
.cattitle		{ font-weight: bold; font-size: 12px ; letter-spacing: 1px; color : #006699}
a.cattitle		{ text-decoration: none; color : #006699; }
a.cattitle:hover{ text-decoration: underline; }

/* Forum title: Text and link to the forums used in: index.php */
.forumlink		{ font-weight: bold; font-size: 12px; color : #006699; }
a.forumlink 	{ text-decoration: none; color : #006699; }
a.forumlink:hover{ text-decoration: underline; color : #DD6900; }

/* Used for the navigation text, (Page 1,2,3 etc) and the navigation bar when in a forum */
.nav			{ font-weight: bold; font-size: 11px; color : #000000;}
a.nav			{ text-decoration: none; color : #006699; }
a.nav:hover		{ text-decoration: underline; }

/* titles for the topics: could specify viewed link colour too */
.topictitle,h1,h2	{ font-weight: bold; font-size: 11px; color : #000000; }
a.topictitle:link   { text-decoration: none; color : #006699; }
a.topictitle:visited { text-decoration: none; color : #5493B4; }
a.topictitle:hover	{ text-decoration: underline; color : #DD6900; }

/* Name of poster in viewmsg.php and viewtopic.php and other places */
.name			{ font-size : 11px; color : #000000;}

/* Location, number of posts, post date etc */
.postdetails		{ font-size : 10px; color : #000000; }

/* The content of the posts (body of text) */
.postbody { font-size : 12px; line-height: 18px}
a.postlink:link	{ text-decoration: none; color : #006699 }
a.postlink:visited { text-decoration: none; color : #5493B4; }
a.postlink:hover { text-decoration: underline; color : #DD6900}

/* Quote & Code blocks */
.code {
	font-family: Courier, 'Courier New', sans-serif; font-size: 11px; color: #006600;
	background-color: #FAFAFA; border: #D1D7DC; border-style: solid;
	border-left-width: 1px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px
}

.quote {
	font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px; color: #444444; line-height: 125%;
	background-color: #FAFAFA; border: #D1D7DC; border-style: solid;
	border-left-width: 1px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px
}

/* Copyright and bottom info */
.copyright		{ font-size: 10px; font-family: Verdana, Arial, Helvetica, sans-serif; color: #444444; letter-spacing: -1px;}
a.copyright		{ color: #444444; text-decoration: none;}
a.copyright:hover { color: #000000; text-decoration: underline;}

/* Form elements */
input,textarea, select {
	color : #000000;
	font: normal 11px Verdana, Arial, Helvetica, sans-serif;
	border-color : #000000;
}

/* The text input fields background colour */
input.post, textarea.post, select {
	background-color : #FFFFFF;
}

input { text-indent : 2px; }

/* The buttons used for bbCode styling in message post */
input.button {
	background-color : #EFEFEF;
	color : #000000;
	font-size: 11px; font-family: Verdana, Arial, Helvetica, sans-serif;
}

/* The main submit button option */
input.mainoption {
	background-color : #FAFAFA;
	font-weight : bold;
}

/* None-bold submit button */
input.liteoption {
	background-color : #FAFAFA;
	font-weight : normal;
}

/* This is the line in the posting page which shows the rollover
  help line. This is actually a text box, but if set to be the same
  colour as the background no one will know ;)
*/
.helpline { background-color: #DEE3E7; border-style: none; }

/* Import the fancy styles for IE only (NS4.x doesn't use the @import function) */
@import url("templates/subSilver/formIE.css");
-->
</style>
</head>
<body bgcolor="#E5E5E5" text="#000000" link="#006699" vlink="#5493B4">

<a name="top"></a>

<table width="100%" cellspacing="0" cellpadding="10" border="0" align="center">
	<tr>
		<td class="bodyline"><table width="100%" cellspacing="0" cellpadding="0" border="0">
			<tr>
				<td><a href="index.php?sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/logo_phpBB.gif" border="0" alt="HackersQuest.org Forum Index" vspace="1" /></a></td>
				<td align="center" width="100%" valign="middle"><span class="maintitle">HackersQuest.org</span><br /><span class="gen">Discussions for HackersQuest<br />&nbsp; </span>
				<table cellspacing="0" cellpadding="2" border="0">
					<tr>
						<td align="center" valign="top" nowrap="nowrap"><span class="mainmenu">&nbsp;<a href="faq.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" class="mainmenu"><img src="templates/subSilver/images/icon_mini_faq.gif" width="12" height="13" border="0" alt="FAQ" hspace="3" />FAQ</a></span><span class="mainmenu">&nbsp; &nbsp;<a href="search.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" class="mainmenu"><img src="templates/subSilver/images/icon_mini_search.gif" width="12" height="13" border="0" alt="Search" hspace="3" />Search</a>&nbsp; &nbsp;<a href="memberlist.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" class="mainmenu"><img src="templates/subSilver/images/icon_mini_members.gif" width="12" height="13" border="0" alt="Memberlist" hspace="3" />Memberlist</a>&nbsp; &nbsp;<a href="groupcp.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" class="mainmenu"><img src="templates/subSilver/images/icon_mini_groups.gif" width="12" height="13" border="0" alt="Usergroups" hspace="3" />Usergroups</a>&nbsp;
						&nbsp;<a href="profile.php?mode=register&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" class="mainmenu"><img src="templates/subSilver/images/icon_mini_register.gif" width="12" height="13" border="0" alt="Register" hspace="3" />Register</a></span>&nbsp;
						</td>
					</tr>
					<tr>
						<td height="25" align="center" valign="top" nowrap="nowrap"><span class="mainmenu">&nbsp;<a href="profile.php?mode=editprofile&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" class="mainmenu"><img src="templates/subSilver/images/icon_mini_profile.gif" width="12" height="13" border="0" alt="Profile" hspace="3" />Profile</a>&nbsp; &nbsp;<a href="privmsg.php?folder=inbox&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" class="mainmenu"><img src="templates/subSilver/images/icon_mini_message.gif" width="12" height="13" border="0" alt="Log in to check your private messages" hspace="3" />Log in to check your private messages</a>&nbsp; &nbsp;<a href="login.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" class="mainmenu"><img src="templates/subSilver/images/icon_mini_login.gif" width="12" height="13" border="0" alt="Log in" hspace="3" />Log in</a>&nbsp;</span></td>
					</tr>
				</table></td>
			</tr>
		</table>

		<br />


<table width="100%" cellspacing="2" cellpadding="2" border="0">
  <tr>
	<td align="left" valign="bottom" colspan="2"><a class="maintitle" href="viewtopic.php?t=3899&amp;start=0&amp;postdays=0&amp;postorder=asc&amp;highlight=&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0">Open S3D Format Documentation</a><br />
	  <span class="gensmall"><b></b><br />
	  &nbsp; </span></td>
  </tr>
</table>

<table width="100%" cellspacing="2" cellpadding="2" border="0">
  <tr>
	<td align="left" valign="bottom" nowrap="nowrap"><span class="nav"><a href="posting.php?mode=newtopic&amp;f=4&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/post.gif" border="0" alt="Post new topic" align="middle" /></a>&nbsp;&nbsp;&nbsp;<a href="posting.php?mode=reply&amp;t=3899&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/reply.gif" border="0" alt="Reply to topic" align="middle" /></a></span></td>
	<td align="left" valign="middle" width="100%"><span class="nav">&nbsp;&nbsp;&nbsp;<a href="index.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" class="nav">HackersQuest.org Forum Index</a>
	  -> <a href="viewforum.php?f=4&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" class="nav">EverQuest::General</a></span></td>
  </tr>
</table>

<table class="forumline" width="100%" cellspacing="1" cellpadding="3" border="0">
	<tr align="right">
		<td class="catHead" colspan="2" height="28"><span class="nav"><a href="viewtopic.php?t=3899&amp;view=previous&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" class="nav">View previous topic</a> :: <a href="viewtopic.php?t=3899&amp;view=next&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" class="nav">View next topic</a> &nbsp;</span></td>
	</tr>
	
	<tr>
		<th class="thLeft" width="150" height="26" nowrap="nowrap">Author</th>
		<th class="thRight" nowrap="nowrap">Message</th>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row1"><span class="name"><a name="21983"></a><b>Drysart</b></span><br /><span class="postdetails">Lamer<br /><br /><br />Joined: 21 Mar 2003<br />Posts: 2<br /></span><br /></td>
		<td class="row1" width="100%" height="28" valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
				<td width="100%"><a href="viewtopic.php?p=21983&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0#21983"><img src="templates/subSilver/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Fri Mar 21, 2003 7:27 am<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: Open S3D Format Documentation</span></td>
				<td valign="top" nowrap="nowrap"><a href="posting.php?mode=quote&amp;p=21983&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td>
			</tr>
			<tr>
				<td colspan="2"><hr /></td>
			</tr>
			<tr>
				<td colspan="2"><span class="postbody">If there's one thing that pisses me off, it's people releasing binary-only libraries as the fruits of hours upon hours of study into something as benign as a file format.  So, I'm making it my goal to spread the knowledge around a bit, and perhaps welcome more people into the fold of tinkering around in the EQ Data Files -- there's no need for someone who might someday write some cool new zone explorer or model export utility to be scared off by the fact that all our efforts to date are hidden behind binary libraries (*coughEQInside.dllcough*) -- tying you to whatever platform the original author was working on, or undocumented source code, which is almost as bad as having no source code at all.
<br />

<br />
So, without further ado, I present the S3D File Format, and as far as I know, this is the first public documentation of this file format:
<br />

<br />
<span style="font-size: 18px; line-height: normal"><span style="font-weight: bold">EVERYTHING YOU NEED TO KNOW ABOUT THE PAK/S3D/PFS FILE FORMAT</span></span>
<br />
<a href="mailto:drysart@evercrest.com">drysart@evercrest.com</a> :: Revision 1.0 :: March 21, 2003
<br />

<br />
PAK, S3D, and PFS files are all stored using the same file format on disk. For convenience sake, I will refer to them all as S3D format files.
<br />

<br />
The overall layout of an S3D file is as follows:
<br />

<br />
</span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 	  <td><span class="genmed"><b>Code:</b></span></td>	</tr>	<tr>	  <td class="code">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Start of file
<br />
&nbsp; &nbsp;+-------------------------------+
<br />
&nbsp; &nbsp;| &#40;Very brief&#41; head information |&nbsp; &lt;-- TS3DFileHeader
<br />
&nbsp; &nbsp;+-------------------------------+
<br />
&nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|
<br />
&nbsp; &nbsp;|&nbsp; Contents of packaged files&nbsp; &nbsp;|&nbsp; &lt;-- Data area
<br />
&nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#40;huge!&#41;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|
<br />
&nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|
<br />
&nbsp; &nbsp;+-------------------------------+
<br />
&nbsp; &nbsp;|&nbsp; File directory information&nbsp; &nbsp;|&nbsp; &lt;-- S3D Directory
<br />
&nbsp; &nbsp;+-------------------------------+
<br />
&nbsp; &nbsp;|&nbsp; &nbsp;&#40;Very brief&#41; file footer&nbsp; &nbsp; |&nbsp; &lt;-- TS3DFileFooter
<br />
&nbsp; &nbsp;+-------------------------------+
<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End of file</td>	</tr></table><span class="postbody">
<br />

<br />
The four sections of the file, labelled above as "TS3DFileHeader",
<br />
"Data area", "S3D Directory", and "TS3DFileFooter", are described
<br />
in detail below, in the approximate order you will need to deal with them in the process of reading data from an S3D file.
<br />

<br />
<span style="font-size: 16px; line-height: normal"><span style="font-weight: bold">TS3DFileHeader</span></span>
<br />
TS3DFileHeader is a record that begins at the start of the file (position 0). It is 12 bytes long, in the following format:
<br />

<br />
</span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 	  <td><span class="genmed"><b>Code:</b></span></td>	</tr>	<tr>	  <td class="code">&nbsp; &nbsp;typedef struct &#123;
<br />
&nbsp; &nbsp; &nbsp; int directoryOffset;
<br />
&nbsp; &nbsp; &nbsp; char magicCookie&#91;4&#93;;
<br />
&nbsp; &nbsp; &nbsp; int unknown_always_131072;
<br />
&nbsp; &nbsp;&#125; TS3DFileHeader;</td>	</tr></table><span class="postbody">
<br />

<br />
<ul>
<br />
<li> directoryOffset is the file position of the start of the S3D file directory. See the section titled "S3D Directory" for details on what you'll find at that file position.
<br />
<li> magicCookie is 4 bytes, which always seem to be the ASCII data "PFS" and a space character.  You should validate this cookie whenever you attempt to read in an S3D File.
<br />
<li> unknown_always_131072 has an unknown meaning, but always seems to be 131072.
<br />
</ul>
<br />

<br />
<span style="font-size: 16px; line-height: normal"><span style="font-weight: bold">S3D Directory</span></span>
<br />
The S3D Directory contains the locations and lengths of all the files contained in this S3D package, but does not contain their names - see below for information regarding the file names.
<br />

<br />
The S3D Directory begins immediately with a 4 byte int containing the number of entries in the directory. Following that value are the approprate number of records in this format:
<br />

<br />
</span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 	  <td><span class="genmed"><b>Code:</b></span></td>	</tr>	<tr>	  <td class="code">&nbsp; &nbsp;typedef struct &#123;
<br />
&nbsp; &nbsp; &nbsp; int unknown_maybe_CRC;
<br />
&nbsp; &nbsp; &nbsp; int dataOffset;
<br />
&nbsp; &nbsp; &nbsp; int dataLengthInflated;
<br />
&nbsp; &nbsp;&#125; TS3DDirectoryEntry;</td>	</tr></table><span class="postbody">
<br />

<br />
Immediately following the last S3D Directory entry is the S3D File Footer, described in the section titled "TS3DFileFooter".
<br />

<br />
The directory entries are not in any discernable order. The names of the files are stored as data in a directory entry (it appears that they are always in the directory entry with the highest dataOffset value). See the section titled "Data Area" for information on how to extract the file behind a directory entry, and see the section titled "Directory File Names" for information on how to process the file name list.
<br />

<br />
<span style="font-size: 16px; line-height: normal"><span style="font-weight: bold">TS3DFileFooter</span></span>
<br />
The TS3DFileFooter is the last thing in a S3D File. It is a record that should immediately follow the last Directory Entry, and the file should end immediately following the TS3DFileFooter. It is in the following format:
<br />

<br />
</span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 	  <td><span class="genmed"><b>Code:</b></span></td>	</tr>	<tr>	  <td class="code">&nbsp; &nbsp;typedef struct &#123;
<br />
&nbsp; &nbsp; &nbsp; char steve_cookie&#91;5&#93;;
<br />
&nbsp; &nbsp; &nbsp; int unknown_maybe_overall_CRC;
<br />
&nbsp; &nbsp;&#125; TS3DFileFooter;</td>	</tr></table><span class="postbody">
<br />

<br />
<ul>
<br />
<li>steve_cookie always seems to contain the ASCII data "STEVE". You should validate this cookie whenever you attempt to read in an S3D File.
<br />
<li>unknown_maybe_overall_CRC contains data that is not understood currently. I suspect it contains a CRC or checksum of the S3D File or the S3D Directory.
<br />
</ul>
<br />

<br />
<span style="font-size: 16px; line-height: normal"><span style="font-weight: bold">Data area</span></span>
<br />
The data area consists of File Block records. To extract a file, you first search through the S3D Directory to find the dataOffset and dataLengthInflated values for the file you want to extract.  Then, beginning at the dataOffset position in the file, process File Blocks one by one until you reach dataLengthInflated bytes of output.
<br />

<br />
A Data Block consists of a small header, followed by a given number of bytes of compressed data. The header is in the following format:
<br />

<br />
</span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 	  <td><span class="genmed"><b>Code:</b></span></td>	</tr>	<tr>	  <td class="code">&nbsp; &nbsp;typedef struct &#123;
<br />
&nbsp; &nbsp; &nbsp; int deflatedLength;
<br />
&nbsp; &nbsp; &nbsp; int inflatedLength;
<br />
&nbsp; &nbsp;&#125; TS3DDataBlockHeader;</td>	</tr></table><span class="postbody">
<br />

<br />
<ul>
<br />
<li>deflatedLength specifies how big this block is as it is stored in the S3D file, compressed.
<br />
<li>inflatedLength specifies how big this block is when it is uncompressed.
<br />
</ul>
<br />

<br />
The header is followed by deflatedLength bytes of data.  This data is compressed using the ZLib standard "deflate" algorithm, and can be decompressed using the corresponding "inflate" algorithm. The resulting decompressed data will be inflatedLength bytes in length.  A discussion of ZLib, deflate, and inflate is beyond the scope of this document.
<br />

<br />
<span style="font-size: 16px; line-height: normal"><span style="font-weight: bold">Directory File Names</span></span>
<br />
As the S3D Directory itself does not contain file names, every S3D File contains, as one of its packaged files, a list of the file names. This file can be extracted from the Data Area as normal, and then processed in the following manner:
<br />

<br />
The file begins with a 4 byte int value, giving the number of filenames stored. Then, for each file name is stored a 4 byte int value giving the length of the file name including a trailing NUL character, then that many bytes of data. Visually, the file is structured as such:
<br />

<br />
</span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 	  <td><span class="genmed"><b>Code:</b></span></td>	</tr>	<tr>	  <td class="code">&lt;FNCOUNT&gt; &lt;FNLEN&gt; fndata &lt;FNLEN&gt; fndata &lt;FNLEN&gt; fndata ...</td>	</tr></table><span class="postbody">
<br />

<br />
The file names are stored in the same order they are in the S3D Directory. 
<br />

<br />
<span style="font-size: 16px; line-height: normal"><span style="font-weight: bold">Caveat</span></span>
<br />
Although this information is intended to be accurate, subtle inaccuracies may exist.  I would appreciate any corrections to be emailed to me at <a href="mailto:drysart@evercrest.com">drysart@evercrest.com</a>.  I would also like any assistance that could be given creating public documentation of other EQ file formats, such as the WLD format.</span><span class="gensmall"></span></td>
			</tr>
		</table></td>
	</tr>
	<tr>
		<td class="row1" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row1" width="100%" height="28" valign="bottom" nowrap="nowrap"><table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr>
				<td valign="middle" nowrap="nowrap"><a href="profile.php?mode=viewprofile&amp;u=23302&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_profile.gif" alt="View user's profile" title="View user's profile" border="0" /></a> <a href="privmsg.php?mode=post&amp;u=23302&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_pm.gif" alt="Send private message" title="Send private message" border="0" /></a> <a href="mailto:drysart@evercrest.com"><img src="templates/subSilver/images/lang_english/icon_email.gif" alt="Send e-mail" title="Send e-mail" border="0" /></a>    <script language="JavaScript" type="text/javascript"><!--

	if ( navigator.userAgent.toLowerCase().indexOf('mozilla') != -1 && navigator.userAgent.indexOf('5.') == -1 && navigator.userAgent.indexOf('6.') == -1 )
		document.write(' ');
	else
		document.write('</td><td>&nbsp;</td><td valign="top" nowrap="nowrap"><div style="position:relative"><div style="position:absolute"></div><div style="position:absolute;left:3px;top:-1px"></div></div>');

				//--></script><noscript></noscript></td>
			</tr>
		</table></td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/subSilver/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row2"><span class="name"><a name="21985"></a><b>Smarmius</b></span><br /><span class="postdetails">Lamer<br /><br /><br />Joined: 25 Sep 2002<br />Posts: 28<br /></span><br /></td>
		<td class="row2" width="100%" height="28" valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
				<td width="100%"><a href="viewtopic.php?p=21985&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0#21985"><img src="templates/subSilver/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Fri Mar 21, 2003 9:13 am<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: nice</span></td>
				<td valign="top" nowrap="nowrap"><a href="posting.php?mode=quote&amp;p=21985&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td>
			</tr>
			<tr>
				<td colspan="2"><hr /></td>
			</tr>
			<tr>
				<td colspan="2"><span class="postbody">Props.</span><span class="gensmall"></span></td>
			</tr>
		</table></td>
	</tr>
	<tr>
		<td class="row2" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap"><table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr>
				<td valign="middle" nowrap="nowrap"><a href="profile.php?mode=viewprofile&amp;u=22329&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_profile.gif" alt="View user's profile" title="View user's profile" border="0" /></a> <a href="privmsg.php?mode=post&amp;u=22329&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_pm.gif" alt="Send private message" title="Send private message" border="0" /></a>     <script language="JavaScript" type="text/javascript"><!--

	if ( navigator.userAgent.toLowerCase().indexOf('mozilla') != -1 && navigator.userAgent.indexOf('5.') == -1 && navigator.userAgent.indexOf('6.') == -1 )
		document.write(' ');
	else
		document.write('</td><td>&nbsp;</td><td valign="top" nowrap="nowrap"><div style="position:relative"><div style="position:absolute"></div><div style="position:absolute;left:3px;top:-1px"></div></div>');

				//--></script><noscript></noscript></td>
			</tr>
		</table></td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/subSilver/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row1"><span class="name"><a name="32618"></a><b>hannerii</b></span><br /><span class="postdetails">Lamer<br /><br /><br />Joined: 05 May 2004<br />Posts: 1<br /></span><br /></td>
		<td class="row1" width="100%" height="28" valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
				<td width="100%"><a href="viewtopic.php?p=32618&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0#32618"><img src="templates/subSilver/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Mon May 17, 2004 2:59 am<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: </span></td>
				<td valign="top" nowrap="nowrap"><a href="posting.php?mode=quote&amp;p=32618&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td>
			</tr>
			<tr>
				<td colspan="2"><hr /></td>
			</tr>
			<tr>
				<td colspan="2"><span class="postbody">I've recently been trying to comprehend the S3D format and have been using the structure shown on this post.  I came across a probelm i cant quite solve.  using akanon.s3d as an example here is what I extrapolated from the Header: 
<br />
     Directory Offset:1718797
<br />
     Magic String     :PFS_
<br />
     Unknown          :131702
<br />
from the footer I got:
<br />
     Steve:STEVE
<br />
     Unknown:1529392438 (36 ad 28 5b)
<br />
The file length is 1720202.
<br />
According to this i have determined that the directoy and the footer is equal to 1405 bytes and subtracting the foother(9 bytes) 1396 bytes.
<br />
if i divide 1396 by 12 i get 116.3333, whereas if subtract 10 bytes (for the terminator) and divide by 12 i get 116.25....My question is where is the extra .25 or .33 coming from?  If anyone could help me solve this quandry i would be most happy.  Thanks in advance.</span><span class="gensmall"></span></td>
			</tr>
		</table></td>
	</tr>
	<tr>
		<td class="row1" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row1" width="100%" height="28" valign="bottom" nowrap="nowrap"><table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr>
				<td valign="middle" nowrap="nowrap"><a href="profile.php?mode=viewprofile&amp;u=24930&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_profile.gif" alt="View user's profile" title="View user's profile" border="0" /></a> <a href="privmsg.php?mode=post&amp;u=24930&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_pm.gif" alt="Send private message" title="Send private message" border="0" /></a>     <script language="JavaScript" type="text/javascript"><!--

	if ( navigator.userAgent.toLowerCase().indexOf('mozilla') != -1 && navigator.userAgent.indexOf('5.') == -1 && navigator.userAgent.indexOf('6.') == -1 )
		document.write(' ');
	else
		document.write('</td><td>&nbsp;</td><td valign="top" nowrap="nowrap"><div style="position:relative"><div style="position:absolute"></div><div style="position:absolute;left:3px;top:-1px"></div></div>');

				//--></script><noscript></noscript></td>
			</tr>
		</table></td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/subSilver/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row2"><span class="name"><a name="32868"></a><b>Drysart</b></span><br /><span class="postdetails">Lamer<br /><br /><br />Joined: 21 Mar 2003<br />Posts: 2<br /></span><br /></td>
		<td class="row2" width="100%" height="28" valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
				<td width="100%"><a href="viewtopic.php?p=32868&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0#32868"><img src="templates/subSilver/images/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0" /></a><span class="postdetails">Posted: Thu May 27, 2004 5:32 pm<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: </span></td>
				<td valign="top" nowrap="nowrap"><a href="posting.php?mode=quote&amp;p=32868&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0" /></a>   </td>
			</tr>
			<tr>
				<td colspan="2"><hr /></td>
			</tr>
			<tr>
				<td colspan="2"><span class="postbody">Note that the Directory begins with an int (4 bytes) that contains the number of entries in the directory. Your calculated directory size of 1396 bytes, minus the 4 bytes for the leading count int, leaves 1392, which is 116 directory entries. (This should also be the value of that first count int.)</span><span class="gensmall"></span></td>
			</tr>
		</table></td>
	</tr>
	<tr>
		<td class="row2" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap"><table cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<tr>
				<td valign="middle" nowrap="nowrap"><a href="profile.php?mode=viewprofile&amp;u=23302&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_profile.gif" alt="View user's profile" title="View user's profile" border="0" /></a> <a href="privmsg.php?mode=post&amp;u=23302&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/icon_pm.gif" alt="Send private message" title="Send private message" border="0" /></a> <a href="mailto:drysart@evercrest.com"><img src="templates/subSilver/images/lang_english/icon_email.gif" alt="Send e-mail" title="Send e-mail" border="0" /></a>    <script language="JavaScript" type="text/javascript"><!--

	if ( navigator.userAgent.toLowerCase().indexOf('mozilla') != -1 && navigator.userAgent.indexOf('5.') == -1 && navigator.userAgent.indexOf('6.') == -1 )
		document.write(' ');
	else
		document.write('</td><td>&nbsp;</td><td valign="top" nowrap="nowrap"><div style="position:relative"><div style="position:absolute"></div><div style="position:absolute;left:3px;top:-1px"></div></div>');

				//--></script><noscript></noscript></td>
			</tr>
		</table></td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/subSilver/images/spacer.gif" alt="" width="1" height="1" /></td>
	</tr>
	<tr align="center">
		<td class="catBottom" colspan="2" height="28"><table cellspacing="0" cellpadding="0" border="0">
			<tr><form method="post" action="viewtopic.php?t=3899&amp;start=0&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0">
				<td align="center"><span class="gensmall">Display posts from previous: <select name="postdays"><option value="0" selected="selected">All Posts</option><option value="1">1 Day</option><option value="7">7 Days</option><option value="14">2 Weeks</option><option value="30">1 Month</option><option value="90">3 Months</option><option value="180">6 Months</option><option value="364">1 Year</option></select>&nbsp;<select name="postorder"><option value="asc" selected="selected">Oldest First</option><option value="desc">Newest First</option></select>&nbsp;<input type="submit" value="Go" class="liteoption" name="submit" /></span></td>
			</form></tr>
		</table></td>
	</tr>
</table>

<table width="100%" cellspacing="2" cellpadding="2" border="0" align="center">
  <tr>
	<td align="left" valign="middle" nowrap="nowrap"><span class="nav"><a href="posting.php?mode=newtopic&amp;f=4&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/post.gif" border="0" alt="Post new topic" align="middle" /></a>&nbsp;&nbsp;&nbsp;<a href="posting.php?mode=reply&amp;t=3899&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0"><img src="templates/subSilver/images/lang_english/reply.gif" border="0" alt="Reply to topic" align="middle" /></a></span></td>
	<td align="left" valign="middle" width="100%"><span class="nav">&nbsp;&nbsp;&nbsp;<a href="index.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" class="nav">HackersQuest.org Forum Index</a>
	  -> <a href="viewforum.php?f=4&amp;sid=ae192ca4556b8faab4483cf5b63ad5a0" class="nav">EverQuest::General</a></span></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">All times are GMT + 1 Hour</span><br /><span class="nav"></span>
	  </td>
  </tr>
  <tr>
	<td align="left" colspan="3"><span class="nav">Page <b>1</b> of <b>1</b></span></td>
  </tr>
</table>

<table width="100%" cellspacing="2" border="0" align="center">
  <tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"><span class="gensmall"></span><br />
	  &nbsp;<br />
	  </td>
	<td align="right" valign="top" nowrap="nowrap">
<form method="get" name="jumpbox" action="viewforum.php?sid=ae192ca4556b8faab4483cf5b63ad5a0" onSubmit="if(document.jumpbox.f.value == -1){return false;}"><table cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td nowrap="nowrap"><span class="gensmall">Jump to:&nbsp;<select name="f" onchange="if(this.options[this.selectedIndex].value != -1){ forms['jumpbox'].submit() }"><option value="-1">Select a forum</option><option value="-1">&nbsp;</option><option value="-1">HackersQuest</option><option value="-1">----------------</option><option value="1">HackersQuest::General</option><option value="13">HackersQuest.Wizardry</option><option value="15">HackersQuest::MentallyChallenged</option><option value="-1">&nbsp;</option><option value="-1">EverQuest II</option><option value="-1">----------------</option><option value="16">EverQuest II:General</option><option value="17">EverQuest II:Tips and Tricks</option><option value="-1">&nbsp;</option><option value="-1">EverQuest</option><option value="-1">----------------</option><option value="4"selected="selected">EverQuest::General</option><option value="2">EverQuest::ShowEQ</option><option value="3">EverQuest::Emulator</option><option value="12">EverQuest::EQWindows</option><option value="14">EverQuest::Collector</option><option value="-1">&nbsp;</option><option value="-1">Anarchy Online</option><option value="-1">----------------</option><option value="7">AnarchyOnline::General</option><option value="-1">&nbsp;</option><option value="-1">Dark Age of Camelot</option><option value="-1">----------------</option><option value="6">DAOC::General</option><option value="5">DAOC::Odin's Eye</option><option value="9">DAOC::DAOCUnleashed</option><option value="-1">&nbsp;</option><option value="-1">Other Games</option><option value="-1">----------------</option><option value="8">Other::General</option></select><input type="hidden" name="sid" value="ae192ca4556b8faab4483cf5b63ad5a0" />&nbsp;<input type="submit" value="Go" class="liteoption" /></span></td>
	</tr>
</table></form>

<span class="gensmall">You <b>cannot</b> post new topics in this forum<br />You <b>cannot</b> reply to topics in this forum<br />You <b>cannot</b> edit your posts in this forum<br />You <b>cannot</b> delete your posts in this forum<br />You <b>cannot</b> vote in polls in this forum<br /></span></td>
  </tr>
</table>


<div align="center"><span class="copyright"><br /><br />
<!--
	We request you retain the full copyright notice below including the link to www.phpbb.com.
	This not only gives respect to the large amount of time given freely by the developers
	but also helps build interest, traffic and use of phpBB 2.0. If you cannot (for good
	reason) retain the full copyright we request you at least leave in place the
	Powered by phpBB line, with phpBB linked to www.phpbb.com. If you refuse
	to include even this then support on our forums may be affected.

	The phpBB Group : 2002
// -->
Powered by <a href="http://www.phpbb.com/" target="_phpbb" class="copyright">phpBB</a> &copy; 2001, 2005 phpBB Group<br /></span></div>
		</td>
	</tr>
</table>

</body>
</html>

