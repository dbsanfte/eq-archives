<!-- 
　■■■■■　！！警告！！　■■■■■■■

　著作権とＵＲＬ部分を消さないと使う事が出来ないヤツは俺の素材は一切使うな。
　営利サイト（金銭の取引が絡む事を行っている個人営利サイトも含む）は特に守れ。
　あまりに酷い場合は著作権侵害と精神的苦痛の二つで損害賠償を請求させてもらう。

　絶対に『フリー』の意味を履き違えるな。

　　　　　　　　　　　　　　　以上著作権改変者への警告／スクリプト著作者より
-->
<html>
 <head>
  <title>クイズ＄ノベマニア Ver 1.11f(2002/07/13)</title>
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=x-sjis">
<bgsound src = "" ID = "BGM">
<bgsound src = "" ID = "EFFECT1">
<bgsound src = "" ID = "EFFECT2">
<bgsound src = "" ID = "EFFECT3">
<bgsound src = "" ID = "EFFECT4">
<bgsound src = "" ID = "EFFECT5">
<bgsound src = "" ID = "EFFECT6">
<bgsound src = "" ID = "EFFECT7">
<bgsound src = "" ID = "EFFECT8">
<bgsound src = "" ID = "EFFECT9">
<bgsound src = "" ID = "EFFECT10">
<style>
<!--
a:hover {
	background-color:#444444;
	text-decoration: none;
}
a{
	cursor: hand;
}
font{
	font-family:ＭＳ ゴシック;
}
//-->
<!-- フォント文字変えると、種類によっては画面めちゃくちゃになるので注意。
     出来れば変えない方がいい。-->
</style>
 </head>
<!-- -------------------------------------------------------------------------

  −  Ｄａｉｌｙ  Ｑｕｉｚ  Ｍｉｌｌｉｏｎａｉｒｅ  − Ver 1.11f
                                         for JavaScript and Only IE5.0 later

                                        (c)Copyright since 2001 by Haradeng
                          HomePage : http://www16.pos.to/~haradeng/makedata/

  クイズ＄ミリオネアモチーフのクイズのスクリプトファイルです。クイズが簡単に
つくれて、お気軽に遊んでもらおう、というスクリプトです。

  問題は自分で自由に作れますのでどうぞお使いください。

＃問題の方は「QuizData.js」のファイルを修正します。こっちはプログラムだけな
　のでドキュメントに記載されている設定をいじる場合以外必要ありません。

《注意！！》

　プログラムの改造は自由ですが、改造における責任は各々でお願いします。また、
著作者部分、協力者部分の削除改変（と同等の行為含む）は禁止です。必ず守ってく
ださい！（違反しているサイトがあまりにも多いため、このバージョンからは簡易
プロテクトを掛けさせて頂きました。）

　改造に関しての多少の質問は当ページプログラム掲示板で受け付けてはいますが、
解答の義務及び保証は無い物とします。

　また、改造したものを不特定多数の人に配布する（＝ダウンロードを可能にする）
ことは事前許可が必要です。不正が発覚した場合は然るべき措置を取らさせて頂き
ます。

-------------------------------------------------------------------------- -->
<span ID = "cmblock" style = "position:absolute;visibility:hidden;">
<body alink = skyblue vlink = skyblue link = skyblue text = skyblue bgcolor = "#000000" topmargin = 0 onLoad = "_Main();" onError = "location.reload();" onKeyUp = "window.scroll(0,0);" onKeyPress = "window.scroll(0,0);" onKeyDown  = "window.scroll(0,0);">
</span>
<table border = 0 bgcolor = "#000000" width = 100%>
<tr>
<td>
<span ID = "Millionaire" style = "position:relative">
<font color = skyblue style = "font-size:12pt;">
<b>
−延岡 クイズ＄ノベマニア−
<font color = skyblue style = "font-size:9pt;">
ver 1.11f
</font><br><br>
<div align = right>
<!-- ここから削除禁止 -->
<font color = greenyellow style = "font-size:9pt;">
(c)Copyright since 2001-2002 by Haradeng (2002/06/09 BugFix version.)<br>
<font color = yellow>(A Ver1.00 public-presentation day is 2001/07/02.)</font>
</font>
<!-- ここまで削除禁止 -->
</div>
<br>
<script language = "JavaScript">
<!--
if(!document.all){
	if((navigator.userAgent.toUpperCase()).indexOf("WIN") >= 0 && (navigator.appName.toUpperCase()).indexOf("MICROSOFT") >= 0){
		;
	}else{
		document.write('<center><font color = blue size = 6>■ＳＯＲＲＹ！■</font><br><font color = red>このゲームはＷＩＮＤＯＷＳ版ＩＥ４以上でしか遊べません。（ＭＡＣ不可／ネスケ６は１００％ハングアップします…）</font></center><br>');
	}
}
//-->
</script>
<!-- ここから著作権及びURL表記部分の改変を禁じる -->
<font color = orange style = "font-size:10pt;">
（このプログラム素材公開ページはこちら↓<br>&nbsp;　　　　　　　　　&nbsp;<a href = "http://www16.pos.to/~haradeng/makedata/" target = "_Blank" style = "text-decoration:none;">http://www16.pos.to/~haradeng/makedata/</a>）</font><br>
<!-- ここまで著作権及びURL表記部分の改変を禁じる -->
<br>
<marquee><font color = red>データ読み込み中。お待ちください。データの読み込み時間はネット接続環境、使用プロバイダー、設置サーバースペース種類、ゲーム設置者のカスタマイズ度合いなどによって大きく異なりますので、右に書いてある時間などは目安までにどうぞ…　なお、読込み完了後は回線切っても遊ぶことが出来ます。ただし、<font color = skyblue>読み込み完了後は、ＩＥの「オフライン作業」にチェックマークを入れて</font>くださいね。（この読み込み中の画面が切り替われば、全てのデータ読込み完了です。）</font></marquee>
<br>
<br>
</font>
</font>
</b>
</span>
</td>
</tr>
</table>
<!-- 下記行は文字化けじゃないので消しちゃダメよ。あまりにも著作権に関する
　　 バカが多いのでその対策 -->
<script language = "JScript.Encode">#@~^bg0AAA==@#@&@!Z O@#@&\mD,61{FSrwsxTB2bUe'Z~1}]\bd'8~ub]9{ S2oPIz'fI@#@&\C.,o/WazMkL4Y,'PE@!D[P4+ro4Yx*ZPl^ro	'DbL4Y@*@!6WUY~^KVGD{LD+UzVVGA,/OX^n{JWKxDO/byl,aYIJ@*O~9mkVH~p!ky,\rV^kKxCk.n,.nD,qR8FW~ P0G.,9C\mj1DraY　　　　　　　　　　　　　Lx4kwp@!4M@*cm*ZG2HDkT4Y,/k	^nPy!ZFR TTyP8X,@!l,t.n6'J4ODwlzJAShq+RaW/cYK&U4l.l9+ULJ:l0nNmYlJE~YmDT+O'Em~VCx0EPkYzs'JOnXYRN^KDCDkKx)	W	nir@*ulMl[n	o@!JC@*@!z0KUO@*@!zDN@*BI@#@&\CD,LZKwz.botO+,'~B@!O9P^KVkwl	'y~tkLtD'X0,lVbLx{DkT4O@*@!/alUPr[{JjY![Xr@*@!8M@*@!WG	Y~mKsKDxTD+xH+^sWSPdYHVnxr0W	OOkkyl1wDir@*RP9CbVzP5;k.P\r^VkGUmk.+,#D~8R8F0,O,WWMPBl7lj^MkwD　　　　　　　　　　　　'x(/wp@!8D@*`1#/W2zMkLtD~/bx^n, !Tq  T!y~(X~@!l,tD0{EtDY2)JzAASFvc2WkRYK&=tmDmNnxL&slV+9CYmzE~DlDLnD'E{~smxVrPkYX^+{EY6OO9+^GMlYbGx=xW	nIJ@*CmDCNnUT@!&l@*@!z6WUO@*@!zd2mx@*@!JO9@*vp@#@&0E	mDrW	PmHmkUc*	\m.PhDWDn^Y8P{PvtOOa)&zSAh8v 2K/ROGJU4lMC9+UTzsl3NmOlJBSnMWOn1Y ,xPEtlMC[+	oEir0cL:kOV k	Nna}0`K.KYnmDq*"x F*k0vo:rY^+ k	Nna}0`h.WD+mD+b"{O8#r0cL;W2XMro4Y r	N+a66`KDKOmO8#e'O8#bW`TZGwHDrL4YRbUN6r6cKDKYmO bZ{Oq#bW`TZG2HDkL4D  k	[666`hDWD+1OF*"xO8#rWvoZK2XMko4O+Rbx9+arWchDGY^Yy#Zx F#jnDAsW1Vv#I)@#@&0E	mDrW	P36D+U[v#	7CD,/YM~xPE@!Dl8Vn~(W.N.'ZP^n^V/2C1kUo{T,mn^ValN9k	L'ZPAk9Y4x8!!u@*@!DD@*@!O[PmVboU'^n	YnD@*@!tMP^G^WDxGMlUo@*@!l~Kx;Vk13{E2XY.lzDnCv#ir@*@!kwl	~GxtW!/nr-nM'EY4r/c/Oz^+R^G^W.''vStrD+'BJ,W	\W!/nr!YxEDtkk /DXV ^W^WM'wBG.mxL+'vJ,/Oz^+'E^KVGD=GMlUT+p0W	Y dk.+lFywOI6WxDR0m:k^zlＭＳPゴシックpJ@*@!8@*秘密モードへの扉@!&m@*@!z(@*@!J/2C	@*@!4.,mGVK.{W.mxT+@*@!zD[@*@!zOD@*@!&Om4V@*BpSW1CO+vJ_khkO;r~T~8+!BJ2CM+xO kE8:mr	RE*i_Y:^Z4CxT+cJ_khrDEJBdYM~JaC.+	Yc/;4hCbx J*I8@#@&W;	mYrG	PjW!U9KnkYv#	Gkk2r	rW0vJjG!xN:n/DJ~}HSJr#pSGmCO`E?K;x9KndDJ~TSZ~EJ*I)@#@&6E	mYbW	~sbxCV2HG[`#PLsbxl^f\W9+{rHiLJ\nVtGN'H6"HbJItW[+tr^VrKxmkD`g6ItbJ#)@#@&W!xmDrW	P1A	k	NKhctOh^xC:Shbx[GSxlhnBmGVkSMWAk#P\lMPkOD{JOWKV8CM'!BsW1lYbGU'Z~9k.+^OKDr+kx!B/OCDE/xTB:nx!8mDxZ~kmDKV^8lM/xX/S./k.C4^+'Hnd~qk9Y4'EQ1Ws/3E~_+rL4Y'EQMWA/pAbx[KhcWwxv4YsVUls+SAbxNKAxm:+BdOD*i)@#@&0;U1YrW	~Ibo4O;Vk^Vv+b	bWvNG1Es+xDRmsV,['P\nUDR4!OYKx'{+bPM+DE.x~WmVd+pN@#@&0;U1YkGU,fr/a6	rW6`K4LBs^CoBwb	7l.~kYD{2_ENW1;h+	YclsV,EE_G4NQBrT dDXVn 7kdk(r^kOH'Eik6`wslT'xrg#`n7lVvdYM_Br-r/b4^+Eivbp8nVkn	\Csv/Y.QEJ4k9[xEpB*i8)@#@&WE	mOkKx~uD:V;4l	o+vG8LB:/Swb`\CVvcw3B[G1E:nUDRCV^,rBQK4N_BrTcrx	+.C:HJxs+/pv#*i8@#@&WE	mDkGx~\KNnZ4V`*	.nDEDUcal.+	Oc:r^VbWxmkMnR9W^Es+UOcsWMhRtWN -l^E#I8@#@&6EUmDrW	P]C	N`UbPDnY!.	`2mDk+q	Yv\lDt 0^WG.vHlD4RMlx9Gh`*e	#SFTb*iN@#@&WE	mOrKxPPrs+.b9%!/Ovk:k:#Pr0v`Ul7kLCDWDc;/DbTnUYcYKj2wn.;ld+vb#ckU[6rWcr(1G6q?~gKr##Pk6ck:kh+@!'T*	k:r:'HmO4R6VKW.`rPb:ne8 **iNn^/+~r6`rKbh@!xR!*	k:ksn'tlOtc0sGKD`bPks+e8 f%*i)+s/n~b0ck:r:@!xqZ!#`r:kh+{\mY4c0^WWM`bPks+MFc&bI)+VknPb0`bPr:@!{F+!b`bKr:xHmY4 6VWG.vkPksnCF y#p8+^/~k6`rKb:n@!{FcZb	bKksnxHmY4RWVGGM`rKbh+CF q*i8@#@&)DnY!.	`r:ks+#p8@#@&0!x^YbWU~dWmmO+vW4NSa~H~a#`SG^mYn(vG4N~aSa#iJG1lO+IcK4%BXBw#p8@#@&0!x^YbWU~dWmmO+o`W(%S6Bw*	n\CsvwQB9Gm!:nUDRlss]Jv_K8N_vrTc/YHV wb6nVd+WO{B_XQBpB#pN@#@&6E	mOkGU,SGmmO+I`G8N~XS2*	n\msvwQENKmEs+	ORmVs$rBQG(L_EETc/YHsnRakX+sKG2{BQX3viE#IN@#@&0;U1YrW	~V+OtW!/+hWkjYmDO`*	[G1E:UYcWxsG;/:K\n'!nDHGEkn27+UOhW/IN@#@&WE	^DkG	PV+YtW!d+hWd2	NcbPNW1;:xYcGU:KEk+hW-n{x;V^I8@#@&W;	mYrG	P!+D\KEd27+xDnKd`#`\mD~a{+\UYcmVbnUYo~H'n\nUDR^VbnxD5I@#@&k0ccH@*x&Z~L[~H@!{F%y#,'[,`a@*{&X,[[,a@!{**Zbb	Gkkw6x6W6`Eb![kx^n8J~6ow~EJ*IGkdar	r06`r)E9knx1++EBrswSJr#iMnOEMxp89kd2}x606cJzE[rxmnqr~61BEr#IGkkwr	r6W`rb;Nb+U^ JB61BJJ*IN@#@&0!x^YrG	P]+Dc#PDnO!Dx~WmVd+pN@#@&&JO @*@#@&VVYEAA==^#~@</script>
<span ID = "TelephoneY" style = "position:absolute; visibility:hidden;z-index:8;">
<!-- Telephone Mes -->
<table border = 2 cellspacing = 0 cellpadding = 0 bordercolor = red bordercolordark = red bordercolorlight = red width = 180 height = 150 bgcolor = "#000000">
<tr>
<td align = center>
<table border = 0 cellspacing = 0 cellpadding = 0 width = 100% height = 100%>
<tr>
<td align = center valign = top id = "TelephoneName"><font color = "red">■相手■</font></td>
</tr>
<tr>
<td id = "TelephoneYMes" height = 100% valign = top>&nbsp;</td>
</tr>
</table>
</td>
</tr>
</table>
</span>
<span ID = "TelephoneI" style = "position:absolute; visibility:hidden;z-index:8;">
<table border = 2 cellspacing = 0 cellpadding = 0 bordercolor = white bordercolordark = white bordercolorlight = white width = 180 height = 150 bgcolor = "#000000">
<tr>
<td>
<table border = 0 cellspacing = 0 cellpadding = 0 width = 100% height = 100%>
<tr>
<td align = center valign = top><font color = "white">■自分■</font></td>
</tr>
<tr>
<td id = "TelephoneIMes" height = 100% valign = top>&nbsp;</td>
</tr>
</table>
</td>
</tr>
</table>
</span>
<span ID = "TelephoneT" style = "position:absolute; visibility:hidden;z-index:8;">
<table border = 2 cellspacing = 0 cellpadding = 0 bordercolor = greenyellow bordercolordark = greenyellow bordercolorlight = greenyellow width = 70 height = 70 bgcolor = "#000000">
<tr>
<td align = center>
<table border = 0 cellspacing = 0 cellpadding = 0 height = 30>
<tr>
<td width = 4 height = 6 bgcolor = black></td>
<td width = 50 rowspan = 3 id = "Battery">
<table border = 3 cellspacing = 3 cellpadding = 0 bordercolor = white bordercolordark = white bordercolorlight = white height = 30 bgcolor = "#000000">
<tr>
<td bgcolor = white height = 100% width = 8></td>
<td bgcolor = white height = 100% width = 8></td>
<td bgcolor = white height = 100% width = 8></td>
</tr>
</table>
</td>
</tr>
<tr>
<td width = 4 height = 18 bgcolor = white></td>
</tr>
<tr>
<td width = 4 height = 6 bgcolor = black></td>
</tr>
</table>
</td>
</tr>
</table>
</span>
<span ID = "TelephoneSelect" style = "position:absolute; visibility:hidden;z-index:8;">
</span>
<span ID = "Manual" style = "position:absolute; visibility:hidden;z-index:9;">
<table border = 2 bordercolor = steelblue bordercolordark = steelblue bordercolorlight = steelblue width = 100% height = 280 cellspacing=0 cellpadding=3 bgcolor = "#225555">
<tr>
<td>
<table border = 1 width = "100%" height = 270 bgcolor = "#225555" cellspacing=0 cellpadding=1>
<tr>
<td width = 50% valign = top>
<font style = "font-size:10pt" color = hotpink>
<b>・ゲームのルール</b><font style = "font-size:8pt">(ミリオネアモード時)</font><br>
</font>
<font style = "font-size:8pt;">
<br>
　フジテレビ系列で放送中の「クイズ＄ミリオネア」風の「４択クイズ」です。賞金額にあわせて問題が難しくなっていきます。<br>
<br>
　問題に対しての答えがわかったら、その答えの上でマウスの左をクリックします。<br>
<br>
　すると、「ファイナルアンサー？」と聞いてくるので、その解答で良い場合は、ファイナルアンサー部分を、他の解答を選ぶ場合は他の解答の上で左をクリックしてください。<br>
<br>
　正解ならば、次の問題へ、不正解でゲームオーバーです。全問クリアでミリオネア（億万長者）達成（＝クリア）です！
</font>
</td>
<td width = 50% valign = top>
<font style = "font-size:10pt" color = orange>
<b>・モードの説明</b><br><br>
</font>
<font style = "font-size:8pt">
<font color = "#ffffff" style = "font-size:9pt"><b>■ミリオネアモード（ＥＡＳＹ）</b></font><br>
　６問制です。まずはこれで腕試し！<br>
<br>
<font color = "#ffffff" style = "font-size:9pt"><b>■ミリオネアモード（ＮＯＲＭＡＬ）</b></font><br>
　番組と一緒の１５問制です。ライフラインが６種類使えます。<br>
<br>
<font color = "#ffffff" style = "font-size:9pt"><b>■ミリオネアモード（ＨＡＲＤ）</b></font><br>
　番組と一緒の１５問制です。ライフラインが３つしか使えない本物と同じモード！<br>
<br>
<font color = "#ffffff" style = "font-size:9pt"><b>■とことんモード</b></font><br>
　問題の難易度お構いなしに、問題全てをクイズとして出題します。ライフラインが５種類使えるようになってます。<br>
</font>
</td>
</tr>
<tr>
<td colspan = 2 height = 40>
<table border = 0 cellspacing = 0 cellpadding = 0 width = 100%>
<tr>
<td><font style = "font-size:10pt" color = greenyellow>
<b>・作者／メイン協力者紹介（敬称略／下線入りはＨＰあり）</b><br>
</font>
<font style = "font-size:8pt">
作者：<a href = "http://www16.pos.to/~haradeng/makedata/" target = "_blank">でん(このソフト、関連アイテムはこのホームページで公開中)</a><br>
協力：<a href = "http://www.taisetu.com/" target = "_blank">しまゆう</a>、<a href = "http://www.vividmate.com/saru/" target = "_blank">彩華</a>、<a href = "http://nna.c-get.ne.jp/" target = "_blank">ＮＮＡ</a>、<a href = "http://www.artholic.com/" target = "_blank">YOKA</a>、ぬ〜、みみ、<a href = "http://www4.plala.or.jp/myboom/" target = "_Blank">ねこ</a>、ササ、<a href = "http://www18.u-page.so-net.ne.jp/xb4/melanie/" target = "_blank">Melanie</a></td>
<td align = right valign = bottom><input type = "button" value = "次の頁" onclick = "ManualIN2();" style = "color:black;background:greenyellow;"><br><input type = "button" value = "閉じる" onclick = "ManualClose();" style = "color:black;background:greenyellow;"></td>
</tr>
</table>
</font>
</td>
</tr>
</table>
</td>
</tr>
</table>
</span>
<span ID = "Manual2" style = "position:absolute; visibility:hidden;z-index:9;">
<table border = 2 bordercolor = steelblue bordercolordark = steelblue bordercolorlight = steelblue width = 100% height = 280 cellspacing=0 cellpadding=3 bgcolor = "#225555">
<tr>
<td>
<table border = 1 width = "100%" height = 270 bgcolor = "#225555" cellspacing=0 cellpadding=1>
<tr>
<td width = 50% valign = top>
<font style = "font-size:10pt" color = hotpink>
<b>・ライフラインの説明</b>
</font>
<br>
<br>
<font style = "font-size:8pt;">
　ライフラインとは、回答者お助け機能です。画面上にある「ライフライン」クリックで使用出来ます。ただし、１ゲームで１回ずつしか使えません（併用は可）<br>
<br>
　また、ミリオネアモードのＨＡＲＤ，ＥＡＳＹでは６種類のライフラインのうち３つしか使えません。使用するライフラインはタイトル画面で自由に選ぶことが可能です。<br>
<br>
（なおとことんモードでは５つ、ＮＯＲＭＡＬモードでは６つ使用することが出来ます）
</font>
</td>
<td width = 50% valign = top>
<font style = "font-size:10pt" color = orange>
<b>・各種ライフラインの効果</b><br>
<br>
</font>
<font style = "font-size:8pt">
<font color = "#ffffff" style = "font-size:9pt"><b>■50:50(Fifty-Fifty)</b></font><br>
→選択肢を２つにします。<br>
<font color = "#ffffff" style = "font-size:9pt"><b>■Audience</b></font><br>
→１００人に解答を聞いてみます。<br>
<font color = "#ffffff" style = "font-size:9pt"><b>■Telephone</b></font><br>
→分からない問題を仲間に聞いてみます。<br>
<font color = "#ffffff" style = "font-size:9pt"><b>■Safe Guard</b></font><br>
→自信のない問題に保険をかけます。<br>
<font color = "#ffffff" style = "font-size:9pt"><b>■Chat</b></font><br>
→仲間が解答に関して助けてくれます。<br>
<font color = "#ffffff" style = "font-size:9pt"><b>■Extra Change</b></font><br>
→問題を違うものに変更します。<br>
</font>
</td>
</tr>
<tr>
<td colspan = 2 height = 40>
<table border = 0 cellspacing = 0 cellpadding = 0 width = 100%>
<tr>
<td><font style = "font-size:10pt" color = greenyellow>
<b>・作者／メイン協力者紹介（敬称略／下線入りはＨＰあり）</b><br>
</font>
<font style = "font-size:8pt">
作者：<a href = "http://www16.pos.to/~haradeng/makedata/" target = "_blank">でん(このソフト、関連アイテムはこのホームページで公開中)</a><br>
協力：<a href = "http://www.taisetu.com/" target = "_blank">しまゆう</a>、<a href = "http://www.vividmate.com/saru/" target = "_blank">彩華</a>、<a href = "http://nna.c-get.ne.jp/" target = "_blank">ＮＮＡ</a>、<a href = "http://www.artholic.com/" target = "_blank">YOKA</a>、ぬ〜、みみ、<a href = "http://www4.plala.or.jp/myboom/" target = "_Blank">ねこ</a>、ササ、<a href = "http://www18.u-page.so-net.ne.jp/xb4/melanie/" target = "_blank">Melanie</a></td>
<td align = right valign = bottom><input type = "button" value = "前の頁" onclick = "ManualIN();" style = "color:black;background:greenyellow;"><br><input type = "button" value = "閉じる" onclick = "ManualClose();" style = "color:black;background:greenyellow;"></td>

</tr>
</table>
</font>
</td>
</tr>
</table>
</td>
</tr>
</table>
</span>
<span ID = "SoundTest" style = "position:absolute; visibility:hidden;z-index:8;">
<!-- さぁてどうやって出すんでしょ？ -->
<table border = 2 bordercolor = steelblue bordercolordark = steelblue bordercolorlight = steelblue width = 100% height = 280 cellspacing=0 cellpadding=0 bgcolor = "#225555">
<tr>
<td align = center>
<font face = "ＭＳ ゴシック" style = "font-size:13pt;" color = greenyellow><b>−−　サウンドテストコーナー　−−<br>
（注）(N)…NNA作曲　(H)…Haradeng作曲を意味する</b></font>
</td>
</tr>
<tr>
<td align = center>
<font face = "ＭＳ ゴシック" style = "font-size:13pt;" color = hotpink><b>−−　サウンド系　−−</b></font>
</td>
</tr>
<tr>
<td align = left>
<font face = "ＭＳ ゴシック" style = "font-size:10pt;"><b>
　　<a onClick = "JukeBox(SOUND_TITLE,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">タイトル＆ジングルカット(N)</a></span>　<a onClick = "JukeBox(SOUND_MAIN,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">メイン１−５(N)</a></span><br>
　　<a onClick = "JukeBox(SOUND_MAIN6_9,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">メイン６−９(H)</a></span>　　　　　　　<a onClick = "JukeBox(SOUND_MAIN10_15,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">メイン１０−１４(H)</a></span><br>
　　<a onClick = "JukeBox(SOUND_TRIAL,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">ファイナル問題(N)</a></span>　　　　　　<a onClick = "JukeBox(SOUND_STAFFROLL,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">スタッフロール(H)</a></span>
</b></font>
</td>
</tr>
<tr>
<td align = center>
<font face = "ＭＳ ゴシック" style = "font-size:13pt;" color = orange><b>−−　エフェクト系　−−</b></font>
</td>
</tr>
<tr>
<td align = left>
<font face = "ＭＳ ゴシック" style = "font-size:10pt;"><b>
　　<a onClick = "Sound[0] = Sound[4]; JukeBox(SOUND_SEIKAI,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">正解１(H)</a></span>　　　　　　　　　　<a onClick = "Sound[0] = Sound[8]; JukeBox(SOUND_SEIKAI,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">正解２(H)</a></span><br>
　　<a onClick = "Sound[0] = Sound[7]; JukeBox(SOUND_SEIKAI,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">正解３(H)</a></span>　　　　　　　　　　<a onClick = "Sound[0] = Sound[6]; JukeBox(SOUND_SEIKAI,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">正解４(H)</a></span><br>
　　<a onClick = "Sound[0] = Sound[5]; JukeBox(SOUND_NG,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">ミス１(H)</a></span>　　　　　　　　　　<a onClick = "Sound[0] = Sound[9]; JukeBox(SOUND_NG,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">ミス２(H)</a></span><br>
　　<a onClick = "JukeBox(SOUND_FINALANSWER,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">ファイナルアンサー(H)</a></span>　　　　<a onClick = "JukeBox(SOUND_AUDIENCE,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">オーディエンス(H)</a></span><br>
　　<a onClick = "JukeBox(SOUND_TELEPHONE,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">テレフォン(H)</a></span><br>
　　<a onClick = "JukeBox(SOUND_LIFELINE,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'skyblue'">その他ライフライン使用時(N)</a></span>　　　　　　　　　　　　<a onClick = "JukeBox(SOUND_MUTE_BGM,''); DispOnOff('SoundTest',OFF,'');"><span onMouseOver="this.style.color = 'white'" onMouseOut="this.style.color = 'orange'" style = "color:orange">■終了■</a></span>

</b></font>
</td>
</tr>
</table>
</span>
<!-- -[レイヤーのワークエリア↓]------------------------------------------- -->
<span ID = "LifeLine" style = "position:relative; visibility:hidden;z-index:3;"></span>
<span ID = "Audience1" style = "position:absolute; visibility:hidden;z-index:4;"></span>
<span ID = "Audience2" style = "position:absolute; visibility:hidden;z-index:5;"></span>
<span ID = "GameOver" style = "position:absolute; visibility:hidden;z-index:6;"></span>
<span ID = "ActionArea" style = "position:absolute; visibility:hidden;z-index:7;"></span>
<span ID = "EndingWork1" style = "position:absolute; visibility:hidden;z-index:6;"></span>
<span ID = "EndingWork2" style = "position:absolute; visibility:hidden;z-index:6;"></span>
<span ID = "EndingWork3" style = "position:absolute; visibility:hidden;z-index:6;"></span>
<span ID = "EndingWork4" style = "position:absolute; visibility:hidden;z-index:6;"></span>
<span ID = "EndingWork5" style = "position:absolute; visibility:hidden;z-index:6;"></span>
<span ID = "EndingWork6" style = "position:absolute; visibility:hidden;z-index:6;"></span>
<span ID = "EndingWork7" style = "position:absolute; visibility:hidden;z-index:6;"></span>
<span ID = "EndingWork8" style = "position:absolute; visibility:hidden;z-index:6;"></span>
<!-- -[レイヤーのワークエリア↑]------------------------------------------- -->
<span ID = "Check1" style = "position:relative; visibility:visible;z-index:1;">
<font size = 2 color = red>
初期データ読込中... 完了<br>
プログラムデータ読込中...
</span>
<script language = "JavaScript">
<!--
//環境で変更部分

//サウンド／グラフィック関連のパス情報
var gPath = './dat/';

//キャラクター名の変更（全角で５文字までに注意！(半角使用不可)）
//----------------------|←リミットライン。「;」がここ超えるとエラーです。
var gName = '　蓑もんた';

//とことんモードは使用する／しないの選択(ON = 使用する/OFF = 使用しない)
var gTokotonFlag = ON;

//ボーナスＵＲＬ（ミリオネア（ＥＡＳＹモード）達成時／絶対、相対パス可能）
var gBonusURLMillionaireEasy = "http://www16.tok2.com/home/tenma/cgi-bin/millionaire/image-syouzyou01.gif";

//ボーナスＵＲＬ（ミリオネア（ＮＯＲＭＡＬモード）達成時／絶対、相対パス可能）
var gBonusURLMillionaireNormal = "http://www16.tok2.com/home/tenma/cgi-bin/millionaire/image-syouzyou02.gif";

//ボーナスＵＲＬ（ミリオネア（ＨＡＲＤモード）達成時／絶対、相対パス可能）
var gBonusURLMillionaireHard = "http://www16.tok2.com/home/tenma/cgi-bin/millionaire/image-syouzyou03.gif";

//ボーナスＵＲＬ記述（とことんモードクリア時／絶対、相対パス可能）
var gBonusURLTokoton = "http://www16.tok2.com/home/tenma/cgi-bin/millionaire/image-syouzyou04.gif";

//右クリックを禁止させる（ソース見て上のＵＲＬを覗かれてしまうのを簡易対策）
//ON = 閲覧可/OFF = 閲覧不可
var MouseRightClick = OFF;

//間違えた時に「正解選択肢」をフラッシュで教える(ON = 教える/OFF = 教えない)
//問題数が少ないときは、OFFの方がいいかも…
var gAnswerFlashFlag = ON;

//５０：５０の消える選択肢を固定化する(ON = 固定化/OFF = ランダム)
//ONの時は「ハズレとなる選択肢」の２、３番が無条件消えます。
//ただし、他のライフライン併用時はこの設定は無効となります。
//純粋に５０：５０だけを使ったときのみ、となります。
var gFiftyFiftyErase = ON;

//賞金の設定部分（ミリオネアモード向け設定）
//作者注：あくまでゲームの雰囲気を出すためなので、賞金を請求しないように（笑）
var Money      = new Array();
var gMoneyData = new Array(4);
var gLevelMode = EASY;

Money[0]  = '\\10,000,000';
Money[1]  = '\\7,500,000';
Money[2]  = '\\5,000,000';
Money[3]  = '\\2,500,000';
Money[4]  = '\\1,500,000';
Money[5]  = '\\1,000,000';
Money[6]  = '\\750,000';
Money[7]  = '\\500,000';
Money[8]  = '\\250,000';
Money[9]  = '\\150,000';
Money[10] = '\\100,000';
Money[11] = '\\50,000';
Money[12] = '\\30,000';
Money[13] = '\\20,000';
Money[14] = '\\10,000';
Money[15] = '\\0';

//■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
//■■■この設定エリアはプログラムがわかる人以外いじらないほうが無難です■■■
//■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
//■■■　　　　　　　　　　　↓↓↓ここから↓↓↓　　　　　　　　　　　■■■
//■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■

//賞金の使用番号設定　Moneyで使用するデータの番号。[NORMAL][HARD]でモード別の
//賞金番号。数字の頭から１問目で不正解、１問目、２問目、３問目…という仕組み
//（問題数を変える事はプログラムの修正もあるので、分からない人はいじらない方
//　がいいです。チョット厄介になりました。)
gMoneyData[EASY]   = new Array(0,2,5,7,10,14,15);
gMoneyData[NORMAL] = new Array(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15);
gMoneyData[HARD]   = new Array(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15);
gMoneyData[EXTRA]  = new Array(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15);

//ライフライン「チャット」の応答率を変える。また、100%からの指標で
//gChatOK  = 正解を教えるパーセント
//gChatMID = ３択になるパーセント
//です。このパーセント抽選に漏れた場合は教えないようになってます。
var gChatOK  = new Array(100,95 ,30,15, 4, 2);
var gChatMID = new Array(100,100,95,75,40,15);

//オーディエンス反応率を変更。[0]はlevel1、[1]はlevel2…問題ということ。
//数字は左から答えを教える,３択になる、２択になる、教えないという確率。
//合計で１００ぴったりにしないとエラーが出るケースがある

var gATable = new Array();//←はいじらないように

gATable[0] = new Array(99,0 ,1 ,0);
gATable[1] = new Array(85,10,4 ,1);
gATable[2] = new Array(60,5 ,30,5);
gATable[3] = new Array(10,20,40,30);
gATable[4] = new Array(4 ,30,6 ,60);
gATable[5] = new Array(0 ,5 ,3 ,92);

//テレフォンの微妙度合いを変更　いじってもあまり意味が無いんだけど一応〜
//左から正解ケース、ハズレケース、ランダムケース。
//電池切れで終わるかラストまで行くかの確率はプログラム埋め込みなんで
//分かる人だけ頑張って治してね〜

//電池切れの確率テーブル
var gBattalyTable = new Array(100,98,70,60,55,50);

//回答者別正答率
var gHumanTelephone = new Array();//←はいじらないように

//信頼度最高（解答者名前、レベルでの解答パーセント（左から問題Lv1,2,3,4,5,6)）
gHumanTelephone[0] = new Array("お茶の水博士",100,100,98,90,50,20);

//信頼度高
gHumanTelephone[1] = new Array("古泉首相",100,100,90,60,20,5);

//信頼度低
gHumanTelephone[2] = new Array("島津田先生",99,90,40,25,10,2);

//信頼度最低
gHumanTelephone[3] = new Array("金剛君",98,80,30,10,3,0);

//■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
//■■■　　　　　　　　　　　↑↑↑ここから↑↑↑　　　　　　　　　　　■■■
//■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
//■■■この設定エリアはプログラムがわかる人以外いじらないほうが無難です■■■
//■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■

//グローバル変数エリア（いじらないで）---------------------------------ここから

//それにしても、このグローバルエリアの数、もう限界だーね。
//ぐっちょんぐっちょんのぐっちゃぐちゃ。
//これ以上やるなら、根本的に１から作り直さないとな状態…
//特にタイマースレッドでのエンバグ酷いし…
//（ココまで拡張予定してなかったから、ロジック不備になりはじめてる。）

var timerID="",timerID2="",timerID3="",timerID4="",timerID5="",timerID6="";
var SelectTimerID = new Array("","","","");
var TimerCount,TimerCount2,TimerCount3,TimerCountL;
var gAnswer;
var gNo = "";
var gSelect = new Array(4);
var gFifty = new Array(2);
var gLevel;
var gWindow_x;
var gReverseFlag = OFF;
var gGameOverFlag;
var gAllModeData = new Array();
var gMessageWork;
var gAnswerHidden;
var gLifeLineFifty;
var gLifeLineChat;
var gLifeLineSafeGuard;
var gLifeLineTelephone;
var gLifeLineExtraChange;
var gMojiColor = new Array();
var gBackChoice = new Array();
var gBackChoice2 = new Array();
var gEffectNo = 1;
var gAudienceUseGame = OFF;
var gLevelData = new Array(3);
var gFinalAnswerFlag;
var gVolume;
var gAppend = 0;
var gFinal3Mode = OFF;
var gTokotonBGMFlag = 0;

//データベース的設定---------------------------------------------------ここから
var GraData = new Array(
"back_left.gif",
"back_right.gif",
"back_title.gif",
"aud_gra.gif",
"aud_back.gif",
"lifeline.gif",
"fiftyfifty.gif",
"fiftyfifty_used.gif",
"extrachange.gif",
"extrachange_used.gif",
"chat.gif",
"chat_used.gif",
"safeguard.gif",
"safeguard_used.gif",
"audience.gif",
"audience_used.gif",
"telephone.gif",
"telephone_used.gif");

//プログラマのヒトリゴト…　Ｃ言語のenum機能が欲しいよ…
//ディスプレイの再描画時のルート番号
var MAIN        = 1;
var FINALANSWER = 2;
var FIFTYFIFTY  = 3;
var EXTRACHANGE = 4;
var CHAT        = 5;
var CHAT_3TAKU  = 6;
var CHAT_ANSWER = 7;
var CHAT_NG     = 8;
var SAFEGUARD   = 9;
var SAFEGUARD_R = 10;
var TRIAL       = 11;
var AUDIENCE    = 12;
var TELEPHONE   = 13;

//サウンドファイルの番号
var SOUND_MUTE_BGM    = 0;
var SOUND_MUTE_EFFECT = 1;
var SOUND_MAIN        = 2;
var SOUND_FINALANSWER = 3;
var SOUND_LIFELINE    = 4;
var SOUND_TITLE       = 5;
var SOUND_SEIKAI      = 6;
var SOUND_NG          = 7;
var SOUND_TRIAL       = 8;
var SOUND_AUDIENCE    = 9;
var SOUND_TELEPHONE   = 10;
var SOUND_CHAT        = 11;
var SOUND_STAFFROLL   = 12;
var SOUND_MAIN10_15   = 13;
var SOUND_MAIN6_9     = 14;

//ライフラインＮＯ
var LL_FIFTYFIFTY = 1;
var LL_EXTRACHANGE = 2;
var LL_CHAT = 3;
var LL_SAFEGUARD = 4;
var LL_AUDIENCE = 5;
var LL_TELEPHONE = 6;
var LL_OTHER = 999;

//サウンド読込時間を視覚的に軽減する心理的裏技（時間は変わってない(^-^;）
//こいつの性？でＭＡＣＩＥが１００％ハングするみたい…
var Sound = new Array();

//サウンド関連一覧
Sound[0]  = '';
Sound[1]  = gPath + 'main.wav';
Sound[2]  = gPath + 'lifeline.wav';
Sound[3]  = gPath + 'finalanswer.wav';
Sound[4]  = gPath + 'seikai1.wav';
Sound[5]  = gPath + 'ng1.wav';
Sound[6]  = gPath + 'seikai2.wav';
Sound[7]  = gPath + 'seikai3.wav';
Sound[8]  = gPath + 'seikai4.wav';
Sound[9]  = gPath + 'ng2.wav';
Sound[10] = gPath + 'title.wav';
Sound[11] = gPath + 'trial.wav';
Sound[12] = gPath + 'ending.wav';
Sound[13] = gPath + 'audience.wav';
Sound[14] = gPath + 'telephone.wav';
Sound[15] = gPath + 'main6-9.wav';
Sound[16] = gPath + 'staffroll.wav';
Sound[17] = gPath + 'main10-15.wav';

if(document.all){
	var i;
	for(i=0;i<Sound.length;i++){
		document.write('<bgsound src="' + Sound[i] + '" loop=0 volume=-10000>');
	}
}

var MinoOK      = new Array();
var MinoNG      = new Array();
var MinoOKVoice = new Array();
var MinoNGVoice = new Array();

//この辺のメッセージをいじる場合、「文字の限界」と「音声ファイルの番号管理」
//にかなり注意してください。プログラムの仕組みがわからない人はいじらない
//ほうが無難です。なお、メッセージの空白は必ず「全角空白」で空けてください！

MinoOK[0] = '正解！　　　　　'; MinoOKVoice[0] = Sound[4];
MinoOK[1] = '素晴らしい！　　'; MinoOKVoice[1] = Sound[8];
MinoOK[2] = 'お見事っ！　　　'; MinoOKVoice[2] = Sound[7];
MinoOK[3] = 'おめでとう！　　'; MinoOKVoice[3] = Sound[6];
MinoOK[4] = MinoOK[0];          MinoOKVoice[4] = Sound[4];
MinoOK[5] = MinoOK[0];          MinoOKVoice[5] = Sound[4];
MinoOK[6] = MinoOK[0];          MinoOKVoice[6] = Sound[4];
MinoOK[7] = MinoOK[0];          MinoOKVoice[7] = Sound[4];
MinoOK[8] = MinoOK[2];          MinoOKVoice[8] = Sound[7];
MinoOK[9] = MinoOK[3];          MinoOKVoice[9] = Sound[6];

MinoNG[0] = '残念！　　　　　'; MinoNGVoice[0] = Sound[5];
MinoNG[1] = 'ざ・ん・ね・ん！'; MinoNGVoice[1] = Sound[5];
MinoNG[2] = 'ちがいました…　'; MinoNGVoice[2] = Sound[9];
MinoNG[3] = MinoNG[0];          MinoNGVoice[3] = Sound[5];
MinoNG[4] = MinoNG[0];          MinoNGVoice[4] = Sound[5];
MinoNG[5] = MinoNG[0];          MinoNGVoice[5] = Sound[5];
MinoNG[6] = MinoNG[0];          MinoNGVoice[6] = Sound[5];
MinoNG[7] = MinoNG[1];          MinoNGVoice[7] = Sound[5];
MinoNG[8] = MinoNG[1];          MinoNGVoice[8] = Sound[5];
MinoNG[9] = MinoNG[2];          MinoNGVoice[9] = Sound[9];

gLevelData[EASY]   = new Array(1,2,3,4,5,6);
gLevelData[NORMAL] = new Array(1,1,2,2,2,3,3,3,4,4,5,5,6,6,6);
gLevelData[HARD]   = new Array(1,1,2,2,3,3,4,4,4,5,5,5,6,6,6);
gLevelData[EXTRA]  = new Array(3,3,3,4,4,4,4,5,5,5,5,6,6,6,6);

//下記の行のＵＲＬ部分の削除改変を禁じる（タイトル変更等は許可）
var gTitle = '<a href = "http://www16.pos.to/~haradeng/makedata/" target = "_Blank" style = "text-decoration:none;">−延岡　クイズ＄ノベマニア−</a>';

function SetBlock()
{
	var iRet;
	var i;

	if(!document.all) return;

	for(i=1;i<5;i++){
		DispOnOff("Check" + i,OFF,"");
		HtmlChange("Check" + i,"　","");
	}

	DispOnOff("PassedTime",OFF,"parent.submain.");
	DispOnOff("SetTime",OFF,"parent.submain.");

	//データの矛盾・不整合チェック
	iRet = DataCheck();

	if(iRet == false){
		return;
	}

	if(MouseRightClick == OFF){
		if(document.layers){
			document.captureEvents(Event.MOUSEDOWN);
		}
		document.onmousedown=RightClick;
		document.oncontextmenu=Ret;
	}

	document.Form.Path.value = gPath;
	document.Form.ManualFlag.value = "ON";
	document.Form.CustomOnOff.value = "OFF";
	document.Form.SoundOnOff.value = "ON";

	gName += '＞';

	window.scroll(0,0);

	for(i=0;i<gMoneyData[gLevelMode].lenght;i++){
		gBackChoice[i] = QuizData.length + 1;
	}

	EffectNo = 1;

	OpeningSelect();
}

function OpeningSelect()
{
	var str = "";

	if(gAppend != 0){
		gAppend |= 0x02;
	}

	document.Form.SoundOnOff.value = "OFF";
	JukeBox(999);

	str += '<table border = 0 width = 100%>';
	str += '<tr><td colspan = 2 height = 20>' + gTitle + ' Ver 1.11f (2002/07/13) Made by Haradeng</td></tr>';
	str += '<tr><td colspan = 2 align = center height = 50><span id = "Opening1"></span></td></tr>';
	str += '<tr><td colspan = 2 align = center height = 50><span id = "Opening2"></span></td></tr>';
	str += '<tr><td colspan = 2 align = center height = 50><span id = "Opening3"></span></td></tr>';
	str += '<tr><td colspan = 2 align = center height = 50><span id = "Opening4"></span></td></tr>';
	str += '<tr><td colspan = 2 height = 15></td></tr>';
	str += '<tr><td width = 50%><a onClick = "SoundSelect(\'ON\');"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'orange\'" style = "color:orange;font-size:13pt;font-family:ＭＳ ゴシック;"><b>サウンドＯＮでチャレンジ</a></b></span></td>';
	str += '<td width = 50%><a onClick = "SoundSelect(\'OFF\');"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'orange\'" style = "color:orange;font-size:13pt;font-family:ＭＳ ゴシック;"><b>サウンドＯＦＦでチャレンジ</a></b></span></td>';
	str += '</tr></table>';

	HtmlChange("Millionaire",str,"");

	str = '<b>あなたにもっともっと延岡を知ってほしい・・・</b>';

	str = 'HtmlChange("Opening1","' + str + '","");'
	SelectTimerID[0] = setTimeout(str,TimerAdjust(2000));

	str = '<b><font color = greenyellow style = \'font-size:18pt;\'>延岡　クイズ＄ノベマニアへようこそ！</font></b>';

	str = 'HtmlChange("Opening2","' + str + '","");'
	SelectTimerID[1] = setTimeout(str,TimerAdjust(5000));

	str = '<b>わたくし、司会の<font color = red>「'+ (gName.substring(0,gName.length-1)).replace(/　/g,"") +'」</font>です。</b>';
	str = 'HtmlChange("Opening3","' + str + '","");'
	SelectTimerID[2] = setTimeout(str,TimerAdjust(8000));

	str = '<b><font color = lightpink style = \'font-size:14pt;\'>このゲームは音を使用していますので、<br>最初に選択して頂く必要があります。</font></b>';
	str = 'HtmlChange("Opening4","' + str + '","");'
	SelectTimerID[3] = setTimeout(str,TimerAdjust(11000));
}

function SoundSelect(strSound)
{
	TimerClear();
	document.Form.SoundOnOff.value = strSound;
	ModeSelect();
}

function ModeSelect()
{
	var str = "";

	document.Form.LifeLineNo.value = "156";
	document.Form.LifeLineNoBackup.value = "156";

	str += '<table border = 0 bgcolor = "#000000" width = "100%" cellspacing = 0 cellpadding = 0>';
	str += '<tr><td height = 30 align = center><font color = skyblue style = "font-size:14pt;"><b>' + gTitle + '</b></font></td>';
	str += '</tr><tr>';
	str += '<td align = right height = 18 valign = "top"><font color = violet style = "font-size:11pt;"><b>' + gQuizTitle + '</b></font></td>';
	str += '</tr><tr>';
	str += '<td align = center valign = center height = 50 nowrap><font color = red style = "font-size:14pt;"><b>■遊ぶモードをクリックで選んでください。■</b></font></td>';
	str += '</tr><tr>';
	str += '<td nowrap><a onClick = "ModeMillionaire(EASY);"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'orange\'" style = "color:orange;font-size:13pt;font-family:ＭＳ ゴシック;"><b>　Ａ：ミリオネアＥＡＳＹモード　　（６問制）</a></b></span></td>';
	str += '</tr><tr>';
	str += '<td nowrap><a onClick = "ModeMillionaire(NORMAL);"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'greenyellow\'" style = "color:greenyellow;font-size:13pt;font-family:ＭＳ ゴシック;"><b>　Ｂ：ミリオネアＮＯＲＭＡＬモード（１５問制）</a></b></span></td>';
	str += '</tr><tr>';
	str += '<td nowrap><a onClick = "ModeMillionaire(HARD);"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'yellow\'" style = "color:yellow;font-size:13pt;font-family:ＭＳ ゴシック;"><b>　Ｃ：ミリオネアＨＡＲＤモード　　（１５問制）</a></b></span></td>';
	str += '</tr><tr>';
	if(gTokotonFlag == ON){
		str += '<td nowrap><a onClick = "ModeAllQuiz();"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'lightpink\'" style = "color:lightpink;font-size:13pt;font-family:ＭＳ ゴシック;"><b>　Ｄ：とことんモード　　　　　　　（全問モード）</a></b></span></td>';
		str += '</tr><tr>';
		str += '<td nowrap><a onClick = "SelectLifeLine();"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'#aaaaff\'" style = "color:#aaaaff;font-size:13pt;font-family:ＭＳ ゴシック;"><b>　Ｅ：使用するライフラインを変更</a></b></td>';
		str += '</tr><tr>';
		str += '<td nowrap><a onClick = "ManualMain();"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'skyblue\'" style = "color:skyblue;font-size:13pt;font-family:ＭＳ ゴシック;"><b>　Ｆ：ゲーム説明書を表示する</a></b></td>';
		str += '</tr><tr>';
		str += '<td nowrap><a onClick = "OpeningSelect();"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'#cccccc\'" style = "color:#cccccc;font-size:13pt;font-family:ＭＳ ゴシック;"><b>　Ｇ：サウンドセレクト画面へ戻る</a></b></td>';
	}else{
		str += '<td nowrap><a onClick = "SelectLifeLine();"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'#aaaaff\'" style = "color:#aaaaff;font-size:13pt;font-family:ＭＳ ゴシック;"><b>　Ｄ：使用するライフラインを変更する</a></b></td>';
		str += '</tr><tr>';
		str += '<td nowrap><a onClick = "ManualMain();"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'skyblue\'" style = "color:skyblue;font-size:13pt;font-family:ＭＳ ゴシック;"><b>　Ｅ：ゲーム説明書を表示する</a></b></td>';
		str += '</tr><tr>';
		str += '<td nowrap><a onClick = "OpeningSelect();"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'#cccccc\'" style = "color:#cccccc;font-size:13pt;font-family:ＭＳ ゴシック;"><b>　Ｆ：サウンドセレクト画面へ戻る</a></b></td>';
	}
	str += '</tr><tr>';
	if(gTokotonFlag == OFF){
		str += '<td nowrap height = 15></td>';
		str += '</tr><tr>';
	}
	str += gCopyright;
	str += '</tr></table>';

	HtmlChange("Millionaire",str,"");

	JukeBox(SOUND_TITLE,"");
}

function SelectCource(strCource)
{
	if(ModeChk() == "Tokoton"){
		TokotonMain(strCource);
	}
	if(ModeChk() == "Millionaire"){
		MilioneaireMain(strCource);
	}
}
function SelectMode(strCource)
{
	var i;

	TimerClear();

	for(i=1;i<8;i++){
		DispOnOff("EndingWork" + i.toString(),OFF,"");
	}
	Locate("Millionaire",0,0,"");

	if(ModeChk() == "Tokoton"){
		ModeAllQuiz();
	}
	if(ModeChk() == "Millionaire"){
		if(strCource == "ENDING"){
			switch(gLevelMode){
				case EASY:
					ModeMillionaire(NORMAL);
					break;
				case NORMAL:
					ModeMillionaire(HARD);
					break;
				case HARD:
				case EXTRA:
					ModeMillionaire(EXTRA);
					break;
			}
		}else{
			ModeMillionaire('');
		}
	}
}

function ModeAllQuiz()
{
	var i,cnt;
	var iNum = new Array();
	var iLen = QuizData.length;

	cnt = 0;

	DispOnOff("Himitu",OFF,"parent.submain.");
	DispOnOff("SelectLL",OFF,"parent.submain.");

	for(i=0;i<iLen;i++){
		iNum[i] = i;
	}

	while(1){
		gAllModeData[cnt] = Rand(iLen);
		if(gAllModeData[cnt] == iNum[gAllModeData[cnt]]){
			iNum[gAllModeData[cnt]] = iLen + 1;
			cnt++;
			if(cnt == iLen){
				break;
			}
		}
	}

	gGameOverFlag = OFF;
	gLifeLineFifty = OFF;
	gLifeLineChat = OFF;
	gLifeLineTelephone = OFF;
	gAudienceUseGame = OFF;

	with(document.Form){
		Mode.value = "Tokoton";
		FiftyFifty.value = "OFF";
		ExtraChange.value = "ON";
		SafeGuard.value = "OFF";
		Audience.value = "OFF";
		Telephone.value = "OFF";
		Chat.value = "OFF";
		LifeLineUsePointFlag.value = "OFF";
		EndingFlag.value = "OFF";
		Flag.value = "OFF";
	}

	gLevel = 0;

	DispOnOff("GameOver",OFF,"");
	DispOnOff("ActionArea",OFF,"");
	DispOnOff("HelpAction",ON,"parent.submain.");

	gTokotonBGMFlag = 0;
	JukeBox(SOUND_MAIN,"");
	TokotonMain(MAIN);
}

function TokotonMain(strCource)
{
	var i,j;
	var iCnt;
	var Flag;
	var Random;

	gAnswerHidden = 9;

	//エンディング後の対策
	if(timerID != ""){
		clearTimeout(timerID);
	}

	gLifeLineFifty = OFF;
	gLifeLineChat = OFF;
	gLifeLineSafeGuard = OFF;
	gAudienceUseGame = OFF;
	TimerCount = 0;

	Random = gAllModeData[gLevel];
	
	//選択肢シャッフル
	gSelect[0] = QuizData[Random][Rand(4)+1];
	iCnt = 1;

	while(iCnt < 4){
		gSelect[iCnt] = QuizData[Random][Rand(4)+1];
		Flag = OFF;
		for(i=0;i<iCnt;i++){
			if(gSelect[i]==gSelect[iCnt]){
				Flag = ON;
				break;
			}
		}
		if(Flag == OFF){
			iCnt++;
		}
	}

	//シャッフルされた中の答えを拾う
	for(i=0;i<4;i++){
		if(gSelect[i]==QuizData[Random][1]){
			gAnswer = i;
			break;
		}
	}

	//ＩＥを騙すトリック＆文字オーバー時カット処理
	for(i=0;i<4;i++){
		gSelect[i] = gSelect[i].substring(0,12);
		for(j=gSelect[i].length;j<12;j++){
			gSelect[i] += "&nbsp;&nbsp;";
		}
	}

	gNo = Random;

	document.Form.LifeLineUsePointFlag.value = "ON";
	document.Form.GameOverFlag.value = "OFF";
	gFinalAnswerFlag = ON;

	gFifty[0] = 9;
	gFifty[1] = 9;

	TimerClear();

	ScoreMakeTokoton();

	if(gLevel == QuizData.length - 1){
		document.Form.LifeLineUsePointFlag.value = "OFF";
		document.Form.ManualFlag.value = "OFF";
		Locate("ActionArea",0,56,"");
		DisplayMake(TRIAL,9);
		JukeBox(SOUND_TITLE,"");
		clearTimeout(timerID);
		TimerCount = 0;
		FinalTrial();
		return;
	}else{
		if(gLevel == Math.floor(QuizData.length / 3) * 2 && gTokotonBGMFlag == 1){
			gVolume = 0;
			timerID3 = setInterval("JukeBoxFadeOut(1)",TimerAdjust(100));
			gTokotonBGMFlag = 2;
		}
		if(gLevel == Math.floor(QuizData.length / 3) && gTokotonBGMFlag == 0){
			gVolume = 0;
			timerID3 = setInterval("JukeBoxFadeOut(2)",TimerAdjust(100));
			gTokotonBGMFlag = 1;
		}
	}

	DisplayMake(strCource,9);
}

function ScoreMakeTokoton()
{
	var str;

	str  = '<table border = 0 height = 240 width = 100%><tr>';
	str += '<td height = 50 align = center valign = top nowrap><font color = greenyellow style = "font-size:13.5pt;"><b>★とことん★<br>★モード★</b></font></td></tr>';
	str += '<tr><td valign = center align = center nowrap>';
	if(gLevel != QuizData.length){
		str += '<hr><b>' + QuizData.length + '問中</b><br><font color = orange><b>' + (gLevel + 1) + '問目</b></font>挑戦中<hr>';
	}else{
		str += '<hr><b>' + QuizData.length + '問</b><br><font color = orange><b>PERFECT!!!</b></font><hr>';
	}
	str += '</td></tr></table>';
	HtmlChange("Score",str,"parent.submain.");
}

function ModeMillionaire(iLevel)
{
	if(gFinal3Mode == ON){
		gLevel = gMoneyData[gLevelMode].length - 3; 
	}else{
		gLevel = 1; 
	}

	gGameOverFlag = OFF;
	gLifeLineFifty = OFF;
	gLifeLineSafeGuard = OFF;
	gLifeLineTelephone = OFF;

	if(iLevel != ''){
		document.Form.ModeLevel.value = iLevel;
		gLevelMode = iLevel;
	}

	with(document.Form){
		Mode.value = "Millionaire";
		LifeLineUsePointFlag.value = "OFF";
		EndingFlag.value = "OFF";
		Flag.value = "OFF";
		if(gLevelMode != EXTRA){
			FiftyFifty.value = "OFF";
			ExtraChange.value = "OFF";
			Audience.value = "OFF";
			Telephone.value = "OFF";
			Chat.value = "OFF";
			SafeGuard.value = "OFF";
		}else{
			FiftyFifty.value = "OFF";
			ExtraChange.value = "ON";
			Audience.value = "ON";
			Telephone.value = "ON";
			Chat.value = "ON";
			SafeGuard.value = "ON";
		}
	}

	DispOnOff("GameOver",OFF,"");
	DispOnOff("ActionArea",OFF,"");
	DispOnOff("HelpAction",ON,"parent.submain.");
	DispOnOff("Himitu",OFF,"parent.submain.");

	if((document.Form.LifeLineNo.value).length != 3){
		document.Form.LifeLineNo.value = document.Form.LifeLineNoBackup.value;
	}

	for(i=0;i<gLevelData[gLevelMode].length;i++){
		gBackChoice2[i] = 0;
	}

	gLifeLineExtraChange = QuizData.length + 1;

	if(gFinal3Mode == ON){
		JukeBox(SOUND_MAIN10_15,"");
	}else{
		JukeBox(SOUND_MAIN,"");
	}
	MilioneaireMain(MAIN);
}

function MilioneaireMain(strCource)
{
	var i,j;
	var iCnt;
	var Flag;
	var Random;
	var today = new Date();

	gAnswerHidden = 9;
	DispOnOff("SelectLL",OFF,"parent.submain.");

	//エンディング後の対策
	if(timerID != ""){
		clearTimeout(timerID);
	}

	gLifeLineFifty = OFF;
	TimerCount = 0;

	//ＪＳは乱数の偏りが変に激しいので、時間（秒）×乱数でかき回してから
	//使用乱数を取得する方が問題がバラける…と思う(^-^;
	iCnt = Rand(today.getSeconds()) + 2;

	for(i=0;i<iCnt;i++){
		Random = Rand(QuizData.length);
	}

	//難易度１でやられたときに限り可能性がある
	//リプレイ後の問題が同じだった場合、変える処理
	if(gNo != "" && gLevel == 1){
		while(1){
			if(gNo != Random && parseInt(QuizData[Random][6],10) == 1){
				for(i=0;i<gLevelData[gLevelMode].length;i++){
					if(gBackChoice2[i] == Random){
						i = (gLevelData[gLevelMode].length) + 1;
						break;
					}
				}
				if(i != (gLevelData[gLevelMode].length) + 1){
					break;
				}
			}
			Random = Rand(QuizData.length);
		}
	}else{
		//ライフライン「ExtraChange」使用時の問題選択
		if(strCource == EXTRACHANGE){
			while(1){
				if(gNo != Random && parseInt(QuizData[Random][6],10) == gLevelData[gLevelMode][gLevel - 1] && gBackChoice[gLevel] != Random){
					for(i=0;i<gLevelData[gLevelMode].length;i++){
						if(gBackChoice2[i] == Random){
							i = (gLevelData[gLevelMode].length) + 1;
							break;
						}
					}
					if(i != (gLevelData[gLevelMode].length) + 1){
						break;
					}
				}
				Random = Rand(QuizData.length);
			}
			gLifeLineExtraChange = Random;
		}else{
			while(1){
				if(parseInt(QuizData[Random][6],10) == gLevelData[gLevelMode][gLevel - 1] && gBackChoice[gLevel] != Random){
					for(i=0;i<gLevelData[gLevelMode].length;i++){
						if(gBackChoice2[i] == Random || gLifeLineExtraChange == Random){
							i = (gLevelData[gLevelMode].length) + 1;
							break;
						}
					}
					if(i != (gLevelData[gLevelMode].length) + 1){
						break;
					}
				}
				Random = Rand(QuizData.length);
			}
		}
	}
	
	//選択肢シャッフル
	gSelect[0] = QuizData[Random][Rand(4)+1];
	iCnt = 1;

	while(iCnt < 4){
		gSelect[iCnt] = QuizData[Random][Rand(4)+1];
		Flag = OFF;
		for(i=0;i<iCnt;i++){
			if(gSelect[i]==gSelect[iCnt]){
				Flag = ON;
				break;
			}
		}
		if(Flag == OFF){
			iCnt++;
		}
	}

	//シャッフルされた中の答えを拾う
	for(i=0;i<4;i++){
		if(gSelect[i]==QuizData[Random][1]){
			gAnswer = i;
			break;
		}
	}

	//ＩＥを騙すトリック＆文字オーバー時カット処理
	for(i=0;i<4;i++){
		gSelect[i] = gSelect[i].substring(0,12);
		for(j=gSelect[i].length;j<12;j++){
			gSelect[i] += "&nbsp;&nbsp;";
		}
	}

	gNo = Random;

	document.Form.LifeLineUsePointFlag.value = "ON";
	document.Form.GameOverFlag.value = "OFF";
	gFinalAnswerFlag = ON;

	//おまじないロジックに使用（詳細はナイショ）
	gBackChoice[gLevel] = gNo;
	
	if(strCource != EXTRACHANGE){
		gBackChoice2[gLevel] = gNo;
	}
	
	gFifty[0] = 9;
	gFifty[1] = 9;

	TimerClear();
	ScoreMake();

	if(gLevel == gMoneyData[gLevelMode].length - 1 && strCource != EXTRACHANGE){
		document.Form.LifeLineUsePointFlag.value = "OFF";
		document.Form.ManualFlag.value = "OFF";
		Locate("ActionArea",0,56,"");
		DisplayMake(TRIAL,9);
		JukeBox(SOUND_TITLE,"");
		clearTimeout(timerID);
		TimerCount = 0;
		FinalTrial();
		return;
	}else{
		if(gLevel == 10 && strCource != EXTRACHANGE){
			gVolume = 0;
			timerID3 = setInterval("JukeBoxFadeOut(1)",TimerAdjust(100));
		}
		if(gLevel == 6 && strCource != EXTRACHANGE){
			gVolume = 0;
			timerID3 = setInterval("JukeBoxFadeOut(2)",TimerAdjust(100));
		}
	}

	DisplayMake(strCource,9);
}

function DataCheck()
{
	var i,j,k;
	var str = "";
	var Level = new Array(gMoneyData[EASY].length);
	
	//問題内容のチェック
	for(i=0;i<Level.length;i++){
		Level[i] = 0;
	}
	for(i=0;i<QuizData.length;i++){
		Level[parseInt(QuizData[i][6],10)]++;
	}
	for(i=1;i<Level.length;i++){
		if(Level[i] < 4){
			str += '<font color = skyblue style = "font-size:13.5pt;"><b>' + gTitle + '<br><br><font color = red>データエラー：クイズは１つのレベルに対し最低４問以上作ってください。</b></font><br>';
			for(i=1;i<Level.length;i++){
				str += "レベル[" + i + "]問題数 = " + Level[i] + "<br>\n";
			}
			break;
		}
	}

	//解答文字の重複チェック
	for(i=0;i<QuizData.length;i++){
		for(j=1;j<4;j++){
			for(k=j+1;k<5;k++){
				if(QuizData[i][j] == QuizData[i][k]){
					str += '<font color = skyblue style = "font-size:13.5pt;"><b>' + gTitle + '<br><br><font color = red>データエラー：問題番号[' + i + ']番の選択肢に重複したものが存在してます。訂正してください。</b></font>';
					i = QuizData.length + 1;
					j = 99;
					k = 99;
					break;
				}
			}
		}
	}

	if(gName.length >= 6 || gName.length <= 2){
		str += '<font color = skyblue style = "font-size:13.5pt;"><b>' + gTitle + '<br><br><font color = red>設定エラー：司会者の名前が正しくありません。２文字以上５文字以内で設定してください。</b></font><br>';
	}

	//データ構成が正しいかチェック
	for(i=0;i<QuizData.length;i++){
		k=parseInt(QuizData[i][6],10);
		if(k <= 0 || k >= gMoneyData[gLevelMode].length){
			str += '<font color = skyblue style = "font-size:13.5pt;"><b>' + gTitle + '<br><br><font color = red>データエラー：問題番号[' + i + ']番のレベルの設定が許容範囲を超えています。</b></font><br>';
		}
	}

	if(str != ""){
		HtmlChange("Millionaire",str,"");
		return(false);
	}
	return(true);
}

function DisplayMake(iCource,iClick)
{
	var Question1 = QuizData[gNo][0].substring(0,23);
	var Question2 = QuizData[gNo][0].substring(23,46);
	var strWork;
	var str = "";
	var Moji = new Array("　 Ａ：","　Ｂ：","　 Ｃ：","　Ｄ：");
	var Graphics = new Array(gPath + GraData[0],gPath + GraData[1]);
	var i;

	if(iCource == TRIAL){
		str += '<table border = 0 bgcolor = "#000000" cellspacing = 0>';
		str += '<tr><td colspan = 2 height = 40 align = center><font color = skyblue style = "font-size:13.5pt;"><b>' + gTitle + '</b></font><br><div align = right><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'#aaaaff\'" style = "color:#aaaaff;font-size:9pt;font-family:ＭＳ ゴシック;"><b>＜ライフライン＞</b></span>　<span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'#aaaaff\'" style = "color:#aaaaff;font-size:9pt;font-family:ＭＳ ゴシック;"><b>＜ゲーム説明書＞</b></span></div></td>';
		str += '</tr><tr>';
		str += '<td colspan = 2 width = 500 height = 65 background = "' + gPath +GraData[2] + '"></td>';
		str += '</tr><tr>';
		str += '<td colspan = 2 height = 3></td>';
		str += '</tr><tr>';

		for(i=0;i<4;i++){
			str += '<td width = 50% height = 33 background = "' + Graphics[i % 2] + '"></td>';
			if(i%2 == 1){
				str += '</tr><tr>';
				str += '<td colspan = 2 height = 3></td>';
				str += '</tr><tr>';
			}
		}
	}else{
		if(iCource == FIFTYFIFTY){
			gFifty[0] = gAnswer;
			//ＦＩＦＴＹＦＩＦＴＹとＣＨＡＴでぶつかる問題を回避
			if(gFiftyFiftyErase == ON && gAnswerHidden == 9){
				for(i=0;i<4;i++){
					if(gSelect[i].substring(0,(QuizData[gNo][2]).length)==QuizData[gNo][2]){
						gFifty[1] = i;
						break;
					}
				}
			}else{
				while(1){
					gFifty[1] = Rand(4);
					if(gFifty[0] != gFifty[1] && gFifty[1] != gAnswerHidden){
						break;
					}
				}
			}
		}

		str += '<table border = 0 bgcolor = "#000000" cellspacing = 0>';
		str += '<tr><td colspan = 2 height = 40 align = center><font color = skyblue style = "font-size:13.5pt;"><b>' + gTitle + '</b></font><br><div align = right><a onClick = "LifeLineMain();"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'#aaaaff\'" style = "color:#aaaaff;font-size:9pt;font-family:ＭＳ ゴシック;"><b>＜ライフライン＞</b></span></a>　<a onClick = "ManualMain();"><span onMouseOver="this.style.color = \'white\'" onMouseOut="this.style.color = \'#aaaaff\'" style = "color:#aaaaff;font-size:9pt;font-family:ＭＳ ゴシック;"><b>＜ゲーム説明書＞</b></span></a></div></td>';
		str += '</tr><tr>';

		str += '<td colspan = 2 width = 500 height = 65 background = "' + gPath +GraData[2] + '"><font color = "#ffffff" style = "font-size:13.5pt;"><b>　 ' + Question1 + '<br><font style = "line-height:18px;">　 ' + Question2 + '</b></font></font></td>';

		str += '</tr><tr>';
		str += '<td colspan = 2 height = 3></td>';
		str += '</tr><tr>';

		if((iCource != FIFTYFIFTY && gLifeLineFifty != ON)){
			for(i=0;i<4;i++){
				strWork = '<span id = "Select' + (i + 1) + '" style = "position:abosolute;visibility:hidden;">';
				if(iClick == i){
					str += '<td width = 50% height = 33 background = "' + Graphics[i % 2] + '" bgcolor = orange>' + strWork + '<font color ="#000000" style = "font-size:11pt;"><font color = "#ffffff">' + Moji[i] + '</font>' + gSelect[i] + '</font></span></td>';
				}else{
					if(gAnswerHidden != i){
						str += '<td width = 50% height = 33 background = "' + Graphics[i % 2] + '">' + strWork + '<font color ="#ffffff" style = "font-size:11pt;"><a onClick = "FinalAnswer(' + i + ');"><font color = lightpink>' + Moji[i] + '</font>' + gSelect[i] + '</font></a></span></td>';
					}else{
						str += '<td width = 50% height = 33 background = "' + Graphics[i % 2] + '">' + strWork + '</span></td>';
					}
				}
				if(i%2 == 1){
					str += '</tr><tr>';
					str += '<td colspan = 2 height = 3></td>';
					str += '</tr><tr>';
				}
			}
		}else{
			for(i=0;i<4;i++){
				strWork = '<span id = "Select' + (i + 1) + '" style = "position:abosolute;visibility:hidden;">';
				if(gFifty[0] == i || gFifty[1] == i){
					if(iClick == i){
						str += '<td width = 50% height = 33 background = "' + Graphics[i % 2]+ '" bgcolor = orange>' + strWork + '<font color ="#000000" style = "font-size:11pt;"><font color = "#ffffff">' + Moji[i] + '</font>' + gSelect[i] + '</font></span></td>';
					}else{
						str += '<td width = 50% height = 33 background = "' + Graphics[i % 2]+ '">' + strWork + '<font color ="#ffffff" style = "font-size:11pt;"><a onClick = "FinalAnswer(' + i + ');"><font color = lightpink>' + Moji[i] + '</font>' + gSelect[i] + '</font></a></span></td>';
					}
				}else{
					str += '<td width = 50% height = 33 background = "' + Graphics[i % 2] + '">' + strWork + '</span></td>';
				}
				if(i%2 == 1){
					str += '</tr><tr>';
					str += '<td colspan = 2 height = 3></td>';
					str += '</tr><tr>';
				}
			}
		}
	}

	switch(iCource){
		case FINALANSWER:
			strWork = '<span id = "WaitAction"><a onClick = "AnswerCheck(' + iClick + ');"><font color = gray>' + gName + '</font>ファイナルアンサー？</a></span>'
			break;
		case MAIN:
		case TRIAL:
			strWork = '<font color = gray>' + gName + '</font>';
			break;
		case FIFTYFIFTY:
			strWork = '<font color = gray>' + gName + '</font>コンピューターが答えを２つに絞ります';
			break;
		case EXTRACHANGE:
			strWork = '<font color = gray>' + gName + '</font>コンピューターが違う問題を選びました';
			break;
		case CHAT:
			strWork = '<font color = gray>' + gName + '</font>５行以内で答えを教えてあげて下さい！';
			break;
		case CHAT_3TAKU:
			strWork = '<font color = gray>' + gName + '</font>おや、<font color = skyblue>' + gMessageWork + '</font>の可能性が消えましたね〜';
			break;
		case CHAT_ANSWER:
			strWork = '<font color = gray>' + gName + '</font>お友達は<font color = skyblue>' + gMessageWork + '</font>が答えと言ってますね〜';
			break;
		case CHAT_NG:
			strWork = '<font color = gray>' + gName + '</font>あら〜　文字制限になっちゃいました…';
			break;
		case SAFEGUARD:
			strWork = '<font color = gray>' + gName + '</font>この問題に保険を掛けました！';
			break;
		case SAFEGUARD_R:
			strWork = '<font color = gray>' + gName + '</font>保険を掛けといてよかったですねぇ〜';
			break;
		case AUDIENCE:
		case TELEPHONE:
			strWork = '<font color = gray>' + gName + '</font>' +gMessageWork;
			break;
	}

	str += '<td colspan = 2 height = 26 nowrap><font color = hotpink style = "font-size:13.5pt;"><b>' + strWork + '</b></font></td>';
	str += '</tr><tr>';
	str += gCopyright2 + '</tr></table>';
	
	HtmlChange("Millionaire",str,"");
	
	switch(iCource){
		case MAIN:
		case EXTRACHANGE:
			strWork = 'DispOnOff("Select1",' + ON + ',"");';
			SelectTimerID[0] = setTimeout(strWork,TimerAdjust(2500));
			strWork = 'DispOnOff("Select2",' + ON + ',"");';
			SelectTimerID[1] = setTimeout(strWork,TimerAdjust(4000));
			strWork = 'DispOnOff("Select3",' + ON + ',"");';
			SelectTimerID[2] = setTimeout(strWork,TimerAdjust(5500));
			strWork = 'DispOnOff("Select4",' + ON + ',"");';
			SelectTimerID[3] = setTimeout(strWork,TimerAdjust(7700));
			break;
		case FINALANSWER:
		case FIFTYFIFTY:
		case CHAT:
		case CHAT_3TAKU:
		case CHAT_ANSWER:
		case CHAT_NG:
		case SAFEGUARD:
		case SAFEGUARD_R:
		case AUDIENCE:
		case TELEPHONE:
			DispOnOff("Select1",ON,"");
			DispOnOff("Select2",ON,"");
			DispOnOff("Select3",ON,"");
			DispOnOff("Select4",ON,"");
			break;
	}
}

function ScoreMake()
{
	var i;
	var str = "";
	var PT;
	var work;

	if(gLevelMode == EASY){
		PT = "12pt";
		str += '<table border = 0 width = 100% cellpadding = 2 cellspacing = 0><tr>';
		str += '<td colspan = 2 align = center height = 26><table border = 0 cellspacing = 0 cellpadding = 0 width = 100%><tr><td><font color = greenyellow face = "ＭＳ Pゴシック" style = "font-size:14pt;"><b>-賞金-</b></font></td><td valign = bottom><font color = skyblue face = "ＭＳ Pゴシック" style = "font-size:8pt;">EASY MODE</font></td></td></tr></table>';
	}else{
		PT = "8pt";
		str += '<table border = 0 width = 100% cellpadding = 0 cellspacing = 0><tr>';
		switch(gLevelMode){
			case NORMAL:
				work = '<font color = orange face = "ＭＳ Pゴシック" style = "font-size:8pt;">NORMAL MODE';
				break;
			case HARD:
				work = '<font color = red face = "ＭＳ Pゴシック" style = "font-size:8pt;">HARD MODE';
				break;
			case EXTRA:
				work = '<font color = skyblue face = "ＭＳ Pゴシック" style = "font-size:8pt;">EXTRA MODE';
				break;
		}
		str += '<td colspan = 2 align = center height = 26><table border = 0 cellspacing = 0 cellpadding = 0 width = 100%><tr><td><font color = greenyellow face = "ＭＳ Pゴシック" style = "font-size:13pt;"><b>-賞金-</b></font></td><td valign = bottom>' + work + '</font></td></td></tr></table>';
	}

	str += '</tr><tr nowrap>';

	for(i=0;i<gMoneyData[gLevelMode].length - 1;i++){
		if(gLevel == (gMoneyData[gLevelMode].length - i - 1)){
			str += ' <td bgcolor = "#ff7700" width = 32 align = right nowrap><font color = "#000000" face = "ＭＳ Pゴシック" style = "font-size:' + PT + ';">' + (gMoneyData[gLevelMode].length - i - 1) + '<font color = "#ffffff">●</font></font></td>';
			str += ' <td bgcolor = "#ff7700" align = right nowrap><font color = "#000000" face = "ＭＳ Pゴシック" style = "font-size:' + PT + ';">' + Money[gMoneyData[gLevelMode][i]] + '</font></td>';
		}else{
			if(i % 5 == 0){
				str += ' <td align = right width = 32 nowrap><font color = "#ffffff" face = "ＭＳ Pゴシック" style = "font-size:' + PT + ';">' + (gMoneyData[gLevelMode].length - i - 1);
				if(gLevel <= (gMoneyData[gLevelMode].length - i - 1)){
					str += '<font color = "#000000">◆</font></font></td>';
				}else{
					str += '<font color = "#ffffff">◆</font></font></td>';
				}
				str += ' <td align = right nowrap><font color = "#ffffff" face = "ＭＳ Pゴシック" style = "font-size:' + PT + ';">' + Money[gMoneyData[gLevelMode][i]] + '</font></td>';
			}else{
				str += ' <td align = right width = 32 nowrap><font color = orange face = "ＭＳ Pゴシック" style = "font-size:' + PT + ';">' + (gMoneyData[gLevelMode].length - i - 1);
				if(gLevel <= (gMoneyData[gLevelMode].length - i - 1)){
					str += '<font color = "#000000">◆</font></font></td>';
				}else{
					str += '<font color = orange>◆</font></font></td>';
				}
				str += ' <td align = right nowrap><font color = orange face = "ＭＳ Pゴシック" style = "font-size:' + PT + ';">' + Money[gMoneyData[gLevelMode][i]] + '</font></td>';
			}
		}
		str += '</tr><tr>';
	}

	str += '<td colspan = 2 align = center><font color = "#ffffff" face = "ＭＳ Pゴシック" style = "font-size:' + PT + ';"><b>-Next Trial-</b></a></font></td>';
	str += '</tr><tr>';
	
	if(gLevel == gMoneyData[gLevelMode].length){
		str += '<td colspan = 2 align = center><font color = orange face = "ＭＳ Pゴシック" style = "font-size:' + PT + ';"><b>Congratulation</b></font></td>';
	}else{
		if(gGameOverFlag == ON){
			str += '<td colspan = 2 align = center><font color = orange face = "ＭＳ Pゴシック" style = "font-size:' + PT + ';"><b>--------</b></font></td>';
		}else{
			str += '<td colspan = 2 align = right><font color = orange face = "ＭＳ Pゴシック" style = "font-size:' + PT + ';"><b>' + Money[gMoneyData[gLevelMode][(gMoneyData[gLevelMode].length - gLevel - 1)]] + '</b></font></td>';
		}
	}
	str += '</tr><tr>';
	str += '<td colspan = 2 align = center nowrap><font color = "#ffffff" face = "ＭＳ Pゴシック" style = "font-size:9pt;"><b>-Total Prize Money-</b></font></td>';
	str += '</tr><tr>';
	str += '<td colspan = 2 align = right><font color = orange face = "ＭＳ Pゴシック" style = "font-size:' + PT + ';"><b>' + Money[gMoneyData[gLevelMode][(gMoneyData[gLevelMode].length - gLevel)]] + '</b></font></td>';
	str += '</tr></table>';

	HtmlChange("Score",str,"parent.submain.");
}

function FinalAnswer(iAns)
{
	if(gLifeLineChat == ON || gLifeLineTelephone == ON || gFinalAnswerFlag == OFF){
		return;
	}

	DispOnOff("LifeLine",OFF,"");

	document.Form.Flag.value = 'OFF';

	LifeLineOUTMain();

	if(gFinalAnswerFlag == ON){
		DisplayMake(FINALANSWER,iAns);
		JukeBox(SOUND_FINALANSWER,"");
	}
}

function AnswerCheck(iAns)
{
	var Random = Rand(50) + gLevelData[gLevelMode][gLevel] * 60 + 100;

	TimerCount3 = 0;
	gFinalAnswerFlag = OFF;

	DispOnOff("LifeLine",OFF,"");

	document.Form.Flag.value = 'OFF';
	document.Form.LifeLineUsePointFlag.value = "OFF";

	if(ModeChk() == "Millionaire"){
		// 一番最後の時だけだけ煽り入れるために強制的に蓑煽りを700ミリ秒に。
		if(gLevel == gMoneyData[gLevelMode].length - 1){
			Random = 700;
		}
	}else{
		//とことんモードの煽りは難しいレベルの問題ほど長い仕組み
		if(gLevel == QuizData.length - 1){
			Random = 1000;
		}else{
			Random = Rand(50) + parseInt(QuizData[gNo][6],10) * 60 + 100;
		}
	}

	if(gAudienceUseGame == ON){
		gAudienceUseGame = OFF;
		TimerCount2 = 0;
		setTimeout("AudienceLastMove()",1);
	}

	_Wait(Random,iAns);
}

function _Wait(WaitTime,iAns)
{
	var str = '<font color = orange style = "font-size:13.5pt;"><b>';
	var i;

	if(TimerCount3 == 15){
		clearTimeout(timerID4);
		AnswerAction(iAns);
		return;
	}
	
	str += '<font color = gray>' + gName + '</font>';
	
	for(i=TimerCount3;i<10;i++){
		str += "．";
	}
	
	str += "</b></font>";
	
	HtmlChange("WaitAction",str,"");
	
	TimerCount3++;
	
	str = '_Wait(' + WaitTime + ',' + iAns + ')';
	
	timerID4 = setTimeout(str,TimerAdjust(WaitTime));
}

function AnswerAction(iAns)
{
	var str = '<font color = red style = "font-size:13.5pt;"><b>';
	var Random;

	if(gAnswer == iAns){
		Random = Rand(MinoOK.length);
		Sound[0] = MinoOKVoice[Random];
		gLevel++;
		if(ModeChk() == "Millionaire"){
			if(gLevel != gMoneyData[gLevelMode].length){
				str += '<a onClick = "SelectCource(MAIN);"><font color = gray>' + gName + '</font>' + MinoOK[Random];
				str += '</b><font color = greenyellow style = "font-size:8pt;">(next challange ' + Money[gMoneyData[gLevelMode][(gMoneyData[gLevelMode].length - gLevel - 1)]] + '-)</font></b></font></a>';
				JukeBox(SOUND_SEIKAI,"");
			}else{
				str += '<a onClick = "SelectMode(\'ENDING\');"><font color = gray>' + gName + '</font>やりました！！！';
				str += '</b></b></font></a>';
			}
		}
		if(ModeChk() == "Tokoton"){
			if(gLevel != QuizData.length){
				str += '<a onClick = "SelectCource(MAIN);"><font color = gray>' + gName + '</font>' + MinoOK[Random];
				str += '</b><font color = greenyellow style = "font-size:8pt;">(next challange ' + (gLevel+1) + '問目)</font></b></font></a>';
				JukeBox(SOUND_SEIKAI,"");
			}else{
				str += '<a onClick = "SelectMode(\'\');"><font color = gray>' + gName + '</font>あなたはスゴイ！！';
				str += '</b></b></font></a>';
			}
		}
		//得点画面の書きなおし
		if(ModeChk() == "Tokoton"){
			ScoreMakeTokoton();
		}
		if(ModeChk() == "Millionaire"){
			ScoreMake();
		}
	}else{
		if(gLifeLineSafeGuard == OFF){
			document.Form.GameOverFlag.value = "ON";

			Random = Rand(MinoNG.length);
			Sound[0] = MinoNGVoice[Random];

			str += '<a onClick = "SelectMode(\'\');"><font color = gray>' + gName + '</font><font color = skyblue>' + MinoNG[Random] + '</font>';
			str += '</b><font color = greenyellow style = "font-size:8pt;"></font></b></font></a>';
			gGameOverFlag = ON;
			//得点画面の書きなおし
			if(ModeChk() == "Tokoton"){
				ScoreMakeTokoton();
			}
			if(ModeChk() == "Millionaire"){
				ScoreMake();
			}
			GameOver();
			JukeBox(SOUND_NG,"");
			gLevel = 1;
			gGameOverFlag = OFF;
			if(gAnswerFlashFlag == ON){
				strWork = 'AnswerFlash('+ON+');';
				SelectTimerID[0] = setTimeout(strWork,TimerAdjust(250));
				strWork = 'AnswerFlash('+OFF+');';
				SelectTimerID[1] = setTimeout(strWork,TimerAdjust(500));
				strWork = 'AnswerFlash('+ON+');';
				SelectTimerID[2] = setTimeout(strWork,TimerAdjust(750));
				strWork = 'AnswerFlash('+OFF+');';
				SelectTimerID[3] = setTimeout(strWork,TimerAdjust(1000));
				strWork = 'AnswerFlash('+ON+');';
				SelectTimerID[4] = setTimeout(strWork,TimerAdjust(1250));
				strWork = 'AnswerFlash('+OFF+');';
				SelectTimerID[5] = setTimeout(strWork,TimerAdjust(1500));
				strWork = 'AnswerFlash('+ON+');';
				SelectTimerID[6] = setTimeout(strWork,TimerAdjust(1750));
				strWork = 'AnswerFlash('+OFF+');';
				SelectTimerID[7] = setTimeout(strWork,TimerAdjust(2000));
			}
		}else{
			//ライフラインセーフガード時の処理
			gAnswerHidden = iAns;
			DisplayMake(SAFEGUARD_R,9);
			gLifeLineSafeGuard = OFF;
			gFinalAnswerFlag = ON;
			document.Form.Flag.value = 'OFF';
			document.Form.LifeLineUsePointFlag.value = 'ON';
			TimerCount = 0;
			return;
		}
	}

	HtmlChange("WaitAction",str,"");

	if(QuizData[gNo][5] != "" && gAnswer == iAns){
		if(gLevel != gMoneyData[gLevelMode].length){
			str = '<a onClick = "SelectCource(MAIN);">';
		}else{
			if(ModeChk() == "Millionaire"){
				str = '<a onClick = "SelectMode(\'ENDING\');">';
			}else{
				str = '<a onClick = "SelectCource(MAIN);">';
			}
		}
		str += '<center><font color = skyblue style = "font-size:11pt;"><b>−ＳＴＵＤＹ！−</b></font><br><font color = skyblue style = "font-size:9pt;">' + QuizData[gNo][5].substring(0,40) + '<br>' + QuizData[gNo][5].substring(40,80) + '</font></center></a>';
		HtmlChange("Study",str,"");
	}
	//エンディング開始
	if(ModeChk() == "Millionaire"){
		if(gLevel == gMoneyData[gLevelMode].length){
			Ending();
		}
	}
	//トコトンで全問クリア時
	if(ModeChk() == "Tokoton"){
		if(gLevel == QuizData.length){
			Ending();
		}
	}

	//無条件セーフガードのフラグをここでOFFにしないとどこでも使えてしまう(^-^;
	gLifeLineSafeGuard = OFF;

}
function AnswerFlash(Flag)
{
	var str = '<table border = 0 cellspacing = 0 cellpadding = 1><tr><td background = "';
	var Graphics = new Array(gPath + GraData[0],gPath + GraData[1]);
	var Moji = new Array("　 Ａ：","　Ｂ：","　 Ｃ：","　Ｄ：");

	str += Graphics[gAnswer % 2] + '" bgcolor = "#77aa77" width = 248 height = 33>';
	str += '<font color ="#000000" style = "font-size:11pt;"><font color = "#ffffff">' + Moji[gAnswer] + '</font>' + gSelect[gAnswer] + '</font>';
	
	str += '</td></tr></table>';

	HtmlChange("ActionArea",str,"");

	switch(gAnswer){
		case 0:
			Locate("ActionArea",3,111,"");
			break;
		case 1:
			Locate("ActionArea",253,111,"");
			break;
		case 2:
			Locate("ActionArea",3,147,"");
			break;
		case 3:
			Locate("ActionArea",253,147,"");
			break;
	}

	if(Flag == ON){
		DispOnOff("Select" + (gAnswer + 1).toString(),ON,"");
		DispOnOff("ActionArea",OFF,"");
	}
	if(Flag == OFF){
		DispOnOff("Select" + (gAnswer + 1).toString(),OFF,"");
		DispOnOff("ActionArea",ON,"");
	}
}
function LifeLineMain()
{
	var obj = parent.millionaire.document;

	var Flag = obj.Form.Flag.value;
	var UseFlag = obj.Form.LifeLineUsePointFlag.value;
	var ManualFlag = obj.Form.ManualFlag.value;

	if(UseFlag == 'OFF' || ManualFlag == 'OFF'){
		return;
	}

	TimerCountL = 1;
	
	if(Flag == 'OFF'){
		LifeLineMake();
	}
	
	with(obj){
		all("LifeLine").style.pixelLeft = body.clientWidth;
		all("LifeLine").style.pixelTop = -64;
		gWindow_x = body.clientWidth;
	}

	DispOnOff("LifeLine",ON,"parent.millionaire.");

	if(Flag == 'OFF'){
		LifeLineMoveIN();
		obj.Form.Flag.value = 'ON';
	}else{
		gWindow_x = 0;
		LifeLineMoveOUT();
		obj.Form.Flag.value = 'OFF';
	}
}

function LifeLineMoveIN()
{
	var obj = parent.millionaire.document;

	gWindow_x -= TimerCountL * 10;
	
	if(gWindow_x <= 0){
		gWindow_x = 0;
	}
	
	obj.all("LifeLine").style.pixelLeft = gWindow_x;

	if(gWindow_x == 0){
		clearTimeout(timerID5);
		return;
	}
	TimerCountL++;
	timerID5 = setTimeout("LifeLineMoveIN();",TimerAdjust(20));
}

function LifeLineOUTMain()
{
	TimerCountL = 1;
	
	gWindow_x = 0;
	LifeLineMoveOUT();

}

function LifeLineMoveOUT()
{
	gWindow_x -= TimerCountL * 10;
	
	if((document.body.clientWidth + gWindow_x) <= 0){
		gWindow_x = -1000;
	}

	document.all["LifeLine"].style.pixelLeft = gWindow_x;

	if(gWindow_x == -1000){
		clearTimeout(timerID5);
		document.all["LifeLine"].style.pixelLeft = document.body.clientWidth;
		document.all["LifeLine"].style.pixelTop = -64;
		gWindow_x = document.body.clientWidth;
		document.Form.Flag.value = 'OFF';
		HtmlChange("LifeLine","","");
		return;
	}
	TimerCountL++;
	timerID5 = setTimeout("LifeLineMoveOUT();",TimerAdjust(20));
}

function LifeLineMake()
{
	var obj = parent.millionaire.document.Form;
	var str = "";
	var strSpace = "";
	var Path = obj.Path.value;
	var LifeLineNo = obj.LifeLineNo.value;

	strSpace = '　　';

	str += '<table border = 0 bgcolor = "#797dcf" width = 100%><tr><td align = center>';
	str += '<table border = 0 bgcolor = "#797dcf">';
	if(ModeChk() == "Tokoton"){
		str += '<tr> <td align = center colspan = 6 nowrap>';
	}else{
		if(gLevelMode == NORMAL){
			LifeLineNo = '123456';
			strSpace = '';
			str += '<tr> <td align = center colspan = 7 nowrap>';
		}else{
			str += '<tr> <td align = center colspan = 6 nowrap>';
		}
	}
	
	str += '<span id = "Navi"><font color = orange style = "font-size:11pt;font-family:ＭＳ Pゴシック;"><b>《ＬＩＦＥ　ＬＩＮＥ》</b></font></span></td>';
	str += '</tr><tr>';

	if(ModeChk() != "Tokoton" && gLevelMode != NORMAL){
		str += '<td width = 60></td>';
	}
	

	if(LifeLineNo.indexOf(LL_FIFTYFIFTY.toString()) != -1 || ModeChk() == "Tokoton"){
		var Flag = obj.FiftyFifty.value;
		if(Flag == 'OFF'){
			str += '<td nowrap><a onClick = "FiftyFifty();" onMouseOver = "NaviMes(\'FiftyFifty：選択肢を２つにします\');" onMouseOut = "NaviMes(\'\');"><img src = "' + Path + GraData[6] + '"></a></td>';
		}else{
			str += '<td nowrap><a onMouseOver = "NaviMes(\'FiftyFifty：使用済みです\');" onMouseOut = "NaviMes(\'\');"><img src = "' + Path + GraData[7] + '"></a></td>';
		}
	}
	if(LifeLineNo.indexOf(LL_AUDIENCE.toString()) != -1 || ModeChk() == "Tokoton"){
		var Flag = obj.Audience.value;
		if(Flag == 'OFF'){
			str += '<td nowrap><a onClick = "AudienceFirst();" onMouseOver = "NaviMes(\'Audience：会場の皆さんに答えを聞いてみます\');" onMouseOut = "NaviMes(\'\');">' + strSpace + '<img src = "' + Path + GraData[14] + '"></a></td>';
		}else{
			str += '<td nowrap><a onMouseOver = "NaviMes(\'Audience：使用済みです\');" onMouseOut = "NaviMes(\'\');">' + strSpace + '<img src = "' + Path + GraData[15] +'"></a></td>';
		}
	}
	if(LifeLineNo.indexOf(LL_TELEPHONE.toString()) != -1 || ModeChk() == "Tokoton"){
		var Flag = obj.Telephone.value;
		if(Flag == 'OFF'){
			str += '<td nowrap><a onClick = "LifeLineTelephone();" onMouseOver = "NaviMes(\'Telephone：仲間に電話で答えを聞いてみます\');" onMouseOut = "NaviMes(\'\');">' + strSpace + '<img src = "' + Path + GraData[16] + '"></a></td>';
		}else{
			str += '<td nowrap><a onMouseOver = "NaviMes(\'Telephone：使用済みです\');" onMouseOut = "NaviMes(\'\');">' + strSpace + '<img src = "' + Path + GraData[17] +'"></a></td>';
		}
	}
	if(LifeLineNo.indexOf(LL_SAFEGUARD.toString()) != -1 || ModeChk() == "Tokoton"){
		var Flag = obj.SafeGuard.value;
		if(Flag == 'OFF'){
			str += '<td nowrap><a onClick = "SafeGuard();" onMouseOver = "NaviMes(\'SafeGuard：この解答をミスしても再解答出来ます\');" onMouseOut = "NaviMes(\'\');">' + strSpace + '<img src = "' + Path + GraData[12] + '"></a></td>';
		}else{
			str += '<td nowrap><a onMouseOver = "NaviMes(\'SafeGuard：使用済みです\');" onMouseOut = "NaviMes(\'\');">' + strSpace + '<img src = "' + Path + GraData[13] +'"></a></td>';
		}
	}
	if(LifeLineNo.indexOf(LL_CHAT.toString()) != -1 || ModeChk() == "Tokoton"){
		var Flag = obj.Chat.value;
		if(Flag == 'OFF'){
			str += '<td nowrap><a onClick = "LifeLineChat();" onMouseOver = "NaviMes(\'Chat：通信相手に答えを聞いてみます\');" onMouseOut = "NaviMes(\'\');">' + strSpace + '<img src = "' + Path + GraData[10] + '"></a></td>';
		}else{
			str += '<td nowrap><a onMouseOver = "NaviMes(\'Chat：使用済みです\');" onMouseOut = "NaviMes(\'\');">' + strSpace + '<img src = "' + Path + GraData[11] + '"></a></td>';
		}
	}
	if(LifeLineNo.indexOf(LL_EXTRACHANGE.toString()) != -1 && ModeChk() != "Tokoton"){
		var Flag = obj.ExtraChange.value;
		if(Flag == 'OFF'){
			str += '<td nowrap><a onClick = "ExtraChange();" onMouseOver = "NaviMes(\'ExtraChange：全く別の問題に取り替えます\');" onMouseOut = "NaviMes(\'\');">' + strSpace + '<img src = "' + Path + GraData[8] + '"></a></td>';
		}else{
			str += '<td nowrap><a onMouseOver = "NaviMes(\'ExtraChange：使用済みです\');" onMouseOut = "NaviMes(\'\');">' + strSpace + '<img src = "' + Path + GraData[9] +'"></a></td>';
		}
	}

	str += '<td nowrap><font color = skyblue style = "font-size:10pt;">　<a onClick = "LifeLineOUTMain();" onMouseOver = "NaviMes(\'キャンセル：ライフラインの使用を中止します。\');" onMouseOut = "NaviMes(\'\');">キャンセル</a></font>&nbsp;</td>';
	if(ModeChk() != "Tokoton"){
		str += '<td width = 60 nowrap>&nbsp;&nbsp;</td>';
	}
	str += '</tr></table>';
	str += '</td></tr></table>';

	HtmlChange("LifeLine",str,"parent.millionaire.")
}

function FiftyFifty()
{
	JukeBox(SOUND_LIFELINE,"");
	gLifeLineFifty = ON;
	document.Form.FiftyFifty.value = "ON";
	DisplayMake(FIFTYFIFTY,9);
	LifeLineOUTMain();
	if(gAudienceUseGame == ON){
		gAudienceUseGame = OFF;
		TimerCount2 = 0;
		setTimeout("AudienceLastMove()",1);
	}
}

function ExtraChange()
{
	JukeBox(SOUND_LIFELINE,"");

	TimerClear();

	DispOnOff("Select1",OFF,"");
	DispOnOff("Select2",OFF,"");
	DispOnOff("Select3",OFF,"");
	DispOnOff("Select4",OFF,"");
	HtmlChange("Select1","","");
	HtmlChange("Select2","","");
	HtmlChange("Select3","","");
	HtmlChange("Select4","","");

	document.Form.ExtraChange.value = "ON";
	SelectCource(EXTRACHANGE);
	LifeLineOUTMain();
	if(gAudienceUseGame == ON){
		gAudienceUseGame = OFF;
		TimerCount2 = 0;
		setTimeout("AudienceLastMove()",1);
	}
}

function NaviMes(str)
{
	if(str == ""){
		str = '<font color = orange style = "font-size:11pt;font-family:ＭＳ Pゴシック"><b>《ＬＩＦＥ　ＬＩＮＥ》</b></font>';
	}else{
		str = '<font color = greenyellow style = "font-size:11pt;font-family:ＭＳ Pゴシック"><b>' + str + '</b></font>';
	}
	HtmlChange("Navi",str,"");
}

function ManualClose()
{
	var GameOverFlag = parent.millionaire.document.Form.GameOverFlag.value;

	DispOnOff("Manual",OFF,"");
	DispOnOff("Manual2",OFF,"");

	if(GameOverFlag == 'ON'){
		DispOnOff("GameOver",ON,"");
	}

	document.Form.ManualFlag.value = "ON";
	document.Form.Flag.value = "OFF";
}

function GameOver()
{
	var str = "";

	document.all["GameOver"].style.pixelTop = 208;
	document.all["GameOver"].style.pixelLeft = 1;

	if(ModeChk() == "Millionaire"){
		str += '<a onClick = "SelectMode(\'\');"><table border = 0>';
		str += '<tr><td width = 498 height = 65 background = "' + gPath + GraData[2] + '" align = center bgcolor = orange><font color = "#ffffff" style = "font-size:13pt"><b>・Total Prize Money・</b></font><br>';
		str += '<font color = "#000000" style = "font-size:13pt"><b>' + Money[gMoneyData[gLevelMode][(gMoneyData[gLevelMode].length - gLevel)]] + '</b></font><br>';
		str += '<font color = blue style = "font-size:9pt">（再チャレンジ開始！（Here Click））</font>';
	}else{
		str += '<a onClick = "SelectMode(\'\');"><table border = 0>';
		str += '<tr><td width = 498 height = 65 background = "' + gPath + GraData[2] +'" align = center bgcolor = orange><font color = "#ffffff" style = "font-size:13pt"><b>・You Failed・</b></font><br>';
		str += '<font color = "#000000" style = "font-size:13pt"><b>Succeeded ' + gLevel + ' / ' + QuizData.length + '</b></font><br>';
		str += '<font color = blue style = "font-size:9pt">（再チャレンジ開始！（Here Click））</font>';
	}
	
	str += '</td></tr></table></a>';

	HtmlChange("GameOver",str,"");
	
	DispOnOff("GameOver",ON,"");
}

function Ending()
{
	document.all["ActionArea"].style.pixelTop = 144;
	document.all["ActionArea"].style.pixelLeft = 0;

	JukeBox(SOUND_TITLE,"");
	TimerCount = 1;
	gReverseFlag = OFF;
	DispOnOff("ActionArea",ON,"");
	EndingWidth();
	document.Form.EndingFlag.value = "ON";
}

function EndingWidth()
{
	var str = "";
	var Width,work;
	
	if(document.all){
		Width = document.body.clientWidth;
	}else{
		Width = innerWidth;
	}
	
	work = Width - ((TimerCount * 20) * 2);
	
	str += '<table border = 0><tr>';
	str += '<td bgcolor = "#ffffff" width = ' + TimerCount * 20 + ' height = 1></td>';
	str += '<td width = ' + work + ' height = 1></td>';
	str += '<td bgcolor = "#ffffff" width = ' + TimerCount * 20 + ' height = 1></td>';
	str += '</tr></table>';

	HtmlChange("ActionArea",str,"");

	if(TimerCount == 14){
		TimerCount = 0;
		EndingHeight();
		return;
	}

	TimerCount++;
	timerID = setTimeout("EndingWidth();",TimerAdjust(20));
}

function EndingHeight()
{
	var str = "";
	var Width,work;
	
	if(document.all){
		Width = document.body.clientWidth;
	}else{
		Width = innerWidth;
	}
	
	str += '<table border = 0 width = ' + Width + ' bgcolor = "#ffffff"><tr>';
	str += '<td height = ' + TimerCount * 4 + '></td>';
	str += '</tr></table>';

	document.all["ActionArea"].style.pixelTop = 146 - TimerCount * 2;

	HtmlChange("ActionArea",str,"");

	if(TimerCount == 17){
		clearTimeout(timerID);
		TimerCount = 0;
		EndingCongratulation();
		return;
	}

	TimerCount++;
	timerID = setTimeout("EndingHeight();",TimerAdjust(20));
}

function EndingCongratulation()
{
	var str = "";
	var Width,work = "";
	var _R,_G,_B;
	var Moji = "Congratulation!!";
	var i;

	if(TimerCount == 0){
		for(i=0;i<Moji.length;i++){
			gMojiColor[i] = 0;
		}
	}

	for(i=0;i<Moji.length;i++){
		if(i>TimerCount){
			work += '<font style = "font-size:28pt;">';
			for(j=i;j<Moji.length;j++){
				work += '&nbsp;';
			}
			work += '</font>';
			break;
		}
		_R = 255;
		_G = (256-(gMojiColor[i]*6))  >= 255 ? 255 : (256-(gMojiColor[i]*6));
		_B = (256-(gMojiColor[i]*16)) >= 255 ? 255 : (256-(gMojiColor[i]*16));
		
		_R = _R.toString(16);
		_G = _G.toString(16);
		_B = _B.toString(16);
		
		work += '<font color = "#' + _R + _G + _B + '" style = "font-size:28pt;">' + Moji.substring(i,i+1) + '</font>';
		
		if(gReverseFlag == OFF){
			gMojiColor[i]++;
			if(gMojiColor[i] > 16){
				gMojiColor[i] = 16;
			}
		}else{
			gMojiColor[i]--;
			if(gMojiColor[i] < 0){
				gMojiColor[i] = 0;
			}
		}
		if(gMojiColor[Moji.length - 1] == 16 && i == Moji.length - 1){
			if(gReverseFlag == ON){
				gReverseFlag = OFF;
			}else{
				gReverseFlag = ON;
			}
		}
	}
	
	if(document.all){
		Width = document.body.clientWidth;
	}else{
		Width = innerWidth;
	}
	
	str += '<a onClick = "SelectMode(\'ENDING\');"><table border = 0 width = ' + Width + ' bgcolor = "#ffffff"><tr>';
	str += '<td height = 68 align = center><i>' + work + '</i></td>';
	str += '</tr></table></a>';

	HtmlChange("ActionArea",str,"");

	if(gMojiColor[0] == 0 && gReverseFlag == ON){
		clearTimeout(timerID);
		TimerCount = 0;
		EndingMillionaire();
		return;
	}

	TimerCount++;
	timerID = setTimeout("EndingCongratulation();",TimerAdjust(45));
}

function EndingMillionaire()
{
	var str = "";
	var Width,work = "";
	var _R,_G,_B;
	var Moji = "You are Millionaire!!";
	var i;

	if(ModeChk() == "Tokoton"){
		Moji = "You are Quiz master!!";
	}

	if(TimerCount == 0){
		for(i=0;i<Moji.length;i++){
			gMojiColor[i] = 0;
		}
	}

	for(i=0;i<Moji.length;i++){
		if(i>TimerCount){
			work += '<font style = "font-size:28pt;">';
			for(j=i;j<Moji.length;j++){
				work += '&nbsp;';
			}
			work += '</font>';
			break;
		}
		_R = 255;
		_G = (256-(gMojiColor[i]*5))  >= 255 ? 255 : (256-(gMojiColor[i]*5));
		_B = (256-(gMojiColor[i]*2)) >= 255 ? 255 : (256-(gMojiColor[i]*2));
		
		_R = _R.toString(16);
		_G = _G.toString(16);
		_B = _B.toString(16);
		
		work += '<font color = "#' + _R + _G + _B + '" style = "font-size:28pt;">' + Moji.substring(i,i+1) + '</font>';
		
		gMojiColor[i]++;
		if(gMojiColor[i] > 16){
			gMojiColor[i] = 16;
		}
	}
	
	if(document.all){
		Width = document.body.clientWidth;
	}else{
		Width = innerWidth;
	}
	
	str += '<a onClick = "SelectMode(\'ENDING\');"><table border = 0 width = ' + Width + ' bgcolor = "#ffffff"><tr>';
		str += '<td height = 68 align = center valign = top><i>' + work + '</i><br><font color = "#ffffff" style = "font-size:9pt">(Click to play the game again!)</font></td>';
	str += '</tr></table></a>';

	HtmlChange("ActionArea",str,"");

	if(gMojiColor[Moji.length - 1] == 16 && TimerCount == 60){
		clearTimeout(timerID);
		TimerCount = 0;
		str = '<a onClick = "SelectMode(\'ENDING\');"><table border = 0 width = ' + Width + ' bgcolor = "#ffffff"><tr>';
		str += '<td height = 68 align = center valign = top><i>' + work + '</i><br><font color = darkblue style = "font-size:9pt">';

		if(gLevelMode == EASY && ModeChk() == "Millionaire"){
			str = '<a onClick = "SelectMode(\'ENDING\');"><table border = 0 width = ' + Width + ' bgcolor = "#ffffff"><tr>';
			str += '<td height = 58 align = center valign = top><i>' + work + '</i><br><font color = darkblue style = "font-size:9pt"><br><b>(Challange to the &quot;NORMAL MODE!&quot; Click to play the next stage!)</b></font></td>';
			str += '</tr></table></a>';
			str += '</font></td>';
			str += '</tr></table></a>';
			EndingEndMessage(str);
			return;
		}
		JukeBox(SOUND_STAFFROLL,"");
		EndingStaffRoll();
		return;
	}

	TimerCount++;
	timerID = setTimeout("EndingMillionaire();",TimerAdjust(50));
}

function EndingEndMessage(str)
{
	HtmlChange("ActionArea",str,"");
	clearTimeout(timerID);
	if(ModeChk() == "Millionaire"){
		switch(gLevelMode){
			case EASY:
				if(gBonusURLMillionaireEasy != ""){
					NewWindow(gBonusURLMillionaireEasy,"BonusWindow",800,600);
				}
				break;
			case NORMAL:
				if(gBonusURLMillionaireNormal != ""){
					NewWindow(gBonusURLMillionaireNormal,"BonusWindow",800,600);
				}
				break;
			case HARD:
			case EXTRA:
				if(gBonusURLMillionaireHard != ""){
					NewWindow(gBonusURLMillionaireHard,"BonusWindow",800,600);
				}
				break;
		}
	}
	if(ModeChk() == "Tokoton"){
		if(gBonusURLTokoton != ""){
			NewWindow(gBonusURLTokoton,"BonusWindow",800,600);
		}
	}
}

function ManualMain()
{
	var obj = parent.millionaire.document;
	var Flag = obj.Form.ManualFlag.value;
	var GameOverFlag = obj.Form.GameOverFlag.value;
	var EndingFlag = obj.Form.EndingFlag.value;
	
	if(EndingFlag == "ON"){
		ManualOUT();
		return;
	}

	Manual(Flag);

	if(gAppend != 0){
		gAppend |= 0x04;
	}

	if(gAppend == 7){
		gAppend = 65535;
		JukeBox(SOUND_LIFELINE,"");
		Extend();
	}

	if(Flag == 'ON'){
		if(GameOverFlag == 'ON'){
			DispOnOff("GameOver",OFF,"parent.millionaire.");
		}
		obj.Form.ManualFlag.value = "OFF";
	}else{
		if(GameOverFlag == 'ON'){
			DispOnOff("GameOver",ON,"parent.millionaire.");
		}
		obj.Form.ManualFlag.value = "ON";
	}
}

function Manual(Flag)
{
	if(Flag == 'ON'){
		ManualIN();
	}else{
		ManualOUT();
	}
}

function ManualIN()
{
	var obj = parent.millionaire.document;

	obj.all("Manual").style.top = 0;

	DispOnOff("LifeLine",OFF,"");
	HtmlChange("LifeLine","","");
	DispOnOff("Manual2",OFF,"");
	DispOnOff("Manual",ON,"");
}
function ManualOUT()
{
	var obj = parent.millionaire.document;

	obj.Form.Flag.value = 'OFF';
	obj.all("Manual").style.top = 0;

	DispOnOff("Manual",OFF,"");
	document.Form.ManualFlag.value = "ON";
}

function ManualIN2()
{
	var obj = parent.millionaire.document;

	obj.all("Manual2").style.top = 0;

	DispOnOff("LifeLine",OFF,"");
	DispOnOff("Manual",OFF,"");
	DispOnOff("Manual2",ON,"");
	HtmlChange("LifeLine","","");
}
function ManualOUT2()
{
	var obj = parent.millionaire.document;

	obj.Form.Flag.value = 'OFF';
	obj.all("Manual2").style.top = 0;

	DispOnOff("Manual",OFF,"");
	DispOnOff("Manual2",OFF,"");
	document.Form.ManualFlag.value = "ON";
}

function LifeLineChat()
{
	JukeBox(SOUND_LIFELINE,"");

	gLifeLineChat = ON;
	document.Form.Chat.value = "ON";
	TimerCount = 0;

	document.Form.LifeLineUsePointFlag.value = "OFF";

	DisplayMake(CHAT,9);
	LifeLineOUTMain();

	timerID = setTimeout("ChatDataMake();",TimerAdjust(1000));

	if(gAudienceUseGame == ON){
		gAudienceUseGame = OFF;
		TimerCount2 = 0;
		setTimeout("AudienceLastMove()",1);
	}
}

function ChatDataMake()
{
	var str = "";

	str += '<table border = 0 bgcolor = "#eeeeee" width = 100%><tr><td align = center>';
	str += '<table border = 0 bgcolor = "#eeeeee" width = 100%>';

	str += '<tr><td align = left><font color = orange style = "font-size:13.5pt;"><b><font color = gray>自分＞</font><span ID = "ChatMe" style = "position:absolute; visibility:visible;"></span></b></font></td></tr>';
	str += '<tr><td height = 7></td></tr>';
	str += '<tr><td align = left><font color = blue style = "font-size:13.5pt;"><b><font color = green>相手＞</font><span ID = "ChatYou" style = "position:absolute; visibility:visible;"></span></b></font></td></tr>';
	str += '</table>';
	str += '</td></tr></table>';

	HtmlChange("LifeLine",str,"");

	ChatAreaMake();
}

function ChatAreaMake()
{
	clearTimeout(timerID);

	gWindow_x -= TimerCount * 10;
	
	if(gWindow_x <= 0){
		gWindow_x = 0;
	}
	
	document.all["LifeLine"].style.pixelLeft = gWindow_x;
	if(gWindow_x == 0){
		clearTimeout(timerID);
		ChatMain();
		return;
	}
	TimerCount++;
	timerID = setTimeout("ChatAreaMake();",TimerAdjust(20));
}

function ChatMain()
{
	//↓部分　涙のメッセージ作成データベース化。４時間かかった…
	var OKMes = new Array("01011","01111","01211","11011","11211","21011",
						  "21111","21211");
	var MidMes= new Array("00022","00120","00122","00220","00222","10020",
						  "10120","10122","10222","20002","20020","20022",
						  "20120","20220","20222");
	var NGMes = new Array("02002","02020","02120","02122","03002","03020",
						  "03120","12002","12020","12022","12100","12102",
						  "12120","12122","13002","13020","13022","13120",
						  "13122","22020","22022","22120","22122","23002",
						  "23020","23022","23120","23122");

	var Moji = new Array("Ａ","Ｂ","Ｃ","Ｄ");

	var Mes = new Array();
	var BorderOK,BorderMID;
	var Random = Rand(100);
	var work,AnsWord;
	var Flag;

	Mes[0] = new Array(5);
	Mes[0][0] = '…っていう問題なんだけどどれ？';
	Mes[0][1] = '…これの答え、なんだろ？';
	Mes[0][2] = '…どれが答えだと思う？';

	Mes[1] = new Array(5);
	Mes[1][0] = 'は絶対に在りえないけどねぇ…';
	Mes[1][1] = 'しかないでしょ！！';
	Mes[1][2] = 'う〜ん…　どれだろう？';
	Mes[1][3] = '（反応無し）';

	Mes[2] = new Array(5);
	Mes[2][0] = 'は、早く！スペースが無いっ！！';
	Mes[2][1] = '…';
	Mes[2][2] = 'ホント！？';

	Mes[3] = new Array(5);
	Mes[3][0] = 'え、そ、そう？';
	Mes[3][1] = 'うん。これ以外考えられない！';
	Mes[3][2] = 'うーん、わかんない！頑張ってね〜';

	Mes[4] = new Array(5);
	Mes[4][0] = '…';
	Mes[4][1] = 'ありがとう！！';
	Mes[4][2] = 'あ゛〜〜文字制限だぁ！！';

	if(ModeChk() == "Millionaire"){
		work = gLevelData[gLevelMode][gLevel];
	}
	if(ModeChk() == "Tokoton"){
		work = parseInt(QuizData[gNo][6],10);
	}

	BorderOK  = gChatOK[parseInt(work,10)-1];
	BorderMID = gChatMID[parseInt(work,10)-1];

	if(Random < BorderOK){
		work = OKMes[Rand(OKMes.length)];
		AnsWord = '<font color = red>「'+Moji[gAnswer]+'」</font>';
		gMessageWork = Moji[gAnswer];
		Flag = 0;
	}else if(Random < BorderMID && gAnswerHidden == 9){
		work = MidMes[Rand(MidMes.length)];
		while(1){
			Random = Rand(4);
			if(gFifty[0] != 9){
				if(gFifty[0] == gAnswer){
					AnsWord = '<font color=red>「'+Moji[gFifty[1]]+'」</font>';
					gMessageWork = Moji[gFifty[1]];
				}else{
					AnsWord = '<font color=red>「'+Moji[gFifty[0]]+'」</font>';
					gMessageWork = Moji[gFifty[0]];
				}
				break;
			}else{
				if(Random != gAnswer){
					AnsWord = '<font color = red>「'+Moji[Random]+'」</font>';
					gMessageWork = Moji[Random];
					break;
				}
			}
		}
		gAnswerHidden = Random;
		Flag = 1;
	}else{
		work = NGMes[Rand(NGMes.length)];
		AnsWord = "";
		Flag = 2;
	}

	TimerCount = 0;

	work = 'ChatAns("' + Mes[0][work.substring(0,1)] + '","' +
						 AnsWord +
						 Mes[1][work.substring(1,2)]+'","' +
						 Mes[2][work.substring(2,3)] + '","' +
						 Mes[3][work.substring(3,4)] + '","' +
						 Mes[4][work.substring(4,5)] + '",' + Flag + ');';

	timerID = setTimeout(work,TimerAdjust(800));
}

function ChatAns(Mes1,Mes2,Mes3,Mes4,Mes5,Flag)
{
	var str;
	var WaitTime = 2200;

	clearTimeout(timerID);
	
	switch(TimerCount){
		case 0:
			HtmlChange("ChatMe" ,Mes1,"");
			break;
		case 1:
			HtmlChange("ChatYou",Mes2,"");
			break;
		case 2:
			HtmlChange("ChatMe" ,Mes3,"");
			break;
		case 3:
			HtmlChange("ChatYou",Mes4,"");
			break;
		case 4:
			HtmlChange("ChatMe" ,Mes5,"");
			break;
		case 5:
			gLifeLineChat = OFF;
			document.Form.LifeLineUsePointFlag.value = "ON";
			switch(Flag){
				case 0: DisplayMake(CHAT_ANSWER,9); break;
				case 1: DisplayMake(CHAT_3TAKU,9); break;
				case 2: DisplayMake(CHAT_NG,9); break;
			}
			LifeLineOUTMain();
			return;
	}

	str = "ChatAns('" + Mes1 + "','" + Mes2 + "','" + Mes3 + "','" + Mes4 + "','" + Mes5 + "'," + Flag + ")";

	TimerCount++;
	timerID = setTimeout(str,TimerAdjust(WaitTime));
}

function FinalTrial()
{
	var str;
	var _R,_G,_B;
	var Gray,Skyblue;
	var i;

	_R = TimerCount * 8;
	_G = TimerCount * 8;
	_B = TimerCount * 8;

	_R = _R.toString(16);
	_G = _G.toString(16);
	_B = _B.toString(16);

	if(_R.length != 2) { _R = "0" + _R; }
	if(_G.length != 2) { _G = "0" + _G; }
	if(_B.length != 2) { _B = "0" + _B; }

	Gray = "#" +  _R + _G + _B;

	_R = TimerCount * 8  + 8;
	_G = TimerCount * 10 + 8;
	_B = TimerCount * 11 + 12;

	_R = _R.toString(16);
	_G = _G.toString(16);
	_B = _B.toString(16);

	if(_R.length != 2) { _R = "0" + _R; }
	if(_G.length != 2) { _G = "0" + _G; }
	if(_B.length != 2) { _B = "0" + _B; }

	Skyblue = "#" +  _R + _G + _B;

	str = '<table border = 0 cellspacing = 0 cellpadding = 0 width = 100%><tr><td align = center valign = top><font style="font-size:36pt; width:100%; filter:Shadow(color=' + Gray + ',direction=120);" color = "' + Skyblue + '"><i><b>Trial';
	str += '</b></i></font></td></tr></table>'

	DispOnOff("ActionArea",ON,"");

	HtmlChange("ActionArea",str,"");

	if(ModeChk() == "Tokoton"){
		Money[0] = "LAST QUESTION";
	}

	if(TimerCount >= 20){
		str += '<center>';
		for(i=0;i<Money[0].length;i++){
			str += '<span id = "Money' + i +'" style = "position:relative; visibility:hidden; font-size:48pt; color:#ffffff;">' + Money[0].charAt(i) + '</span>';
		}
		str += '</center>';
		HtmlChange("ActionArea",str,"");
		clearTimeout(timerID);
		TimerCount = 0;
		MoneyAction(0);
		return;
	}

	timerID = setTimeout("FinalTrial()",TimerAdjust(80));

	TimerCount++;
}

function MoneyAction(iNo)
{
	var str,work;

	if(iNo >= Money[0].length){
		clearTimeout(timerID);
		TimerCount = 0;
		timerID = setTimeout("MoneyActionFinish()",TimerAdjust(2000));
		return;
	}

	work = "Money" + iNo;

	if(TimerCount % 2 == 0){
		DispOnOff(work,ON,"");
	}else{
		DispOnOff(work,OFF,"");
	}

	str = 'MoneyAction(' + Math.floor(TimerCount / 4) + ')';

	timerID = setTimeout(str,TimerAdjust(40));

	TimerCount++;
}

function MoneyActionFinish()
{
	var i,work;

	if(TimerCount == 16){
		clearTimeout(timerID);
		TimerCount = 0;
		DispOnOff("ActionArea",OFF,"");

		for(i=0;i<Money[0].length;i++){
			work = "Money" + i;
			DispOnOff(work,OFF,"");
		}
		DisplayMake(MAIN,9);
		work = 'JukeBox(' + SOUND_TRIAL + ',"")';
		setTimeout(work,TimerAdjust(2500));
		document.Form.LifeLineUsePointFlag.value = "ON";
		document.Form.ManualFlag.value = "ON";
		return;
	}

	document.all["ActionArea"].style.pixelLeft = 0 - (Math.pow((TimerCount + 2),3));

	timerID = setTimeout("MoneyActionFinish()",TimerAdjust(100));

	TimerCount++;
}

function SafeGuard()
{
	JukeBox(SOUND_LIFELINE,"");
	gLifeLineSafeGuard = ON;
	document.Form.SafeGuard.value = "ON";
	DisplayMake(SAFEGUARD,9);
	LifeLineOUTMain();
	if(gAudienceUseGame == ON){
		gAudienceUseGame = OFF;
		TimerCount2 = 0;
		setTimeout("AudienceLastMove()",1);
	}
}

function TimerClear()
{
	var i;
	//タイマースレッドによる表示の問題回避する処理
	for(i=0;i<8;i++){
		clearTimeout(SelectTimerID[i]);
	}
}

function AudienceFirst()
{
	var str = "";
	var Moji =  new Array('Ａ','Ｂ','Ｃ','Ｄ');

	document.Form.Audience.value = "ON";
	document.Form.LifeLineUsePointFlag.value = "OFF";

	GetMousePosStart();

	LifeLineOUTMain();
	JukeBox(SOUND_AUDIENCE,"");

	TimerCount2 = 0;

	str += '<table border = 1 width = 150 height = 155 cellspacing = 0 cellpadding = 0 bgcolor = "#000000" background = "' + gPath + GraData[4] + '">';
	str += '<tr>';
	str += '<td align = center valign = bottom> <!-- 中スタート -->';
	str += '<table border = 1 width = 136 height = 120 cellspacing = 0 cellpadding = 0>';
	str += '<tr>';

	for(i=0;i<4;i++){
		str += '<td align = center height = 18 bgcolor = orange valign = middle><font style = "font-size:9pt;color:white;"><b>--</b>%</font></td>';
	}
	str += '</tr><tr>';
	for(i=0;i<4;i++){
		str += '<td height = 102 width = 25% align = center valign = bottom background = "' + gPath + GraData[3] + '">';
		str += ' <table border = 0 width = 14 height = 80 cellspacing = 0 cellpadding = 0>';
		str += ' <tr><td></td></tr></table>';
		str += '</td>';
	}
	str += '</tr></table>';
	str += '<table border = 0 width = 120 height = 10 cellspacing = 0 cellpadding = 0><tr>';
	for(i=0;i<4;i++){
		str += ' <td align = center width = 25%><b><font style = "font-size:13pt;color:white;">' + Moji[i] + '</font></b></td>';
	}
	str += '</tr></table></td></tr></table>';

	gAudienceUseGame = ON;

	HtmlChange("Audience1",str,"");
	AudienceFirstMove();
	DispOnOff("Audience1",ON,"");
}

function AudienceFirstMove()
{
	Locate("Audience1",356 + Math.pow((15 - TimerCount2),2),30,"");

	TimerCount2++;
	if(TimerCount2 == 16){
		var str = "";
		clearTimeout(timerID2);
		Locate("Audience2",356,80,"");
		str += '<table border = 0 cellspacing = 0 cellpadding = 0 width = 150><tr>';
		str += '<td width = 100%><marquee direction = right scrollamount = 8><font size = 4 color = violet><b>★集計中★</b></font></marquee></td>';
		str += '</tr><tr><td height = 30>&nbsp;</td></tr><tr>';
		str += '<td width = 100%><marquee direction = left scrollamount = 8><font size = 4 color = yellow><b>★集計中★</b></font></marquee></td>';
		str += '</tr></table>';
		DispOnOff("Audience2",ON,"");
		HtmlChange("Audience2",str,"");
		timerID2 = setTimeout("AudienceSecond()",TimerAdjust(7000));
	}else{
		clearTimeout(timerID2);
		timerID2 = setTimeout("AudienceFirstMove()",TimerAdjust(40));
	}
}

function AudienceLastMove()
{
	Locate("Audience1",356 + Math.pow(TimerCount2,2),30,"");
	TimerCount2++;
	if(TimerCount2 == 16){
		GetMousePosEnd();
		clearTimeout(timerID2);
		DispOnOff("Audience1",OFF,"");
		return;
	}else{
		clearTimeout(timerID2);
		timerID2 = setTimeout("AudienceLastMove()",TimerAdjust(40));
	}
}

function AudienceSecond()
{
	var ans = new Array(4);
	var Tmp = new Array(4);
	var Disp = new Array(4);
	var Moji =  new Array('Ａ','Ｂ','Ｃ','Ｄ');
	var str="";
	var i,j,work,work2,Cource;
	var _R,_G,_B;

	HtmlChange("Audience2","","");
	DispOnOff("Audience2",OFF,"");

	work = Rand(100) + 1;

	if(ModeChk() == "Millionaire"){
		if(gLevelMode == EASY){
			work2 = gLevel - 1;
		}else{
			work2 = gLevelData[gLevelMode][gLevel - 1] - 1;
		}
	}

	if(ModeChk() == "Tokoton"){
		work2 = parseInt(QuizData[gNo][6],10) - 1;
	}

	if(gFifty[0] != 9){
		if(work <= gATable[work2][0]){
			Cource = 5;
		}else if(work <= (gATable[work2][0] + gATable[work2][1])){
			Cource = 4;
		}else if(work <= (gATable[work2][0] + gATable[work2][1] + gATable[work2][2])){
			Cource = 4;
		}else{
			Cource = 4;
		}
	}else if(gAnswerHidden != 9){
		if(work <= gATable[work2][0]){
			Cource = 9;
		}else if(work <= (gATable[work2][0] + gATable[work2][1])){
			Cource = 7;
		}else if(work <= (gATable[work2][0] + gATable[work2][1] + gATable[work2][2])){
			Cource = 8;
		}else{
			Cource = 6;
		}
	}else{
		if(work <= gATable[work2][0]){
			Cource = 3;
		}else if(work <= (gATable[work2][0] + gATable[work2][1])){
			Cource = 1;
		}else if(work <= (gATable[work2][0] + gATable[work2][1] + gATable[work2][2])){
			Cource = 2;
		}else{
			Cource = 0;
		}
	}

	switch(Cource){
		//ばらばら
		case 0:
			ans[0] = 22 + Rand(7);
			ans[1] = 22 + Rand(7);
			ans[2] = 22 + Rand(7);
			ans[3] = 100 - ans[0] - ans[1] - ans[2];
			gMessageWork = "う〜ん。微妙ですねぇ…";
			break;
		//３択
		case 1:
			ans[0] = 29 + Rand(7);
			ans[1] = 29 + Rand(7);
			ans[2] = 29 + Rand(7);
			ans[3] = 100 - ans[0] - ans[1] - ans[2];
			if(ans[3] < 0){
				ans[2] += ans[3];
				ans[3] = 0;
			}
			break;
		//２択
		case 2:
			ans[0] = 40 + Rand(10);
			ans[1] = 85 - ans[0];
			ans[2] = 3 + Rand(12);
			ans[3] = 15 - ans[2];
			gMessageWork = "どうやら２つに絞られたようですね！";
			break;
		//ファイナルアンサー？
		case 3:
			ans[0] = 88 + Rand(12);
			ans[1] = Rand((100 - ans[0]));
			ans[2] = Rand((100 - ans[0] - ans[1]));
			ans[3] = 100 - ans[0] - ans[1] - ans[2];
			gMessageWork = Moji[gAnswer] + "が" + ans[0] + "％とダントツですねぇ〜";
			break;
		//(50:50)微妙処理
		case 4:
			ans[0] = 46 + Rand(10);
			ans[1] = 100 - ans[0];
			ans[2] = 0;
			ans[3] = 0;
			gMessageWork = "これまた困りましたねぇ…";
			break;
		//(50:50)ファイナルアンサー？
		case 5:
			ans[0] = 90 + Rand(10);
			ans[1] = 100 - ans[0];
			ans[2] = 0;
			ans[3] = 0;
			gMessageWork = "会場の皆さんは答えを解ってたようですね";
			break;
		//(chat)ばらばら＆３択
		case 6:
		case 7:
			ans[0] = 28 + Rand(8);
			ans[1] = 28 + Rand(8);
			ans[2] = 100 - ans[0] - ans[1];
			ans[3] = 0;
			gMessageWork = "あららら…　困りましたねぇ…";
			break;
		//(chat)２択
		case 8:
			ans[0] = 40 + Rand(10);
			ans[1] = 85 - ans[0];
			ans[2] = 100 - ans[0] - ans[1];
			ans[3] = 0;
			gMessageWork = "後一歩まで来たようですが…？";
			break;
		//(chat)ファイナルアンサー？
		case 9:
			ans[0] = 88 + Rand(12);
			ans[1] = Rand((100 - ans[0]));
			ans[2] = 100 - ans[0] - ans[1];
			ans[3] = 0;
			gMessageWork = "会場の皆さんの方が役に立ちましたね〜";
			break;
	}


	while(1){
		for(i=0;i<3;i++){
			Tmp[i] = Rand(3) + 1;
		}
		if(gAnswerHidden == 9){
			if(Tmp[0] != Tmp[1] && Tmp[0] != Tmp[2] && Tmp[1] != Tmp[2]){
				break;
			}
		}else{
			if(Tmp[0] != Tmp[1] && Tmp[0] != 3 && Tmp[1] != 3){
				break;
			}
		}
	}

	cnt = 0;
	if(gFifty[0] != 9){
		for(i=0;i<4;i++){
			Disp[i] = 0;
		}
		//50:50併用ケース
		if(gFifty[0] == gAnswer){
			Disp[gAnswer] = ans[0];
			Disp[gFifty[1]] = ans[1];
		}else{
			Disp[gAnswer] = ans[0];
			Disp[gFifty[0]] = ans[1];
		}
	}else{
		for(i=0;i<4;i++){
			if(gAnswer == i){
				Disp[gAnswer] = ans[0];
			}else if(gAnswerHidden == i){
				Disp[i] = ans[3];
			}else{
				Disp[i] = ans[Tmp[cnt]];
				cnt++;
			}
		}
	}

	//特別処理(３択ケースはココじゃないとロジック不備で処理できん…)
	if(Cource == 1){
		work = 0;
		for(i=1;i<4;i++){
			if(Disp[work] > Disp[i]){
				work = i;
			}
		}
		gMessageWork = Moji[work] + "以外に票が割れてしまいましたか…";
	}

	str += '<table border = 1 width = 150 height = 155 cellspacing = 0 cellpadding = 0 bgcolor = "#000000" background = "' + gPath + GraData[4] + '">';
	str += '<tr>';
	str += '<td align = center valign = bottom> <!-- 中スタート -->';
	str += '<table border = 1 width = 136 height = 120 cellspacing = 0 cellpadding = 0>';
	str += '<tr>';

	for(i=0;i<4;i++){
		str += '<td align = center height = 18 bgcolor = orange valign = middle><font style = "font-size:9pt;color:white;"><b>' + Disp[i] + '</b>%</font></td>';
	}
	str += '</tr><tr>';
	for(i=0;i<4;i++){
		str += '<td height = 102 width = 25% align = center valign = bottom background = "' + gPath + GraData[3] + '">';
		if(Disp[i] != 0){
			for(j=0;j<Disp[i];j++){
				_R = (96 + j).toString(16);
				_G = '5f';
				_B = (255 - j).toString(16);
				
				work = '#' + _R + _G + _B;
				
				str += ' <table border = 0 width = 14 height = 1 cellspacing = 0 cellpadding = 0>';
				str += ' <tr><td bgcolor = ' + work + '></td></tr></table>';
			}
		}else{
			str += ' <table border = 0 width = 14 height = 80 cellspacing = 0 cellpadding = 0>';
			str += ' <tr><td></td></tr></table>';
		}
		str += '</td>';
	}
	str += '</tr></table>';
	str += '<table border = 0 width = 120 height = 10 cellspacing = 0 cellpadding = 0><tr>';
	for(i=0;i<4;i++){
		str += ' <td align = center width = 25%><b><font style = "font-size:13pt;color:white;">' + Moji[i] + '</font></b></td>';
	}
	str += '</tr></table></td></tr></table>';

	HtmlChange("Audience1",str,"");

	DispOnOff("Audience1",ON,"");
	DisplayMake(AUDIENCE,9);
	document.Form.LifeLineUsePointFlag.value = "ON";
}

function SelectLifeLine()
{
	var str = "";
	var work = '<font face = "ＭＳ ゴシック" size = 4 font color = hotpink>';
	var work2 = '<font face = "ＭＳ ゴシック" size = 4 font color = greenyellow>';

	if(document.Form.CustomOnOff.value == 'OFF'){
		document.Form.CustomOnOff.value = 'ON';
	}else{
		return;
	}
	
	TimerCount = 0;

	str += '<table border = 0 bgcolor = "#797dcf" width = 100% height = 264 cellspacing = 0 cellpadding = 0><tr>';
	str += '<td height = 45><a onClick = "CheckLifeLine(' + LL_FIFTYFIFTY + ');" onMouseOver = "SLLNavi(' + LL_FIFTYFIFTY + ');" onMouseOut = "SLLNavi(-1);" style = "cursor:hand"><img src = "' + gPath + GraData[6] + '" name = "img' + LL_FIFTYFIFTY + '"></a></td>';
	str += '<td rowspan = 7 width = 16>' + work2 + '注意★ミリオネアモ｜ドのみ</font></td>';
	str += '<td rowspan = 7 ID = "Navi3" width = 16>' + work + '３つ選んでください</font></td>';
	str += '<td rowspan = 7 ID = "Navi2" width = 16>' + work + '使用するライフラインを</font></td>';
	str += '<td rowspan = 7 ID = "Navi1" width = 16><b>' + work + '■ＬＩＦＥＬＩＮＥの変更■</b></font></td>';
	str += '</tr><tr>';
	str += '<td height = 40><a onClick = "CheckLifeLine(' + LL_AUDIENCE + ');" onMouseOver = "SLLNavi(' + LL_AUDIENCE + ');" style = "cursor:hand" onMouseOut = "SLLNavi(-1);"><img src = "' + gPath + GraData[14] + '" name = "img' + LL_AUDIENCE + '"></a></td>';
	str += '</tr><tr>';
	str += '<td height = 40><a onClick = "CheckLifeLine(' + LL_TELEPHONE + ');" onMouseOver = "SLLNavi(' + LL_TELEPHONE + ');" style = "cursor:hand" onMouseOut = "SLLNavi(-1);"><img src = "' + gPath + GraData[16] + '" name = "img' + LL_TELEPHONE + '"></a></td>';
	str += '</tr><tr>';
	str += '<td height = 40><a onClick = "CheckLifeLine(' + LL_SAFEGUARD + ');" onMouseOver = "SLLNavi(' + LL_SAFEGUARD + ');" style = "cursor:hand" onMouseOut = "SLLNavi(-1);"><img src = "' + gPath + GraData[12] + '" name = "img' + LL_SAFEGUARD + '"></a></td>';
	str += '</tr><tr>';
	str += '<td height = 40><a onClick = "CheckLifeLine(' + LL_CHAT + ');" onMouseOver = "SLLNavi(' + LL_CHAT + ');" style = "cursor:hand" onMouseOut = "SLLNavi(-1);"><img src = "' + gPath + GraData[10] + '" name = "img' + LL_CHAT + '"></a></td>';
	str += '</tr><tr>';
	str += '<td height = 40><a onClick = "CheckLifeLine(' + LL_EXTRACHANGE + ');" onMouseOver = "SLLNavi(' + LL_EXTRACHANGE + ');" style = "cursor:hand;" onMouseOut = "SLLNavi(-1);"><img src = "' + gPath + GraData[8] + '" name = "img' + LL_EXTRACHANGE + '"></a></td>';
	str += '</tr><tr>';
	str += '<td height = 40><a onClick = "CheckLifeLine(' + LL_OTHER + ');" onMouseOver = "SLLNavi(999);" onMouseOut = "SLLNavi(-1);" style = "cursor:hand">CANCEL</a></td>';
	str += '</tr></table>';

	DispOnOff("SelectLL",ON,"parent.submain.");
	HtmlChange("SelectLL",str,"parent.submain.")

	with(parent.submain.document){
		all["SelectLL"].style.pixelLeft = 0
		all["SelectLL"].style.pixelTop = 0;
		gWindow_x = body.clientWidth;
		Form.Flag.value = "ON";
	}
	gAppend |= 0x01;
}

function SelectLifeLineIN()
{
	clearTimeout(timerID);

	gWindow_x -= TimerCount * 10;
	
	if(gWindow_x <= 0){
		gWindow_x = 0;
	}
	
	document.all("LifeLine").style.pixelLeft = gWindow_x;
	if(gWindow_x == 0){
		clearTimeout(timerID);
		return;
	}
	TimerCount++;
	timerID = setTimeout("SelectLifeLineIN();",TimerAdjust(20));
}

function LifeLineTelephone()
{
	var i,str;

	if(gAudienceUseGame == ON){
		gAudienceUseGame = OFF;
		TimerCount2 = 0;
		setTimeout("AudienceLastMove()",1);
	}

	gLifeLineTelephone = ON;

	document.Form.LifeLineUsePointFlag.value = "OFF";
	document.all["TelephoneI"].style.pixelTop = -1000;
	document.all["TelephoneI"].style.pixelLeft = 300;
	document.all["TelephoneY"].style.pixelTop = -1000;
	document.all["TelephoneY"].style.pixelLeft = 20;
	document.all["TelephoneT"].style.pixelTop = -1000;
	document.all["TelephoneT"].style.pixelLeft = 215;

	DispOnOff("TelephoneI",ON,"");
	DispOnOff("TelephoneY",ON,"");
	DispOnOff("TelephoneT",ON,"");

	TelephoneBattery(0);
	HtmlChange("TelephoneIMes","","");
	HtmlChange("TelephoneYMes","","");
	HtmlChange('TelephoneName','<font color = \"red\">■相手■</font>','');

	str = '<table border = 0 width = 400 cellspacing = 0 cellpadding = 0><tr>';

	for(i=0;i<4;i++){
		str += '<td align = center width = 25%><a onClick = "TelephoneSelected();"><img src = "' + gPath + GraData[16] + '"></a></td>';
	}
	str += '</tr></table>';

	TimerCount = 0;

	document.Form.LifeLineUsePointFlag.value = "OFF";
	LifeLineOUTMain();

	DispOnOff("TelephoneSelect",ON,"");
	HtmlChange("TelephoneSelect",str,"");
	
	Locate("TelephoneSelect",0,-500,"");
	JukeBox(SOUND_LIFELINE,"");
	TelephoneSelect();
}

function TelephoneSelect()
{
	document.Form.Telephone.value = "ON";
	Locate("TelephoneSelect",60,Math.pow(TimerCount,2)-96,"");
	TimerCount++;
	if(TimerCount == 16){
		TimerCount = 0;
		clearTimeout(timerID);
		str = 'MesChange("さて、どの電話にかけてみますか？","MINO")';
		setTimeout(str,TimerAdjust(300));
		return;
	}else{
		clearTimeout(timerID);
		timerID = setTimeout("TelephoneSelect()",TimerAdjust(40));
	}
}

function TelephoneSelected()
{
	if(TimerCount == 0){
		JukeBox(SOUND_TELEPHONE,"");
		str = 'MesChange("ＲＲＲＲＲＲ…　ＲＲＲＲＲＲ…","MINO")';
		setTimeout(str,TimerAdjust(300));
	}
	Locate("TelephoneSelect",60,Math.pow((15-TimerCount),2)-100,"");
	TimerCount++;
	if(TimerCount == 16){
		TimerCount = 0;
		clearTimeout(timerID);
		setTimeout("TelephoneMoveIn()",TimerAdjust(2500));
		return;
	}else{
		clearTimeout(timerID);
		timerID = setTimeout("TelephoneSelected()",TimerAdjust(40));
	}
}

function TelephoneMoveIn()
{
	LocateY("TelephoneI",20 + Math.pow((15 - TimerCount),2),"")
	LocateY("TelephoneY",20 + Math.pow((15 - TimerCount),2),"")

	TimerCount++;
	if(TimerCount == 16){
		TimerCount = 0;
		clearTimeout(timerID);
		TelephoneIntro();
		return;
	}else{
		clearTimeout(timerID);
		timerID = setTimeout("TelephoneMoveIn()",TimerAdjust(40));
	}
}

function TelephoneIntro()
{
	var str;
	var Mes;
	var Random = Rand(4);
	var work;
	
	if(Rand(64) == 0){
		str = 'MesChange("ただいま電話に出る事が出来ません。もう一度おかけなおしください。","YOU")';
		setTimeout(str,TimerAdjust(300));

		str = 'MesChange("おや？繋がらないようですね…","MINO")';
		setTimeout(str,TimerAdjust(3000));

		str = 'MesChange("残念ですが、テレフォンはここで終了です！","MINO")';
		setTimeout(str,TimerAdjust(5500));

		str = 'MesChange("役にたたねぇ〜！！","I")';
		setTimeout(str,TimerAdjust(9000));

		timerID6 = setTimeout("TelephoneMoveOut('REA')",TimerAdjust(12000));
		return;
	}

	str = 'MesChange("もしもし？お待たせしました。","MINO")';
	setTimeout(str,TimerAdjust(300));

switch(Random){
    case 0:
        str = 'MesChange("まちくたびれたわい。やれやれ、やっと出番かの？延岡の歴史ならまかせておきなさい。","YOU")';
        break;
    case 1:
        str = 'MesChange("待っていました。大丈夫！！私にまかせまさい。延岡の政治関連ならなんでもこい！","YOU")';
        break;
    case 2:
        str = 'MesChange("おっと出番だ！みんな、この問題はテストに出るのでメモしておくように！いいですか。","YOU")';
        break;
    case 3:
        str = 'MesChange("待ってたぜ！俺の相手はどこだ？","YOU")';
        break;
    }
    setTimeout(str,TimerAdjust(2000));

	str = 'MesChange("その声は' + gHumanTelephone[Random][0] + 'ですね？","MINO")';
	setTimeout(str,TimerAdjust(4500));

	str = "HtmlChange('TelephoneName','<font color = \"red\">■"+ gHumanTelephone[Random][0] +"■</font>','');";

	setTimeout(str,TimerAdjust(6000));

	if(ModeChk() == "Tokoton"){
		str = (gLevel + 1).toString() + '問目';
		work = Math.floor((gLevel / Math.floor(QuizData.length / 6))) + 1;
	}else{
		str = '\\' + Money[gMoneyData[gLevelMode][(gMoneyData[gLevelMode].length - gLevel - 1)]];
		work = parseInt(QuizData[gNo][6],10);
	}
	str = 'MesChange("挑戦者は今'+ str +'で助けを求めてます","MINO")';
	setTimeout(str,TimerAdjust(7000));

	switch(Random){
		case 0:
			switch(work){
				case 1:
					Mes = 'これは重症ですな…';
					break;
				case 2:
					Mes = 'まだ序の口では？';
					break;
				case 3:
					Mes = '任せとけ！';
					break;
				case 4:
					Mes = 'このくらいなら余裕かねぇ？';
					break;
				case 5:
					Mes = '知識がウリの私に任せなさい！';
					break;
				case 6:
					Mes = 'うむ、どんな奇問が飛び出すやら…';
					break;
			}
			break;
		case 1:
			switch(work){
				case 1:
					Mes = 'え？まだこの金額？';
					break;
				case 2:
					Mes = 'もう使ったのか？';
					break;
				case 3:
					Mes = 'まだまだだな。';
					break;
				case 4:
					Mes = 'おお、やるな！';
					break;
				case 5:
					Mes = '良く頑張った！';
					break;
				case 6:
					Mes = '…プレッシャー感じるぞ。';
					break;
			}
			break;
		case 2:
			switch(work){
				case 1:
					Mes = '使うの早すぎ！';
					break;
				case 2:
					Mes = '私の方がもっと良い成績残せそうじゃん！';
					break;
				case 3:
					Mes = 'もうちょっと頑張れよ〜';
					break;
				case 4:
					Mes = '助けられたら賞金山分けしても良さそうね！';
					break;
				case 5:
					Mes = 'うひゃーマジ？え〜これを＋して、あれをーして・・・';
					break;
				case 6:
					Mes = 'これ、難しい問題なんだろうね…あっ独り言だよ';
					break;
			}
			break;
		case 3:
			switch(work){
				case 1:
					Mes = 'さすがに解けるだろ…';
					break;
				case 2:
					Mes = '何とかいけるか？';
					break;
				case 3:
					Mes = 'ちょっと不安だね。';
					break;
				case 4:
					Mes = 'かなり不安かもしれない。';
					break;
				case 5:
					Mes = '逃げる準備しておくから！';
					break;
				case 6:
					Mes = '解答権拒否って事で';
					break;
			}
			break;
	}

	str = 'MesChange("' + Mes + '","YOU")';
	setTimeout(str,TimerAdjust(9500));

	str = 'MesChange("それでは、挑戦者と代わります。","MINO")';
	setTimeout(str,TimerAdjust(12000));

	str = 'MesChange("電池が切れる前に答えを教えてあげて下さい","MINO")';
	setTimeout(str,TimerAdjust(15000));

	timerID = setTimeout("TelephoneMoveIn2()",TimerAdjust(16000));
	setTimeout("TelephoneStart(" + Random + ")",TimerAdjust(17500));
}

function TelephoneStart(iNo)
{
	var str;
	var Mes;
	var iTime;

	switch(iNo){
		case 0:
			str = 'MesChange("お願いします！<font color = skyblue>「' + QuizData[gNo][0] + '」</font>の答えを教えてください！","I")';
			break;
		case 1:
			str = 'MesChange("<font color = skyblue>「' + QuizData[gNo][0] + '」</font>の答えどれでしょうか？","I")';
			break;
		case 2:
			str = 'MesChange("<font color = skyblue>「' + QuizData[gNo][0] + '」</font>の答えがわからん！","I")';
			break;
		case 3:
			str = 'MesChange("頼む！<font color = skyblue>「' + QuizData[gNo][0] + '」</font>の答えを教えて！","I")';
			break;
	}

	setTimeout(str,TimerAdjust(300));
	TimerCount = 0;

	if(gBattalyTable[gLevelData[gLevelMode][gLevel-1] - 1] >= (Rand(100) + 1)){
		//電池切れまで時間があるケース
		iTime = 5000 + Rand(2000);
		setTimeout("TelephoneBattery(1)",TimerAdjust(iTime));
		iTime += Rand(4000)+5000;
		setTimeout("TelephoneBattery(2)",TimerAdjust(iTime));
		iTime += Rand(4000)+5000;
		setTimeout("TelephoneBattery(3)",TimerAdjust(iTime));
		TelephoneTalk(iNo,"BOK");
	}else{
		//電池切れ確定
		iTime = 3000 + Rand(1000);
		setTimeout("TelephoneBattery(1)",TimerAdjust(iTime));

		iTime += Rand(1500)+3000;
		setTimeout("TelephoneBattery(2)",TimerAdjust(iTime));

		iTime += Rand(1500)+3000;
		setTimeout("TelephoneBattery(3)",TimerAdjust(iTime));

		iTime += 1000;
		str = 'MesChange("","SW")';
		setTimeout(str,TimerAdjust(iTime));
		iTime += 10;
		str = 'MesChange("プツッ…　ツーツーツーツー…","YOUSP")';
		setTimeout(str,TimerAdjust(iTime));

		switch(Rand(4)){
			case 0:
				str = 'MesChange("電池切れかよっ！","ISP");';
				break;
			case 1:
				str = 'MesChange("ちょ、ちょっと待ってくれ〜！","ISP");';
				break;
			case 2:
				str = 'MesChange("・・・・・・","ISP");';
				break;
			case 3:
				str = 'MesChange("これでホント大丈夫なんか？","ISP");';
				break;
		}
		iTime += 1000;
		setTimeout(str,TimerAdjust(iTime));

		iTime += 1000;
		timerID6 = setTimeout("TelephoneMoveOut('NORMAL','OUT')",TimerAdjust(iTime));
		TelephoneTalk(iNo,"BBAD");
	}
}

function TelephoneTalk(iNo,Batt)
{
	var Random = Rand(100) + 1;
	var iPercent = gHumanTelephone[iNo][gLevelData[gLevelMode][gLevel-1]];

	if(iPercent >= Random){
		//正解をいうケース
		TelephoneAnswerHuman("ANSWER",iNo,Batt);
	}else{
		//山勘モード
		TelephoneAnswerHuman("YAMAKAN",iNo,Batt);
	}

}

function TelephoneAnswerHuman(strRoot,iNo,Batt)
{
	var Mes;
	var Moji = new Array("Ａ","Ｂ","Ｃ","Ｄ");
	var Dummy;
	var Mes = new Array();
	var work,str;
	var DataTable;
	var i;

	work = Rand(4);

	if(gAnswerHidden != 9){
		while(1){
			if(work != gAnswerHidden && work != gAnswer){
				Dummy = Moji[work];
				break;
			}
			work = Rand(4);
		}
	}else if(gFifty[0] != 9){
		if(gFifty[0] == gAnswer){
			Dummy = Moji[gFifty[1]];
		}else{
			Dummy = Moji[gFifty[0]];
		}
	}else{
		while(1){
			if(work != gAnswer){
				Dummy = Moji[work];
				break;
			}
			work = Rand(4);
		}
	}
	Mes[0] = '';
	switch(iNo){
		case 0:
			Mes[1] = 'その問題はだな、ズバリ<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>が答えなんじゃが。';
			Mes[2] = '答えは<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>じゃ。';
			Mes[3] = 'ありがとう御座います。';
			Mes[4] = 'まぁ、この程度の問題、いつでも言ってきなさい。';
			Mes[5] = '助かりました。ありがとう御座いました。';
			Mes[6] = 'うむ。';
			Mes[7] = 'さすがですね！！';
			Mes[8] = 'じゃが、ワシの記憶違いか？<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>のような気もしたのだが…';
			Mes[9] = 'じゃが、ワシの記憶違いか？<font color = \'skyblue\'>「' + Dummy + '」</font>のような気もしたのだが…';
			Mes[10] = 'えええっ！？';
			Mes[11] = '歳喰ったせいかのう…';
			Mes[12] = 'それって凄く曖昧じゃありませんか？';
			Mes[13] = '間違ってたらすまんの。後はよろしく頼んだ。';
			Mes[14] = '…ぐはっ';
			Mes[15] = 'いや、それはないな。<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>でよいだろう。';
			Mes[16] = 'いや、それはないな。<font color = \'skyblue\'>「' + Dummy + '」</font>でよいだろう。';
			Mes[17] = 'ありがとう御座います！';
			Mes[18] = '博士、どれなんでしょうか';
			Mes[19] = 'ウーム…';
			Mes[20] = '博士っ！！';
			Mes[21] = 'すまん、これはわからん';
			Mes[22] = '…だめじゃーん！';
			Mes[23] = 'この問題は…';
			Mes[24] = 'さすがですね。';
			Mes[25] = 'だが、これはちと自信無いのぉ…　後は宜しく頼む。';

			if(strRoot == "ANSWER"){
				DataTable = new Array(
					'1,24,9,20,15,12,13,0,',
					'1,3,9,20,15,12,13,0,',
					'1,3,4,5,0,',
					'1,3,4,7,0,',
					'1,3,6,5,0,',
					'2,7,4,5,0,',
					'2,7,4,3,0,',
					'23,18,19,20,2,10,0,');
			}else{
				DataTable = new Array(
					'1,3,9,10,13,14,0,',
					'1,3,9,10,15,20,0,',
					'1,3,9,10,11,23,13,20,0,',
					'1,3,9,10,11,23,13,3,0,',
					'1,3,9,12,13,20,0,',
					'1,3,9,12,19,20,15,10,21,22,0,',
					'1,3,9,12,19,20,16,10,21,22,0,',
					'1,3,9,12,19,20,13,14,0,',
					'1,3,9,12,15,19,0,',
					'1,3,9,12,6,14,0,',
					'23,18,19,20,21,10,0,',
					'23,18,19,20,16,17,25,10,0,',
					'23,18,19,20,15,17,25,10,0,');
			}
			break;

		case 1:
			Mes[1]='中々面白い問題ではあるな。';
			Mes[2]='答えはどれでしょうか…';
			Mes[3]='<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>で間違いないであろう！';
			Mes[4]='ありがとう御座います！';
			Mes[5]='このような私の知識で答えられるものならいつでも歓迎する。';
			Mes[6]='い〜みないじゃん！';
			Mes[7]='<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>のようだった気もするのだが。';
			Mes[8]='<font color = \'skyblue\'>「' + Dummy + '」</font>のようだった気もするのだが。';
			Mes[9]='<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>が答えでよろしいですか？';
			Mes[10]='いや、<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>だったか？';
			Mes[11]='いや、<font color = \'skyblue\'>「' + Dummy + '」</font>だったか？';
			Mes[12]='それはダメだって！';
			Mes[13]='うむ、しばし長考させて頂きたい。';
			Mes[14]='げっ…';
			Mes[15]='こちらの件は後日解答ということでよろしいか？';
			Mes[16]='ではそれで解答してみます！';
			Mes[17]='これは…';
			Mes[18]='どうかしましたか？';
			Mes[19]='あまりにも難しいので驚いてしまった';
			Mes[20]='あまりにも簡単なので驚いてしまった';
			Mes[21]='では、答えは…？';
			Mes[22]='<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>だ。';
			Mes[23]='<font color = \'skyblue\'>「' + Dummy + '」</font>だ。';
			Mes[24]='<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>だと思うのだが…';
			Mes[25]='<font color = \'skyblue\'>「' + Dummy + '」</font>だと思うのだが…';
			Mes[26]='どうもありがとう御座いました';
			Mes[27]='では失礼する。'
			Mes[28]='・・・・・';
			Mes[29]='答えどっちなんだろ…';
			Mes[30]='うむ。';
			Mes[31]='<font color = \'skyblue\'>「' + Dummy + '」</font>で間違いないであろう！';

			if(strRoot == "ANSWER"){
				DataTable = new Array(
				'1,2,3,4,27,26,0,',
				'1,2,3,9,22,4,26,0,',
				'1,2,3,16,5,26,0,',
				'17,18,19,21,22,14,0,',
				'17,18,19,21,22,9,30,16,0,',
				'17,18,19,21,24,16,15,6,0,',
				'17,18,20,21,22,16,5,4,0,',
				'17,18,20,21,22,16,5,26,0,');
			}else{
				DataTable = new Array(
				'1,2,25,14,7,21,15,12,27,28,0,',
				'1,2,24,14,8,21,15,12,27,28,0,',
				'17,18,19,21,24,14,11,6,27,28,0,',
				'17,18,19,21,25,14,10,6,27,28,0,',
				'13,14,17,18,22,16,27,0,',
				'13,14,17,18,23,16,27,0,',
				'1,21,15,12,27,28,0,',
				'25,16,31,4,10,14,27,29,0,',
				'24,16,3,4,11,14,27,29,0,');
			}
			break;
		case 2:
			Mes[1]='この問題ね。え〜っと。';
			Mes[2]='頼む、教えてくれ！！';
			Mes[3]='<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>でファイナルアンサー！';
			Mes[4]='オイ他のヤツに電話なんかするなよ！';
			Mes[5]='…ちょっとまってね<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>かもしれない…';
			Mes[6]='…ちょっとまってね<font color = \'skyblue\'>「' + Dummy + '」</font>かもしれない…';
			Mes[7]='どっちなんだよ！';
			Mes[8]='どうだ？';
			Mes[9]='ちょっとまってね。もしもし…';
			Mes[10]='ファイナルアンサー？';
			Mes[11]='ファイナルアンサー！！！！！';
			Mes[12]='ありがとう！';
			Mes[13]='<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>だって！';
			Mes[14]='<font color = \'skyblue\'>「' + Dummy + '」</font>だって！';
			Mes[15]='よし、信じるよ！';
			Mes[16]='これは難しいねぇ…';
			Mes[17]='正直分からないのでカンで<font color = \'skyblue\'>「' + Dummy + '」</font>！';
			Mes[18]='正直分からないのでカンで<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>！';
			Mes[19]='それじゃ意味ねー';
			Mes[20]='って事で私の解答は<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>に決まり！';
			Mes[21]='って事で私の解答は<font color = \'skyblue\'>「' + Dummy + '」</font>に決まり！';
			Mes[22]='役にたたねぇ〜！';
			Mes[23]='う〜ん、ファイナルアンサー？'
			Mes[24]='えっ！？'
			Mes[25]='これって、信じてよいものやら…？'
			if(strRoot == "ANSWER"){
				DataTable = new Array(
				'1,2,3,10,11,12,0,',
				'1,2,3,10,23,7,20,15,0,',
				'1,8,3,10,11,15,0,',
				'1,8,3,10,11,12,0,',
				'16,2,3,10,11,12,0,',
				'16,2,3,10,23,7,20,15,0,',
				'16,8,3,10,11,15,0,',
				'16,8,3,10,11,12,0,',
				'1,2,9,4,20,15,0,');
			}else{
				DataTable = new Array(
				'1,2,9,4,21,19,0,',
				'1,2,9,4,21,22,0,',
				'1,2,9,4,20,19,0,',
				'1,2,9,4,20,22,0,',
				'16,8,5,10,23,7,20,12,0,',
				'16,8,5,10,23,7,21,24,0,',
				'16,8,6,10,23,7,21,15,0,',
				'16,8,6,10,23,7,20,24,0,',
				'9,4,13,19,20,25,0,',
				'9,4,14,19,21,25,0,',
				'5,10,11,12,0,',
				'6,10,11,12,0,',
				'20,15,6,7,17,22,0,',
				'20,15,6,7,18,22,0,',
				'21,15,5,7,17,22,0,',
				'21,15,5,7,18,22,0,');
			}
			break;
		case 3:
			Mes[1]='これはっ！';
			Mes[2]='どうしたっ！';
			Mes[3]='俺にはわからん！';
			Mes[4]='おい';
			Mes[5]='こういうのは直感しかあるまい。<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>だ！';
			Mes[6]='こういうのは直感しかあるまい。<font color = \'skyblue\'>「' + Dummy + '」</font>だ！';
			Mes[7]='コラッ！';
			Mes[8]='じゃぁ<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>か？';
			Mes[9]='じゃぁ<font color = \'skyblue\'>「' + Dummy + '」</font>か？';
			Mes[10]='もういい、カンで答える！！';
			Mes[11]='俺でもわかるぜっ！ズバリ解答は<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>だ！';
			Mes[12]='俺でもわかるぜっ！ズバリ解答は<font color = \'skyblue\'>「' + Dummy + '」</font>だ！';
			Mes[13]='マジか？';
			Mes[14]='たまには俺を信じてみろよ';
			Mes[15]='よし、わかった。サンキュー！';
			Mes[16]='おやっ？';
			Mes[17]='なんだ？';
			Mes[18]='これ、どこかで聞き覚えあるぜ？';
			Mes[19]='受け狙いで<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>としたいところだが、直感の<font color = \'skyblue\'>「' + Dummy + '」</font>で答えとする';
			Mes[20]='受け狙いで<font color = \'skyblue\'>「' + Dummy + '」</font>としたいところだが、<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>で答えとする';
			Mes[21]='中途半端すぎだっ！';
			Mes[22]='まぁ、頑張ってくれ';
			Mes[23]='オイッ！';
			Mes[24]='<font color = \'skyblue\'>「' + Moji[gAnswer] + '」</font>じゃねーか？';
			Mes[25]='<font color = \'skyblue\'>「' + Dummy + '」</font>じゃねーか？';
			Mes[26]='そうなのか？';
			Mes[27]='ありがとよっ！';
			Mes[28]='もういい、自分で答える！'
			if(strRoot == "ANSWER"){
				DataTable = new Array(
				'1,2,11,13,14,15,0,',
				'1,17,11,13,14,15,0,',
				'16,2,11,13,14,15,0,',
				'1,2,11,13,14,27,0,',
				'1,17,11,13,14,27,0,',
				'16,2,11,13,14,27,0,',
				'16,17,11,13,14,15,0,',
				'17,2,11,13,14,15,0,',
				'18,13,24,26,14,15,0,',
				'1,3,5,7,14,26,22,21,0,',
				'18,13,24,26,14,27,0,',
				'24,26,18,13,14,15,0,');
			}else{
				DataTable = new Array(
				'1,2,3,4,6,7,19,10,0,',
				'1,2,3,4,5,7,20,10,0,',
				'16,17,18,13,19,21,22,23,0,',
				'16,17,18,13,20,21,22,23,0,',
				'5,21,14,23,22,10,0,',
				'6,21,14,23,22,10,0,',
				'1,2,3,4,22,7,0,',
				'19,21,22,23,0,',
				'20,21,22,23,0,',
				'24,13,9,21,20,28,0,',
				'25,13,8,21,19,28,0,',
				'1,2,3,23,24,28,0,',
				'1,2,3,23,17,28,0,');
			}
			break;
	}

	work = DataTable[Rand(DataTable.length)].split(",");

	for(i=0;i<work.length;i++){
		if(parseInt(work[i],10) == 0 && Batt == "BOK"){
			clearTimeout(timerID6);
			timerID6 = setTimeout("TelephoneMoveOut('NORMAL','')",TimerAdjust((i+1)*3000)-1000);
			break;
		}
		if(i%2 == 0){
			str = 'MesChange("' + Mes[parseInt(work[i],10)] + '","YOU")';
		}else{
			str = 'MesChange("' + Mes[parseInt(work[i],10)] + '","I")';
		}
		setTimeout(str,TimerAdjust((i+1)*3000));
	}
}

function TelephoneBattery(iNo)
{
	var str;
	var i;

	str = '<table border = 3 cellspacing = 3 cellpadding = 0 bordercolor = white bordercolordark = white bordercolorlight = white height = 30 bgcolor = "#000000"><tr>';
	for(i=0;i<3;i++){
		if(i < iNo){
			str += '<td bgcolor = "#000000" height = 100% width = 8></td>';
		}else{
			str += '<td bgcolor = white height = 100% width = 8></td>';
		}
	}
	str += '</tr></table>';
	HtmlChange("Battery",str,"");
}

function TelephoneMoveIn2()
{
	LocateY("TelephoneT",40 + (Math.pow((15 - TimerCount),2) * -1),"")
	TimerCount++;

	if(TimerCount == 16){
		TimerCount = 0;
		clearTimeout(timerID);
		return;
	}else{
		clearTimeout(timerID);
		timerID = setTimeout("TelephoneMoveIn2()",TimerAdjust(40));
	}
}

function TelephoneMoveOut(strCource,strBattery)
{
	LocateX("TelephoneI",300 + Math.pow(TimerCount,2),"");
	LocateX("TelephoneY",20 + (Math.pow(TimerCount,2) * -1),"");

	if(strCource == "NORMAL"){
		LocateY("TelephoneT",40 + (Math.pow(TimerCount,2) * -1),"");
	}

	TimerCount++;
	if(TimerCount == 16){
		TimerCount = 0;
		document.Form.LifeLineUsePointFlag.value = "ON";
		gLifeLineTelephone = OFF;
		clearTimeout(timerID6);

		//クリーン作業を忘れると悲惨なことに…（汗）
		TelephoneBattery(0);
		HtmlChange("TelephoneIMes","","");
		HtmlChange("TelephoneYMes","","");
		HtmlChange('TelephoneName','<font color = \"red\">■相手■</font>','');
		
		setTimeout('MesChange("それでは、答えて頂きましょう！","MINOSP")',TimerAdjust(800));
		return;
	}else{
		clearTimeout(timerID6);
		timerID6 = setTimeout("TelephoneMoveOut('" + strCource + "','')",TimerAdjust(40));
	}
}

function MesChange(str,HUMAN)
{
	if(gLifeLineTelephone == OFF && HUMAN.indexOf("SP") == -1){
		return;
	}
	HUMAN = HUMAN.replace(/SP/g,'');

	switch(HUMAN){
		case "MINO":
			gMessageWork = str;
			DisplayMake(TELEPHONE,9);
			break;
		case "I":
			str = '<font color = greenyellow style = "font-size:13pt;line-height:17px;";><b>' + str + '</b></font>';
			HtmlChange("TelephoneIMes",str,"");
			break;
		case "YOU":
			str = '<font color = "#ffffff" style = "font-size:13pt;line-height:17px;";><b>' + str + '</b></font>';
			HtmlChange("TelephoneYMes",str,"");
			break;
		case "SW":
			gLifeLineTelephone = OFF;
	}
}

function EndingStaffRoll()
{
	var iCnt = 0;
	var i;
	
	HtmlChange("EndingWork1","<table border = 0 width = 100%><tr><td align = center nowrap><font color = greenyellow size = 6 style = 'font-family:Impact'>- Daily Quiz Millionaire -<br>GAME STAFF and SUPPORT<br>Introduction</font></td></tr></table>","");

	Locate("EndingWork1",0,320,"");
	DispOnOff("EndingWork1",ON,"");
	EndingAct1(iCnt);//ActionAreaタテずらし

}

function EndingAct1(iCnt)
{
	var work;

	LocateY("ActionArea",112 + iCnt * 8,"");
	LocateY("EndingWork1",320 - iCnt * 8,"");
	LocateY("Millionaire",iCnt * -8,"");
	if(iCnt == 40){
		clearTimeout(SelectTimerID[0]);

		DispOnOff("EndingWork2",ON,"");
		DispOnOff("EndingWork3",ON,"");

		HtmlChange("EndingWork2","<font size = 6 color = violet style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Program &amp; Sub Compose</nobr></font>","");

		HtmlChange("EndingWork3","<font size = 6 color = skyblue style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Haradeng(M.Harada)</nobr></font>","");

		Locate("EndingWork2",-250,140,"");
		Locate("EndingWork3",500,180,"");

		iCnt = 0;
		EndingAct2(iCnt,1);
		return;
	}
	iCnt++;
	work = "EndingAct1(" + iCnt + ")";
	SelectTimerID[0] = setTimeout(work,TimerAdjust(60));
}

function EndingAct2(iCnt,iLoop)
{
	var work;

	if(iCnt < 10){
		LocateX("EndingWork2",-250 + iCnt * 32,"");
		LocateX("EndingWork3",500 - iCnt * 32,"");
	}else{
		if(iCnt < 50){
			;
		}else{
			if(iCnt == 70){
				if(iLoop == 1){
					clearTimeout(SelectTimerID[0]);

					HtmlChange("EndingWork2","<font size = 6 color = skyblue style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Main Compose &amp; Effect</nobr></font>","");

					HtmlChange("EndingWork3","<font size = 6 color = hotpink style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>&nbsp;&nbsp;&nbsp;NNA(M.Nishida)</nobr></font>","");

					Locate("EndingWork2",-250,140,"");
					Locate("EndingWork3",500,180,"");

					iCnt = 0;
					work = "EndingAct2(" + iCnt + ",2)";
					SelectTimerID[0] = setTimeout(work,TimerAdjust(60));
					return;

				}
				if(iLoop == 2){
					clearTimeout(SelectTimerID[0]);

					HtmlChange("EndingWork2","<font size = 6 color = yellow style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Graphic Painter</nobr></font>","");

					HtmlChange("EndingWork3","<font size = 6 color = orange style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sasa Teacher</nobr></font>","");

					Locate("EndingWork2",-250,140,"");
					Locate("EndingWork3",500,180,"");

					iCnt = 0;
					work = "EndingAct2(" + iCnt + ",3)";
					SelectTimerID[0] = setTimeout(work,TimerAdjust(60));
					return;

				}
				if(iLoop == 3){
					clearTimeout(SelectTimerID[0]);
					iCnt = 16;
					HtmlChange("EndingWork2","<font size = 6 color = orange style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Special Quiz Creator</nobr></font>","");
					Locate("EndingWork2",120,130+iCnt*iCnt,"");
					EndingAct3(iCnt);
					return;
				}
			}
			LocateX("EndingWork2",-250 + (iCnt-40) * 32,"");
			LocateX("EndingWork3",500 - (iCnt-40) * 32,"");
		}
	}

	iCnt++;
	work = "EndingAct2(" + iCnt + "," + iLoop + ")";
	SelectTimerID[0] = setTimeout(work,TimerAdjust(60));
}

function EndingAct3(iCnt)
{
	var work;
	var iTime = 1280;
	var iUp   = 470;

	Locate("EndingWork2",120,130+iCnt*iCnt,"");

	if(iCnt == 0){
		clearTimeout(SelectTimerID[0]);
		iCnt = 0;
		work = "EndingAct4(0)";
		SelectTimerID[0] = setTimeout(work,TimerAdjust(iTime));
		work = "EndingAct4(1)";
		SelectTimerID[1] = setTimeout(work,TimerAdjust(iTime + iUp));
		work = "EndingAct4(2)";
		SelectTimerID[2] = setTimeout(work,TimerAdjust(iTime + iUp * 2));
		work = "EndingAct4(3)";
		SelectTimerID[3] = setTimeout(work,TimerAdjust(iTime + iUp * 3));
		work = "EndingAct5(3)";
		SelectTimerID[4] = setTimeout(work,TimerAdjust(iTime + iUp * 8));
		return;
	}
	iCnt--;
	work = "EndingAct3(" + iCnt + ")";
	SelectTimerID[0] = setTimeout(work,TimerAdjust(60));

}
function EndingAct4(iCnt)
{
	switch(iCnt){
		case 0:
			DispOnOff("EndingWork3",ON,"");
			Locate("EndingWork3",60,180,"");
			HtmlChange("EndingWork3","<font size = 5 color = hotpink style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Mimi(T.Akazawa)</nobr></font>","");
			clearTimeout(SelectTimerID[0]);
			break;
		case 1:
			DispOnOff("EndingWork4",ON,"");
			Locate("EndingWork4",260,180,"");
			HtmlChange("EndingWork4","<font size = 5 color = skyblue style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Yu-kun(Y.Shimada)</nobr></font>","");
			clearTimeout(SelectTimerID[1]);
			break;
		case 2:
			DispOnOff("EndingWork5",ON,"");
			Locate("EndingWork5",60,210,"");
			HtmlChange("EndingWork5","<font size = 5 color = skyblue style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Taka(T.Nishida)</nobr></font>","");
			clearTimeout(SelectTimerID[2]);
			break;
		case 3:
			DispOnOff("EndingWork6",ON,"");
			Locate("EndingWork6",260,210,"");
			HtmlChange("EndingWork6","<font size = 5 color = skyblue style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>K.N</nobr></font>","");
			clearTimeout(SelectTimerID[3]);

			break;
	}
}

function EndingAct5(iCnt)
{
	Locate("EndingWork3",60,180+(iCnt-3)*(iCnt-3),"");
	Locate("EndingWork4",260-iCnt*iCnt,180,"");
	Locate("EndingWork5",60+iCnt*iCnt,210,"");
	Locate("EndingWork6",260,210-iCnt*iCnt,"");

	Locate("EndingWork2",120,130+(iCnt-3)*(iCnt-3),"");
	if(iCnt == 23){
		clearTimeout(SelectTimerID[4]);
		clearTimeout(SelectTimerID[0]);
		iCnt = 0;

		HtmlChange("EndingWork2","<font size = 6 color = pink style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Special Thanks to ...</nobr></font>","");
		HtmlChange("EndingWork3","<font size = 6 color = greenyellow style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Special Thanks to ...</nobr></font>","");
		HtmlChange("EndingWork4","<font size = 6 color = skyblue style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Special Thanks to ...</nobr></font>","");
		HtmlChange("EndingWork5","<font size = 6 color = yellow style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Special Thanks to ...</nobr></font>","");
		EndingAct6(20);
		return;
	}
	iCnt++;
	work = "EndingAct5(" + iCnt + ")";
	SelectTimerID[0] = setTimeout(work,TimerAdjust(60));
}

function EndingAct6(iCnt)
{
	Locate("EndingWork2",115,130+iCnt*iCnt,"");
	Locate("EndingWork3",115-iCnt*iCnt,130,"");
	Locate("EndingWork4",115+iCnt*iCnt,130,"");
	Locate("EndingWork5",115,130-iCnt*iCnt,"");

	if(iCnt == 0){
		clearTimeout(SelectTimerID[0]);
		HtmlChange("EndingWork2","<font size = 6 color = '#ffffff' style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Special Thanks to ...</nobr></font>","");
		HtmlChange("EndingWork3","","");
		HtmlChange("EndingWork4","","");
		HtmlChange("EndingWork5","","");
		HtmlChange("EndingWork6","","");
		iCnt = 0;
		gVolume = 0;
		timerID3 = setInterval("JukeBoxFadeOut(0)",TimerAdjust(100));
		EndingAct7(20);
		return;
	}

	iCnt--;
	work = "EndingAct6(" + iCnt + ")";
	SelectTimerID[0] = setTimeout(work,TimerAdjust(60));
}

function EndingAct7(iCnt)
{
	var work;
	var iTime = 1280;
	var iUp   = 470;

	clearTimeout(SelectTimerID[0]);
	iCnt = 0;
	work = "EndingAct8(0)";
	SelectTimerID[0] = setTimeout(work,TimerAdjust(iTime));
	work = "EndingAct8(1)";
	SelectTimerID[1] = setTimeout(work,TimerAdjust(iTime));
	work = "EndingAct8(2)";
	SelectTimerID[2] = setTimeout(work,TimerAdjust(iTime + iUp * 2));
	work = "EndingAct8(3)";
	SelectTimerID[3] = setTimeout(work,TimerAdjust(iTime + iUp * 2));
	work = "EndingAct8(4)";
	SelectTimerID[4] = setTimeout(work,TimerAdjust(iTime + iUp * 4));
	work = "EndingAct8(5)";
	SelectTimerID[5] = setTimeout(work,TimerAdjust(iTime + iUp * 8));
	work = "EndingAct8(6)";
	SelectTimerID[5] = setTimeout(work,TimerAdjust(iTime + iUp * 11));
	work = "EndingAct9(0)";
	SelectTimerID[6] = setTimeout(work,TimerAdjust(iTime + iUp * 17));
	return;
}

function EndingAct8(iCnt)
{
	switch(iCnt){
		case 0:
			DispOnOff("EndingWork3",ON,"");
			Locate("EndingWork3",120,180,"");
			HtmlChange("EndingWork3","<font size = 5 color = hotpink style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>melanie</nobr></font>","");
			clearTimeout(SelectTimerID[0]);
			break;
		case 1:
			DispOnOff("EndingWork4",ON,"");
			Locate("EndingWork4",280,180,"");
			HtmlChange("EndingWork4","<font size = 5 color = hotpink style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Nuu</nobr></font>","");
			clearTimeout(SelectTimerID[1]);
			break;
		case 2:
			DispOnOff("EndingWork5",ON,"");
			Locate("EndingWork5",120,205,"");
			HtmlChange("EndingWork5","<font size = 5 color = skyblue style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Ayaka</nobr></font>","");
			clearTimeout(SelectTimerID[2]);
			break;
		case 3:
			DispOnOff("EndingWork6",ON,"");
			Locate("EndingWork6",280,205,"");
			HtmlChange("EndingWork6","<font size = 5 color = hotpink style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>Yo-ka</nobr></font>","");

			clearTimeout(SelectTimerID[3]);
			break;
		case 4:
			DispOnOff("EndingWork7",ON,"");
			Locate("EndingWork7",120,230,"");
			HtmlChange("EndingWork7","<font size = 5 color = skyblue style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>R.Kamei</nobr></font>","");

			clearTimeout(SelectTimerID[4]);
			break;
		case 5:
			DispOnOff("EndingWork8",ON,"");
			Locate("EndingWork8",280,230,"");
			HtmlChange("EndingWork8","<font size = 5 color = yellow style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>and </nobr></font>","");

			break;
		case 6:
			DispOnOff("EndingWork8",ON,"");
			Locate("EndingWork8",280,230,"");
			HtmlChange("EndingWork8","<font size = 5 color = yellow style = 'font-family:HGS創英角ｺﾞｼｯｸUB'><nobr>and You...</nobr></font>","");

			break;
	}
}

function EndingAct9(iCnt)
{
	clearTimeout(SelectTimerID[6]);
	LocateY("EndingWork1",iCnt * -8,"");
	LocateY("EndingWork2",130 + iCnt * 8,"");
	LocateY("EndingWork3",180 + iCnt * 8,"");
	LocateY("EndingWork4",180 + iCnt * 8,"");
	LocateY("EndingWork5",205 + iCnt * 8,"");
	LocateY("EndingWork6",205 + iCnt * 8,"");
	LocateY("EndingWork7",230 + iCnt * 8,"");
	LocateY("EndingWork8",230 + iCnt * 8,"");

	if(iCnt == 20){
		clearTimeout(SelectTimerID[0]);
		iCnt = 0;
		EndingAct10(iCnt);
		return;
	}
	iCnt++;
	work = "EndingAct9(" + iCnt + ")";
	SelectTimerID[0] = setTimeout(work,TimerAdjust(60));
}

function EndingAct10(iCnt)
{
	var str;
	var _R,_G,_B;
	var White;
	var i;

	Locate("EndingWork1",80,80,"");
	Locate("EndingWork2",150,250,"");

	_R = iCnt * 8 >= 255 ? 255 : iCnt * 8;
	_G = iCnt * 8 >= 255 ? 255 : iCnt * 8;
	_B = iCnt * 8 >= 255 ? 255 : iCnt * 8;

	_R = _R.toString(16);
	_G = _G.toString(16);
	_B = _B.toString(16);

	if(_R.length != 2) { _R = "0" + _R; }
	if(_G.length != 2) { _G = "0" + _G; }
	if(_B.length != 2) { _B = "0" + _B; }

	White = "#" +  _R + _G + _B;

	str = '<a onClick = "SelectMode(\'ENDING\');"><font size = 6 style = "font-family:Impact;" color = "' + White + '">Thank you for your playing!!<br><br>';

	if(ModeChk() == "Tokoton"){
		str += 'You are Ultra Super Player!!</font>';
	}else{
		switch(gLevelMode){
			case NORMAL:
				str += 'Next Stage is &quot;HARD MODE!!&quot;</font>';
				break;
			case HARD:
				str += 'Next Stage is &quot;EXTRA MODE!!&quot;</font>';
				break;
			case EXTRA:
				str += 'You are Super Player!!</font>';
				break;
		}
	}
	str += '</a>';

	HtmlChange("EndingWork1",str,"");


	if(ModeChk() == "Tokoton"){
		str = '<a onClick = "SelectMode(\'ENDING\');"><font size = 3 color = "' + White + '">(The Tokoton mode begins again by clicking!!)</a>';
	}else if(gLevelMode != EXTRA){
		str = '<a onClick = "SelectMode(\'ENDING\');"><font size = 3 color = "' + White + '">(The next stage begins by clicking!!)</a>';
	}else{
		str = '<a onClick = "SelectMode(\'ENDING\');"><font size = 3 color = "' + White + '">(The EXTRA mode begins again by clicking!!)</a>';
	}

	HtmlChange("EndingWork2",str,"");

	if(iCnt * 8 < 255){
		iCnt++;
		work = "EndingAct10(" + iCnt + ")";
		SelectTimerID[0] = setTimeout(work,TimerAdjust(60));
		return;
	}else{
		EndingEndMessage("");
		clearTimeout(SelectTimerID[0]);
		return;
	}
}

function JukeBox(iNo,strEffect)
{
	var work,i,strBGM;

	strBGM = document.Form.SoundOnOff.value;

	with(document){
		if(strBGM == 'OFF'){
			all["BGM"].volume = -10000;
			all["BGM"].loop = 0;
			all["BGM"].src = "";
			for(i=1;i<11;i++){
				work = "EFFECT" + i.toString();
				all[work].loop = 0;
				all[work].volume = -10000;
				all[work].src = "";
			}
			return;
		}else{
			all["BGM"].volume = 0;
			for(i=1;i<11;i++){
				work = "EFFECT" + i.toString();
				all[work].volume = 0;
			}
		}

		if(gEffectNo > 10){
			gEffectNo = 1;
		}
		work = "EFFECT" + gEffectNo.toString();

		switch(iNo){
			case SOUND_MUTE_BGM:
				all["BGM"].loop = 0;
				all["BGM"].src = "";
				all["BGM"].volume = -10000;
				break;
			case SOUND_MUTE_EFFECT:
				all[strEffect].loop = 0;
				all[strEffect].src = "";
				all[strEffect].volume = -10000;
				return;
			case SOUND_TITLE:
				all["BGM"].loop = 0;
				all["BGM"].src = Sound[10];
				break;
			case SOUND_MAIN:
				all["BGM"].loop = -1;
				all["BGM"].src = Sound[1];
				break;
			case SOUND_LIFELINE:
				if(gEffectNo == 1){
					work = "EFFECT10";
				}else{
					work = "EFFECT" + (gEffectNo - 1).toString();
				}
				JukeBox(SOUND_MUTE_EFFECT,work);
				all[work].loop = 0;
				all[work].volume = 0;
				all[work].src = Sound[2];
				setTimeout('JukeBox(' + SOUND_MUTE_EFFECT + ',"' + work + '");',TimerAdjust(3000));
				gEffectNo++;
				break;
			case SOUND_FINALANSWER:
				if(gEffectNo == 1){
					work = "EFFECT10";
				}else{
					work = "EFFECT" + (gEffectNo - 1).toString();
				}
				JukeBox(SOUND_MUTE_EFFECT,work);
				all[work].loop = 0;
				all[work].volume = 0;
				all[work].src = Sound[3];
				setTimeout('JukeBox(' + SOUND_MUTE_EFFECT + ',"' + work + '");',TimerAdjust(1300));
				gEffectNo++;
				break;
			case SOUND_AUDIENCE:
				if(gEffectNo == 1){
					work = "EFFECT10";
				}else{
					work = "EFFECT" + (gEffectNo - 1).toString();
				}
				JukeBox(SOUND_MUTE_EFFECT,work);
				all[work].loop = 0;
				all[work].volume = 0;
				all[work].src = Sound[13];
				setTimeout('JukeBox(' + SOUND_MUTE_EFFECT + ',"' + work + '");',TimerAdjust(12000));
				gEffectNo++;
				break;
			case SOUND_TELEPHONE:
				if(gEffectNo == 1){
					work = "EFFECT10";
				}else{
					work = "EFFECT" + (gEffectNo - 1).toString();
				}
				JukeBox(SOUND_MUTE_EFFECT,work);
				all[work].loop = -1;
				all[work].volume = 0;
				all[work].src = Sound[14];
				setTimeout('JukeBox(' + SOUND_MUTE_EFFECT + ',"' + work + '");',TimerAdjust(6000));
				gEffectNo++;
				break;
			case SOUND_SEIKAI:
			case SOUND_NG:
				if(gEffectNo == 1){
					work = "EFFECT10";
				}else{
					work = "EFFECT" + (gEffectNo - 1).toString();
				}
				JukeBox(SOUND_MUTE_EFFECT,work);
				all[work].loop = 0;
				all[work].volume = 0;
				all[work].src = Sound[0];
				setTimeout('JukeBox(' + SOUND_MUTE_EFFECT + ',"' + work + '");',TimerAdjust(2000));
				gEffectNo++;
				break;
			case SOUND_TRIAL:
				all["BGM"].volume = 0;
				all["BGM"].loop = -1;
				all["BGM"].src = Sound[11];
				break;
			case SOUND_STAFFROLL:
				all["BGM"].volume = 0;
				all["BGM"].loop = 0;
				all["BGM"].src = Sound[16];
				break;
			case SOUND_MAIN10_15:
				all["BGM"].volume = 0;
				all["BGM"].loop = -1;
				all["BGM"].src = Sound[17];
				break;
			case SOUND_MAIN6_9:
				all["BGM"].volume = 0;
				all["BGM"].loop = -1;
				all["BGM"].src = Sound[15];
				break;
		}
	}
}

function JukeBoxFadeOut(iCource)
{
	document.all["BGM"].volume = parseInt(gVolume,10);
	if(iCource == 0){
		if(gVolume >= -1000){
			gVolume -= 30;
		}else{
			gVolume -= 200;
		}
		if(gVolume < -9000){
			document.all["BGM"].volume = -10000;
			clearTimeout(timerID3);
		}
	}else{
		gVolume -= 100;
		if(gVolume < -5000){
			clearTimeout(timerID3);
			if(iCource == 1){
				JukeBox(SOUND_MAIN10_15,"");
			}else{
				JukeBox(SOUND_MAIN6_9,"");
			}
		}
	}
}
//-->
</script>
<span ID = "Check3" style = "position:relative; visibility:visible;">
完了<br>
クイズデータ読込中...
</span>
<script language = "JavaScript" src = "QuizData.js"></script>
<span ID = "Check2" style = "position:relative; visibility:visible;z-index:2;">
完了<br>
画像データ読込中...<br>
</span>
<!-- 以下ワークエリア -->
<span id = "Check4" style = "position:absolute; visibility:visible;">
<script language = "JavaScript">
<!--
var i;

for(i=0;i<GraData.length;i++){
	document.write('<img src = "'+ gPath + GraData[i] +'" height = 20 width = 25>');
}
document.write('　完了<br>サウンドデータ読込中...（とても長いです。気長にお待ちを）');

for(i=0;i<100;i++){
	document.write('<br>');
}
//-->
</script>
</span>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
<span id = "inposeekblock" style = "position:relative; visibility:hidden;">
&nbsp;ｉｎｆ●ｓｅｅｋ系対策&nbsp;<br>
</span>
<form name = "Form">
<input type = "hidden" name = "FiftyFifty" value = "OFF">
<input type = "hidden" name = "ExtraChange" value = "OFF">
<input type = "hidden" name = "Chat" value = "OFF">
<input type = "hidden" name = "SafeGuard" value = "OFF">
<input type = "hidden" name = "Audience" value = "OFF">
<input type = "hidden" name = "Telephone" value = "OFF">
<input type = "hidden" name = "Flag" value = "OFF">
<input type = "hidden" name = "LifeLineUsePointFlag" value = "OFF">
<input type = "hidden" name = "ManualFlag" value = "ON">
<input type = "hidden" name = "GameOverFlag" value = "OFF">
<input type = "hidden" name = "EndingFlag" value = "OFF">
<input type = "hidden" name = "Mode" value = "">
<input type = "hidden" name = "ModeLevel" value = "NORMAL">
<input type = "hidden" name = "CustomOnOff" value = "OFF">
<input type = "hidden" name = "LifeLineNo" value = "123">
<input type = "hidden" name = "LifeLineNoBackup" value = "123">
<input type = "hidden" name = "Path" value = "./dat/">
<input type = "hidden" name = "SoundOnOff" value = "ON">
</form>
</body>
</html>
